#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ \\#
#\\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ //#
#// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\                                                                                                                                                 //#
#//    <@[ Initialize-Hybrid ]@>                                                                                           "Michael C. Cook Sr."    \\#
#\\                                                                                                                                                 //#
#//                                       [ Secure Digits Plus LLC | Hybrid ] [ Desired State Controller ]                                          \\#
#\\                                                                                                                                                 //#
#//                                [ https://www.securedigitsplus.com | Server/Client | Seedling/Spawning Script ]                                  \\#
#\\                                                                                                                                                 //#
#//                                                                                                                                                 \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ \\#
#\\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\  [ Initialize-Hybrid ] @: Initializes the Functions needed for all sub-scripts, AKA "what sissies refer to as a module (i'm just kiddin XD)     //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ //#
#// \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \\#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    using namespace System.Security.Principal # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Elevate-Script # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        ( [ WindowsPrincipal ] [ WindowsIdentity ]::GetCurrent() ).IsInRole( "Administrators" ) | % { # - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( ( $_ -eq $False ) -and ( ( [ Int ]( gcim Win32_OperatingSystem ).BuildNumber -ge 6000 ) -eq $True ) ) # - - - - - - - - - - - - - - - -//#
        {   Echo "Attempting [~] Script Elevation" ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            SAPS -FilePath PowerShell.exe -Verb Runas -Args "-File $PSCommandPath $($MyInvocation.UnboundArguments)" # - - - - - - - - - - - - - - -//#
            If ( $? -eq $True ) { Echo "[+] Elevation Successful" ;  Echo "[+] Access Granted" ; Return } # - - - - - - - - - - - - - - - - - - - - \\#
            Else                { Echo "[!] Elevation Failed" ; Read-Host "[!] Access Denied"  ;   Exit } } #- - - - - - - - - - - - - - - - - - - -//#
        ElseIf ( $_ -eq $True ) { Echo "Access [+] Granted" ; Set-ExecutionPolicy Bypass -Scope Process -Force } } } #- - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ Write-Output Wrappers ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    ( $fs , $bs , $Message ) = ( " // " , " \\ " , "System.Windows.MessageBox" ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Wrap-Top   { Echo @( " " * 108 ; $fs + "_-" * 52 + $bs ; $bs + " -" * 52 + $fs ) } #- - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Wrap-Bot   { Echo @( $bs + " -" * 52 + $fs ; $fs + "_-" * 52 + $bs ; " " * 108 ) } # - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Wrap-Out   { Echo @(  $fs + "  " * 52 + $bs ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Wrap-In    { Echo @(  $bs + "  " * 52 + $fs ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Wrap-Title #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        [ CmdLetBinding () ] Param ( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ String ] $Title ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $th = "[ $Title ]" ; $y  = $th.length ; $x  = 104 - $y # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            If ( $x % 4 -ge 2 ) { $x  = $x - 2 ; $y  = $th.replace( "[" , " [ " ) ; $th = $y } #- - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            If ( $x % 2 -ge 1 ) { $x  = $x - 1 ; $y  = $th.replace( "]" , " ]" )  ; $th = $y ; $z  = 0 } # - - - - - - - - - - - - - - - - - - - - -//#
            If ( $z = 1 ) { $z = " -" } Else { $z = "- " } $y = $z * ( $x / 4 ) ; $x = "- " * ( $x / 4 ) #- - - - - - - - - - - - - - - - - - - - - \\#
            Wrap-Top ; Echo "$( $fs + $x + $th + $y + $bs )" } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Wrap-Function # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        [ CmdLetBinding () ] Param ( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ String ] $ID ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $th = "[ $ID ]" ; $y = $th.length ; $x = 104 - $y ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            if ( $x % 4 -ge 2 ) { $x = $x - 2 ; $y = $th.replace( "[" , " [ " ) ; $th = $y } #- - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            if ( $x % 2 -ge 1 ) { $x = $x - 1 ; $y = $th.replace( "]" , " ]" )  ; $th = $y ; $z = 0 } #- - - - - - - - - - - - - - - - - - - - - - -//#
            if ( $z = 1 ) { $z = " -" } else { $z = "- " } $y = $z * ( $x / 4 ) ; $x = "- " * ( $x / 4 ) #- - - - - - - - - - - - - - - - - - - - - \\#
            Wrap-Top ; Echo "$( $fs + $x + $th + $y + $bs )" ; Wrap-Bot } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Wrap-Section #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        [ CmdLetBinding () ] Param ( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ String ] $Section ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $z = $Section ; $x = " " * 10 ; $y = " " * ( 94 - $z.Length ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            Wrap-In ; Echo "$( $fs + $x + $z + $y + $bs )" ; Wrap-In } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
      #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Wrap-ItemIn #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        [ CmdLetBinding () ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                [ String ] $Type , #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position = 1 , Mandatory , ValueFromPipeline = $True ) ] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                [ String ] $Info ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
      #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            $x = " " * ( 23 - $Type.Length ) ; $y = " " * ( 78 - $Info.Length ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            Echo "$( $bs + $x + $Type ) : $( $Info + $y + $fs )" } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Wrap-ItemOut #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        [ CmdLetBinding () ] Param ( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ String ] $Type , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 1 , Mandatory , ValueFromPipeline = $True ) ] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ String ] $Info ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $x = " " * ( 23 - $Type.Length ) ; $y = " " * ( 78 - $Info.Length ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            Echo "$( $fs + $x + $Type ) : $( $Info + $y + $bs )" } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
      #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Wrap-Array # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        [ CmdletBinding () ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                [ Array ] $Block ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                Wrap-Top ; Echo $Block ; Wrap-Bot } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Wrap-Action # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        [ CmdletBinding () ] Param ( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ String ] $Type , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 1 , Mandatory , ValueFromPipeline = $True ) ] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ String ] $Info ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $x = " " * ( 23 - $Type.Length ) ; $y = " " * ( 78 - $Info.Length ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            Echo @( " " * 108 ; $fs + "_-" * 52 + $bs ; $bs + " -" * 52 + $fs ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            Echo "$( $fs + $x + $Type ) : $( $Info + $y + $bs )" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            Echo @( $bs + " -" * 52 + $fs ; $fs + "_-" * 52 + $bs ; " " * 108 ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ Test-Credential ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Test-Credential #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    {   [ CmdLetBinding () ][ OutputType ( [ String ] ) ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( ValueFromPipeLine = $True , ValueFromPipelineByPropertyName = $True ) ] # - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ Alias ( 'PSCredential' ) ] [ ValidateNotNull () ][ System.Management.Automation.PSCredential ] # - - - - - - - - - - - - - - - - -//#
                [ System.Management.Automation.Credential () ] $Credentials ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        ( $Domain , $Root , $Username , $Password ) = @( 0..3 | % { $Null } ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( $Credentials -eq $null ) {   Try   { $Credentials = Get-Credential "domain\$env:username" -EA 4 } # - - - - - - - - - - - - - - - - - -//#
                                          Catch { $ErrorMsg = $_.Exception.Message #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                                                  Wrap-Action -Type "Failure" -Info "[!] Account Validation" # - - - - - - - - - - - - - - - - - - -//#
                                                  Read-Host "Press Enter to Exit" ; Exit } } #- - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Try       { $Domain   = New-Object System.DirectoryServices.DirectoryEntry( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                                      "LDAP://$( ( [ ADSI ]'').distinguishedName )" , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                                                       "$( $Credentials.Username )" , #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                                "$( $Credentials.GetNetworkCredential().Password )" ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Catch     { $_.Exception.Message ; Continue } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        If ( ! $Domain ) {   Wrap-Action -Type "Exception" -Info        "[!] Domain does not exist" # - - - - - - - - - - - - - - - - - - - - - - - \\#
                             Wrap-Action -Type   "Install" -Info "Active Directory Domain Services" #- - - - - - - - - - - - - - - - - - - - - - - -//#
                             Read-Host "Press Enter to Exit" ; Exit } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Else {   If ( $Domain.Name -ne $Null ) { Return "Authenticated" ; Elevate-Script } # - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                 Else { Wrap-Action -Type "Authentication" -Info "[!] Failure" ; Sleep -Seconds 2 ; Exit } } } #- - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ Convert-XAMLToWindow ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Convert-XAMLToWindow # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    {   Param ( [ Parameter ( Mandatory ) ] [ String ]                    $XAML , #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                                            [ String [] ] $NamedElement = $Null , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                                            [ Switch ]                $PassThru ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        @( "Presentation" | % { "$_`Framework" ; "$_`Core" } ) + "WindowsBase" | % { Add-Type -AssemblyName $_ } #- - - - - - - - - - - - - - - - - \\#
        $Reader       = [ XML.XMLReader ]::Create([ IO.StringReader ] $XAML ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Output       = [ Windows.Markup.XAMLReader ]::Load( $Reader ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $NamedElement | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            $Output | Add-Member -MemberType NoteProperty -Name $_ -Value $Output.FindName( $_ ) -Force } # - - - - - - - - - - - - - - - - - - - - \\#
        If ( $PassThru )  { $Output } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Else #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        {   $Null = $GUI.Dispatcher.InvokeAsync{ $Output = $GUI.ShowDialog() # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            SV -Name Output -Value $Output -Scope 1 }.Wait() ; $Output } } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ Show-WPFWindow ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Show-WPFWindow # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    {   Param ( [ Parameter ( Mandatory ) ] [ Windows.Window ] $GUI ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Output = $Null # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                  $Null = $GUI.Dispatcher.InvokeAsync{ $Output = $GUI.ShowDialog() # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                        SV -Name Output -Value $Output -Scope 1 }.Wait() #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Output } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#//- [ Add-ACL ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Add-ACL # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    {   [ CmdletBinding () ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ String ] $Path , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                [ System.Security.AccessControl.FileSystemAccessRule ] $AceObject ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $OBJACL =  Get-ACL -Path $SiteRoot # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            $OBJACL.AddAccessRule( $AceObject ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            Set-ACL -Path $Path -AclObject $OBJACL } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#//- [ New-ACLObject ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function New-ACLObject # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    {   [ CmdletBinding () ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ String ] $SamAccountName , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                [ System.Security.AccessControl.FileSystemRights  ]               $Permission , # - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ System.Security.AccessControl.AccessControlType ]  $AccessControl = 'Allow' , #- - - - - - - - - - - - - - - - - - - - - - - - - -//#
                [ System.Security.AccessControl.InheritanceFlags  ]    $Inheritance =  'None' , # - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                [ System.Security.AccessControl.PropagationFlags  ]    $Propagation =  'None' ) #- - - - - - - - - - - - - - - - - - - - - - - - - -//#
            New-Object -TypeName System.Security.AccessControl.FileSystemAccessRule( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                $SamAccountName , $Permission , $Inheritance , $Propagation , $AccessControl ) } # - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#//- [ Get-WIMName ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Get-WIMName # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    {   [ CmdLetBinding () ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position = 0 , ValueFromPipeline = $True ) ][ String ]    $IP , #- - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 1 , ValueFromPipeline = $True ) ][ String ]    $ID ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        ( Get-WindowsImage -ImagePath $IP ).ImageName } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#//- [ Get-WIMBuild ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Get-WIMBuild #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    {   [ CmdLetBinding () ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position = 0 , ValueFromPipeline = $True ) ][ String ]    $IP , #- - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 1 , ValueFromPipeline = $True ) ][ String ]    $ID ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        ( Get-WindowsImage -ImagePath $IP -Index $ID ).Version } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#//- [ Import-NewOSImage ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Import-NewOSImage # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    {   [ CmdLetBinding () ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position = 0 , ValueFromPipeline = $True ) ][ String ] $IP , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 1 , ValueFromPipeline = $True ) ][ String ] $SF , #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position = 2 , ValueFromPipeline = $True ) ][ String ] $DF ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Import-MDTOperatingSystem -Path $IP -SourceFile $SF -DestinationFolder $DF -Move -VB } #- - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ Import-NewTask ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Import-NewTask # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    {   [ CmdLetBinding () ] Param ( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position =  0 , ValueFromPipeline = $True ) ][ String ]    $PSP , # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position =  1 , ValueFromPipeline = $True ) ][ String ] $Formal , #- - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position =  2 , ValueFromPipeline = $True ) ][ String ]    $XML , # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position =  3 , ValueFromPipeline = $True ) ][ String ]   $Info , #- - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position =  4 , ValueFromPipeline = $True ) ][ String ]     $ID , # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position =  5 , ValueFromPipeline = $True ) ][ String ]    $Ver , #- - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position =  6 , ValueFromPipeline = $True ) ][ String ]    $SIP , # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position =  7 , ValueFromPipeline = $True ) ][ String ] $TSName , #- - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position =  8 , ValueFromPipeline = $True ) ][ String ]    $Org , # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position =  9 , ValueFromPipeline = $True ) ][ String ]    $WWW , #- - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position = 10 , ValueFromPipeline = $True ) ][ String ] $LMCred ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Import-MDTTaskSequence -Path $PSP -Name $Formal -Template $XML -Comments $Info -ID $ID -Version $Ver ` # - - - - - - - - - - - - - - - - - -//#
            -OperatingSystemPath $SIP -FullName $TSName -OrgName $Org -HomePage $WWW -AdminPassword $LMCred -VB } # - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ Provision-Dependency ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Provision-Dependency # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    {   [ CmdLetBinding () ] Param ( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position =  0 , ValueFromPipeline = $True ) ][ String ]     $ID , # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position =  1 , ValueFromPipeline = $True ) ][ String ]   $Path , #- - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position =  2 , ValueFromPipeline = $True ) ][ String ]   $File , # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Position =  3 , ValueFromPipeline = $True ) ][ String ]    $URL , #- - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            [ Parameter ( Position =  4 , ValueFromPipeline = $True ) ][ String ]   $Args ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( ( Test-Path $Path ) -ne $True ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        {   NI $Path -ItemType Directory -Value $Path # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            Wrap-Action -Type "Created" -Info "[+] Directory @: $Path" } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        IWR -Uri $URL -OutFile "$Path\$File" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Wrap-Action -Type "Installing" -Info $ID # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-Action -Type "Processing" -Info "This could take a while." # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Dependency = SAPS -FilePath $File -Args $Args -WorkingDirectory $Path -PassThru # - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        For ( $j = 0 ; $j -le 100 ; $j = ( $j + 1 ) % 100 ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        {   Write-Progress -Activity " [ Installing ] $ID" -PercentComplete $j -Status "$( $j )% Complete" # - - - - - - - - - - - - - - - - - - - -//#
            Sleep -Milliseconds 250 # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            If ( $Dependency.HasExited ) { Write-Progress -Activity "[ Installed ]" -Completed ; Return } } } #- - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#//- [ Export-Ini ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Export-Ini #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    {   [ CmdletBinding () ] Param ( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                                                                                           [ Switch ]      $Append , # - - - - - - - - - - - - - - -//#
            [ ValidateSet ("Unicode","UTF7","UTF8","UTF32","ASCII","BigEndianUnicode","Default","OEM") ] #- - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter (                   ) ]                                            [ String ]    $Encoding , # - - - - - - - - - - - - - - -//#
            [ ValidateNotNullOrEmpty () ][ ValidatePattern ( '^([a-zA-Z]\:)?.+\.ini$' ) ] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            [ Parameter ( Mandatory = $True ) ]                                            [ String ]    $FilePath , # - - - - - - - - - - - - - - -//#
                                                                                           [ Switch ]       $Force , #- - - - - - - - - - - - - - - \\#
            [ ValidateNotNullOrEmpty () ][ Parameter ( ValueFromPipeline = $True , Mandatory = $True ) ] # - - - - - - - - - - - - - - - - - - - - -//#
                                                                                        [ Hashtable ] $InputObject , #- - - - - - - - - - - - - - - \\#
                                                                                           [ Switch ]    $Passthru ) # - - - - - - - - - - - - - - -//#
        Begin   { Wrap-Action -Type "Processing" -Info "$( $MyInvocation.MyCommand.Name )" } #- - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Process { Wrap-Action -Type    "Writing" -Info "$( $FilePath )" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            If ( $Append ) { $Outfile = Get-Item $FilePath } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            Else { $OutFile = NI -ItemType File -Path $FilePath -Force:$Force } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            If ( ! ( $OutFile ) ) { Wrap-Action -Type "Exception" -Info "Unable to access file" } # - - - - - - - - - - - - - - - - - - - - - - - - \\#
            ForEach ( $q in $InputObject.Keys ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            {   If ( ! ( $( $InputObject[$q].GetType().Name ) -eq "Hashtable" ) ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                {   Wrap-Action -Type "Key" -Info "[+] $q" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                    AC -Path $OutFile -Value "$q=$( $InputObject[$q] )" -Encoding $Encoding } # - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                Else # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                {   Wrap-Action -Type "Section" -Info "[+] $q" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                    AC -Path $OutFile -Value "[$q]" -Encoding $Encoding } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                ForEach ( $z in $( $InputObject[$q].Keys | Sort-Object ) ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                {   If ( $z -Match "^Comment[\d]+" ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                    {   Wrap-Action -Type "Property" -Info "[+] $z" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                        AC -Path $OutFile -Value "$( $InputObject[$q][$z] )" -Encoding $Encoding } # - - - - - - - - - - - - - - - - - - - - - - - -//#
                    Else #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                    {   Wrap-Action -Type "Key" -Info "[+] $z" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                        AC -Path $OutFile -Value "$z=$( $InputObject[$q][$z] )" -Encoding $Encoding } } # - - - - - - - - - - - - - - - - - - - - - \\#
                AC -Path $OutFile -Value "" -Encoding $Encoding } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            Wrap-Action -Type "Completed" -Info "$( $MyInvocation.MyCommand.Name ): $FilePath" #- - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            If ( $PassThru ) { Return $OutFile } } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        End     { Wrap-Action -Type "Exiting" -Info "$( $MyInvocation.MyCommand.Name )" } } # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ Display-TrueColors ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Display-TrueColors # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    {   Wrap-Array -Block @( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
" //                                                                                                          \\ " ; #- - - - - - - - - - - - - - - \\#
" \\        ________________________________________________________________________________________          // " ; # - - - - - - - - - - - - - - -//#
" //       //                                     |                                                \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\   *     *     *     *     *     *   - - - - - - - - - - - - - - - - - - - - - - - - -//         // " ; # - - - - - - - - - - - - - - -//#
" //       //      *     *     *     *     *      |                                                \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\   *     *     *     *     *     *    - - - - - - - - - - - - - - - - - - - - - - - - //         // " ; # - - - - - - - - - - - - - - -//#
" //       //      *     *     *     *     *      |  [ Dynamically Engineered Digital Security ]   \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\   *     *     *     *     *     *   - - - - - - - - - - - - - - - - - - - - - - - - -//         // " ; # - - - - - - - - - - - - - - -//#
" //       //      *     *     *     *     *      |                                                \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\   *     *     *     *     *     *    - - - - - - - - - - - - - - - - - - - - - - - - //         // " ; # - - - - - - - - - - - - - - -//#
" //       //      *     *     *     *     *      | [ Application Development - Virtualization ]   \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\   *     *     *     *     *     *   - - - - - - - - - - - - - - - - - - - - - - - - -//         // " ; # - - - - - - - - - - - - - - -//#
" //       //      *     *     *     *     *      |      [ Network & Hardware Magistration ]       \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\   *     *     *     *     *     *    - - - - - - - - - - - - - - - - - - - - - - - - //         // " ; # - - - - - - - - - - - - - - -//#
" //       //                                     |                                                \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//         // " ; # - - - - - - - - - - - - - - -//#
" //       //                                   {_______________}                                  \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\- - - - - - - - - - - - - - - - - - \             / - - - - - - - - - - - - - - - - - //         // " ; # - - - - - - - - - - - - - - -//#
" //       //                   { __________{ _ _]             [_ _ }__________ }                  \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\ - - - - - - - - - - - - - {_______/  H Y B R I D  \______}- - - - - - - - - - - - - -//         // " ; # - - - - - - - - - - - - - - -//#
" //       //               { _ _ _ _ { _ _ _ _ \               / _ _ _ _ } _ _ _ _ }              \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\- - - - - - - - - - - { _ _ _ _ _ _]      B Y      [_ _ _ _ _ _ } - - - - - - - - - - //         // " ; # - - - - - - - - - - - - - - -//#
" //       //                                                                                      \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\ - - - - - - - - - [  S E C U R E   D I G I T S   P L U S   L L C  ] - - - - - - - - -//         // " ; # - - - - - - - - - - - - - - -//#
" //       //                                                                                      \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\- - - - - - - - - -\_______________________________________________/- - - - - - - - - //         // " ; # - - - - - - - - - - - - - - -//#
" //       //                                                                                      \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\ - - - - - -[  0 7 / 1 8 / 2 0 1 9  |  M I C H A E L  C  C O O K  S R . ]- - - - - - -//         // " ; # - - - - - - - - - - - - - - -//#
" //       //                                                                                      \\         \\ " ; #- - - - - - - - - - - - - - - \\#
" \\       \\______________________________________________________________________________________//         // " ; # - - - - - - - - - - - - - - -//#
" //                                                                                                          \\ " ; #- - - - - - - - - - - - - - - \\#
" \\                                    [ A heightened sense of security ]                                    // " ; # - - - - - - - - - - - - - - -//#
" //                                                                                                          \\ " ) #- - - - - - - - - - - - - - - \\#
Sleep -Seconds 2 } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#//- [ Display-Foot ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    Function Display-Foot #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    {   Wrap-Array -Block @( #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
" //                                                                                                          \\ " ; # - - - - - - - - - - - - - - -//#
" \\  <@[ Script-Complete ]@>                                                                                 // " ; #- - - - - - - - - - - - - - - \\#
" //                                                                                                          \\ " ; # - - - - - - - - - - - - - - -//#
" \\                      [ Secure Digits Plus LLC | Hybrid ] [ Desired State Controller ]                    // " ; #- - - - - - - - - - - - - - - \\#
" //                                                                                                          \\ " ; # - - - - - - - - - - - - - - -//#
" \\                                   [ https://www.securedigitsplus.com ]                                   // " ; #- - - - - - - - - - - - - - - \\#
" //                                                                                                          \\ " ; # - - - - - - - - - - - - - - -//#
" \\                                    [ A heightened sense of security ]                                    // " ; #- - - - - - - - - - - - - - - \\#
" //                                                                                                          \\ " ) # - - - - - - - - - - - - - - -//#
Read-Host "Press Enter to exit" } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ \\#
#\\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\  [ Provision-Installation ] @: Initializes the Installation GUI                                                                                 //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ //#
#// \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \\#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    Function Provision-Installation # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    {   [ Net.ServicePointManager ]::SecurityProtocol = [ Net.SecurityProtocolType ]::TLS12 #- - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    ( $Background , $Banner ) = ( "sdp-bg.jpg" , "banner.png" | % { "$Home\Downloads\$_" } ) # - - - - - - - - - - - #- - - - - - - - - - - - - - - \\#
    $Named = @( 0..4 | % { "r$_" } ; 0..2 | % { "iis$_" } ; 0..2 | % { "dc$_" } ; 0..3 | % { "p$_" } ; 0..1 | % { "img$_" } ; 0 | % { "n$_" }) # - -//#
    $T0_Tags  = @( "" ; "" ; "System Root 'C:\'" ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    @( "Secured" | % { "Deploy Folder '$_'" , "SMB Name '$_$'" , "PSDrive '$_`:'" } ) + "Share Description '[Dev]'" ;# - - - - - - - - - - - - - - -//#
    "";"";"BITS / IIS Name 'Hybrid'" ; "IIS App Pool 'SecureApp'" ; "Virtual Host / Proxy" ;"";""; "NetBIOS Domain" ;#- - - - - - - - - - - - - - - \\#
    @( "User" , "P/W" | % { "Child Admin $_" } ) ) # - @: I'm well aware this can all be reduced in line #, but there's a reason I did it this way -//#
    $T0_Offs  = @( "" ; "" ; @( $Named[0..4] ) + "" ; "" ; @( $Named[5..7] ) + "" ; "" ; @( $Named[8..10] ) ) # - - - - - - - - - - - - - - - - - - \\#
    $T0_List  = @{ # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    RowDef    = @( 0..16                 | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    "                            <RowDefinition Height                    =                               '*' />
    "}) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    TextBlock = @( 2..6 + 9..11 + 14..16 | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    "                      <TextBlock 
                                                Grid.Row             =                                '$_' 
                                                Grid.Column          =                                '0' 
                                                Margin               =                                '5' 
                                                FontSize             =                               '12' 
                                                HorizontalAlignment  =                           'Center'
                                                Foreground           =                             'Black' >
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        ShadowDepth  =                                '3' 
                                                        Color        =                             'Cyan' />
                                                </TextBlock.Effect>
                                                    $( $T0_Tags[$_] )
                           </TextBlock>
    "}) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    TextBoxes = @( 2..6 + 9..11 + 14..15 | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    "                       <TextBox  
                                                Name                 =                               '$( $T0_Offs[$_] )' 
                                                Grid.Row             =                               '$_' 
                                                Grid.Column          =                                '1' 
                                                Margin               =                                '5' 
                                                Height               =                               '20' 
                                                FontSize             =                               '10' />
    "}) + @( 16                          | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    "                       <PasswordBox 
                                                Name                 =                               '$( $T0_Offs[$_] )'
                                                Grid.Row             =                               '$_' 
                                                Grid.Column          =                                '1' 
                                                Margin               =                                '5' 
                                                Height               =                               '20' 
                                                FontSize             =                               '10' 
                                                PasswordChar         =                                '*' >
                            </PasswordBox>
    "})} # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    $T1_Tags  = @( ""; "Company Name" ; @( "Website" , "Phone" , "Hours" | % { "Support $_" ; } ) + # - - - - - - - - - - - - - - - - - - - - - - - \\#
    ""; "Logo [ 120x120.bmp ]" ; "Background" ;""; "Branch / FQDN" ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    $T1_Offs  = @( "" ; @( $Named[11..14] ) + "" ; @( $Named[15..16] ) + "" ; $( $Named[17] ) ) # - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    $T1_List  = @{ RowDef    = @( 0..10 | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    "                            <RowDefinition Height                    =                               '32' /> 
    "}) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                   TextBlock = @( 1..4 + 6 , 7 , 9 | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    "                      <TextBlock 
                                                Grid.Row             =                                '$_' 
                                                Grid.Column          =                                '0' 
                                                HorizontalAlignment  =                           'Center' 
                                                VerticalAlignment    =                           'Center' 
                                                FontSize             =                               '12' 
                                                Margin               =                                '5'
                                                Foreground           =                             'Lime' >
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        ShadowDepth  =                                '2' 
                                                        Color        =                             'Cyan' />
                                                </TextBlock.Effect>
                                                    $( $T1_Tags[$_] )
                           </TextBlock>
    "}) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    TextBoxes = @( 1..4 + 6 , 7 , 9 | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    "                       <TextBox 
                                                Name                 =                               '$( $T1_Offs[$_] )'
                                                Grid.Row             =                                '$_' 
                                                Grid.Column          =                                '1' 
                                                Height               =                               '20' 
                                                FontSize             =                               '10' 
                                                Margin               =                                '5' />
    "})} #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #// - [ Installation-GUI XAML ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    $XAMLRoot = @"
    <Window
                    xmlns                 =       'http://schemas.microsoft.com/winfx/2006/xaml/presentation'
                    xmlns:x               =                    'http://schemas.microsoft.com/winfx/2006/xaml'
                    Title                 =    '[ Secure Digits Plus LLC | Hybrid ] Desired State Controller' 
                    Width                 =                                                             '640' 
                    Height                =                                                             '850' 
                    WindowStartupLocation =                                                    'CenterScreen'
                    Topmost               =                                                            'True' 
                    HorizontalAlignment   =                                                          'Center'
                    ResizeMode            =                                                        'NoResize'  >
        <StackPanel>
            <StackPanel.Background>
                <ImageBrush ImageSource   =                                                     '$Background' 
                            Stretch       =                                                   'UniformToFill' />
            </StackPanel.Background>
            <StackPanel
                    Height                =                                                             '250'  >
                <Image 
                    Width                 =                                                             '640' 
                    Height                =                                                             '240' 
                    Source                =                                                         '$Banner' 
                    HorizontalAlignment   =                                                          'Center' 
                    Margin                =                                                             '10' />
            </StackPanel>
            <StackPanel 
                    Height                =                                                             '515'  >
                <TabControl 
                    Height                =                                                             '515' 
                    HorizontalContentAlignment =                                                     'Center' 
                    HorizontalAlignment   =                                                          'Center' 
                    VerticalAlignment     =                                                          'Center' 
                    Background            =                                                        '{x:Null}' 
                    BorderBrush           =                                                        '{x:Null}' 
                    Foreground            =                                                        '{x:Null}' 
                    Margin="10,0">
                    <TabItem 
                        Header            =                                         'Stage Deployment Server' 
                        HorizontalAlignment =                                                        'Center' 
                        Width             =                                                             '160' 
                        BorderBrush       =                                                        '{x:Null}'  >
                        <TabItem.Effect>
                            <DropShadowEffect/>
                        </TabItem.Effect>
                        <Grid 
                            Height            =                                                         '480' 
                            VerticalAlignment =                                                         'Top'  >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width =                                              '0.5*' />
                                <ColumnDefinition Width =                                              '0.5*' />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                $( $T0_List.RowDef )
                            </Grid.RowDefinitions>
                            <TextBlock 
                                                    Grid.Row             =                                '0'
                                                    Grid.Column          =                                '0'
                                                    Grid.ColumnSpan      =                                '2'
                                                    Margin               =                                '5' 
                                                    FontSize             =                               '14' 
                                                    HorizontalAlignment  =                           'Center'
                                                    TextAlignment        =                           'Center'
                                                    Foreground           =                             'Lime'  >
                                # - - - - - [ MDT Base Share Settings ] - - - - - #
                                <TextBlock.Effect>
                                    <DropShadowEffect/>
                                </TextBlock.Effect>
                            </TextBlock>
                            <TextBlock 
                                                    Grid.Row             =                                '1'
                                                    Grid.Column          =                                '0'
                                                    Grid.ColumnSpan      =                                '2'
                                                    Margin               =                                '5' 
                                                    FontSize             =                               '12' 
                                                    HorizontalAlignment  =                           'Center'
                                                    TextAlignment        =                           'Center'
                                                    Foreground           =                             'Cyan' >
                                <TextBlock.Effect>
                                    <DropShadowEffect/>
                                </TextBlock.Effect>
                                These settings will generate a new MDT share
                            </TextBlock>
                            $( $T0_List.TextBlock[0..4] )
                            <RadioButton            x:Name              =                            'Legacy' 
                                                    Grid.Row            =                                 '7'
                                                    Grid.Column         =                                 '0' 
                                                    Margin              =                                 '5' 
                                                    Content             =                          'Disabled' 
                                                    HorizontalAlignment =                            'Center' 
                                                    VerticalAlignment   =                            'Center'
                                                    Foreground          =                              'Cyan' 
                                                    IsEnabled           =                             'False' >
                                <RadioButton.Effect>
                                    <DropShadowEffect/>
                                </RadioButton.Effect>
                            </RadioButton>
                            <RadioButton            x:Name              =                        'PowerShell' 
                                                    Grid.Row            =                                 '7' 
                                                    Grid.Column         =                                 '1' 
                                                    Margin              =                                 '5' 
                                                    Content             =                          'Disabled' 
                                                    HorizontalAlignment =                            'Center' 
                                                    VerticalAlignment   =                            'Center' 
                                                    Foreground          =                              'Cyan'
                                                    IsEnabled           =                             'False' >
                                <RadioButton.Effect>
                                    <DropShadowEffect/>
                                </RadioButton.Effect>
                            </RadioButton>
                            <!-- # - - - - [ BITS / IIS Config ] - - - - #  -->
                            <TextBlock 
                                                    Grid.Row             =                                '8'
                                                    Grid.Column          =                                '0'
                                                    Grid.ColumnSpan      =                                '2' 
                                                    Margin               =                                '5' 
                                                    FontSize             =                               '14'
                                                    HorizontalAlignment  =                           'Center'
                                                    TextAlignment        =                           'Center'
                                                    Foreground           =                             'Lime' >
                                <TextBlock.Effect>
                                    <DropShadowEffect/>
                                </TextBlock.Effect>
                            # - - - - - - - - [ BITS / IIS Config ] - - - - - - - - #
                            </TextBlock>
                            $( $T0_List.TextBlock[5..7] )
                            <RadioButton 
                                                    x:Name               =                            'IIS_I'
                                                    Grid.Row             =                               '12'
                                                    Grid.Column          =                                '0'
                                                    Margin               =                                '5' 
                                                    Content              =                         'Disabled' 
                                                    HorizontalAlignment  =                           'Center'
                                                    VerticalAlignment    =                           'Center' 
                                                    Foreground           =                             'Cyan' 
                                                    IsEnabled            =                            'False' >
                                <RadioButton.Effect>
                                    <DropShadowEffect/>
                                </RadioButton.Effect>
                            </RadioButton>
                            <RadioButton 
                                                    x:Name               =                            'IIS_X'
                                                    Grid.Row             =                               '12'
                                                    Grid.Column          =                                '1'
                                                    Margin               =                                '5'
                                                    Content              =                         'Disabled'
                                                    HorizontalAlignment  =                           'Center'
                                                    VerticalAlignment    =                           'Center'
                                                    Foreground           =                             'Cyan'
                                                    IsEnabled            =                            'False' >
                                <RadioButton.Effect>
                                    <DropShadowEffect/>
                                </RadioButton.Effect>
                            </RadioButton>
                            <TextBlock 
                                                    Grid.Row             =                               '13'
                                                    Grid.Column          =                                '0' 
                                                    Grid.ColumnSpan      =                                '2' 
                                                    Margin               =                                '5'
                                                    FontSize             =                               '14'
                                                    HorizontalAlignment  =                           'Center'
                                                    TextAlignment        =                           'Center'
                                                    Foreground           =                             'Lime' >
                                <TextBlock.Effect>
                                    <DropShadowEffect/>
                                </TextBlock.Effect>
                            # - - [ Network and Source Credentials ]  - - #
                            </TextBlock>
                            $( $T0_List.TextBlock[8..10] )
                            $( $T0_List.TextBoxes[0..10] )
                        </Grid>
                    </TabItem>
                    <TabItem 
                        Header                                           =                       'Image Info' 
                        HorizontalAlignment                              =                           'Center' 
                        Width                                            =                              '150' 
                        BorderBrush                                      =                         '{x:Null}' >
                        <TabItem.Effect>
                            <DropShadowEffect/>
                        </TabItem.Effect>
                        <Grid 
                            Height                                       =                              '400' 
                            VerticalAlignment                            =                              'Top' >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width                  =                             '0.5*' />
                                <ColumnDefinition Width                  =                             '0.5*' />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                            $( $T1_List.RowDef )
                            </Grid.RowDefinitions>
                            <TextBlock 
                                                    Grid.Row             =                                '0'
                                                    Grid.Column          =                                '0' 
                                                    Grid.ColumnSpan      =                                '2' 
                                                    Margin               =                                '5'
                                                    FontSize             =                               '14'
                                                    HorizontalAlignment  =                           'Center'
                                                    TextAlignment        =                           'Center'
                                                    Foreground           =                             'Lime' >
                                <TextBlock.Effect>
                                    <DropShadowEffect/>
                                </TextBlock.Effect>
                            # - - [ Company Information ]  - - #
                            </TextBlock>
                            $( $T1_List.TextBlock[0..3] )
                            <TextBlock 
                                                    Grid.Row             =                                '5'
                                                    Grid.Column          =                                '0' 
                                                    Grid.ColumnSpan      =                                '2' 
                                                    Margin               =                                '5'
                                                    FontSize             =                               '14'
                                                    HorizontalAlignment  =                           'Center'
                                                    TextAlignment        =                           'Center'
                                                    Foreground           =                             'Lime' >
                                <TextBlock.Effect>
                                    <DropShadowEffect/>
                                </TextBlock.Effect>
                            # - - [ Custom Graphics ]  - - #
                            </TextBlock>
                            $( $T1_List.TextBlock[ 4..5 ] )
                            <TextBlock 
                                                    Grid.Row             =                                '8'
                                                    Grid.Column          =                                '0' 
                                                    Grid.ColumnSpan      =                                '2' 
                                                    Margin               =                                '5'
                                                    FontSize             =                               '14'
                                                    HorizontalAlignment  =                           'Center'
                                                    TextAlignment        =                           'Center'
                                                    Foreground           =                             'Lime' >
                                <TextBlock.Effect>
                                    <DropShadowEffect/>
                                </TextBlock.Effect>
                            # - - [ Network Definitions ]  - - #
                            </TextBlock>
                            $( $T1_List.TextBlock[ 6 ] )
                            $( $T1_List.TextBoxes )
                        </Grid>
                    </TabItem>
                </TabControl>
            </StackPanel>
            <StackPanel 
                    Orientation                                          =                       'Horizontal' 
                    FlowDirection                                        =                      'LeftToRight' 
                    VerticalAlignment                                    =                           'Bottom' 
                    HorizontalAlignment                                  =                           'Center' 
                    Height                                               =                               '40' 
                    Margin                                               =                      '150,0,150,0' >
                <Button 
                    Name                                                 =                            'Start'  
                    Content                                              =                            'Start'  
                    HorizontalAlignment                                  =                             'Left'  
                    Height                                               =                               '20' 
                    Width                                                =                              '170' />
                <Button 
                    Name                                                 =                           'Cancel' 
                    Content                                              =                           'Cancel' 
                    HorizontalAlignment                                  =                            'Right' 
                    Height                                               =                               '20' 
                    Width                                                =                              '170' />
            </StackPanel>
        </StackPanel>
    </Window>
"@
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    #// -[ Installation-GUI Launcher ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    $GUI = Convert-XAMLtoWindow -Xaml $XAMLRoot -NamedElement @( $Named ; "Start" ; "Cancel" ) -PassThru #- - - - - - - - - - - - - - - - - - - - - //#
    $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False }) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    $GUI.Start.Add_Click({ #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    $0 = @( "File System/Drive" ;          "Root Folder" ;    "Network Share Name" ;      "PSDrive Name" ; # - - - - - - - - - - - - - - - - - - - -\\#
            "Share Description" ;            "Site Name" ; "Application Pool Name" ; "Virtual Directory" ; #- - - - - - - - - - - - - - - - - - - - //#
                 "NetBIOS Name" ; "Target/LM Admin User" ;  "Target/LM Admin Pass" ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    $1 = $0 | % { "You must enter a $_" } ; $2 = $0 | % { "$_ Missing" } ; $MSG = 0..16 | % { [ Type ] $Message } # - - - - - - - - - - - - - - - - //#
    If     (      $GUI.r0.Text -eq "" ) { ( $MSG[ 0] )::Show( $1[ 0] , $2[ 0] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (      $GUI.r1.Text -eq "" ) { ( $MSG[ 1] )::Show( $1[ 1] , $2[ 1] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    ElseIf (      $GUI.r2.Text -eq "" ) { ( $MSG[ 2] )::Show( $1[ 2] , $2[ 2] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (      $GUI.r3.Text -eq "" ) { ( $MSG[ 3] )::Show( $1[ 3] , $2[ 3] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    ElseIf (      $GUI.r4.Text -eq "" ) { ( $MSG[ 4] )::Show( $1[ 4] , $2[ 4] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (    $GUI.iis0.Text -eq "" ) { ( $MSG[ 5] )::Show( $1[ 5] , $2[ 5] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    ElseIf (    $GUI.iis1.Text -eq "" ) { ( $MSG[ 6] )::Show( $1[ 6] , $2[ 6] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (    $GUI.iis2.Text -eq "" ) { ( $MSG[ 7] )::Show( $1[ 7] , $2[ 7] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    ElseIf (     $GUI.dc0.Text -eq "" ) { ( $MSG[ 8] )::Show( $1[ 8] , $2[ 8] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (     $GUI.dc1.Text -eq "" ) { ( $MSG[ 9] )::Show( $1[ 9] , $2[ 9] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    ElseIf ( $GUI.dc2.Password -eq "" ) { ( $MSG[10] )::Show( $1[10] , $2[10] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (      $GUI.p0.Text -eq "" ) { ( $MSG[11] )::Show( $1[11] , $2[11] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    ElseIf (      $GUI.p1.Text -eq "" ) { ( $MSG[12] )::Show( $1[12] , $2[12] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (      $GUI.p2.Text -eq "" ) { ( $MSG[13] )::Show( $1[13] , $2[14] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    ElseIf (      $GUI.p3.Text -eq "" ) { ( $MSG[14] )::Show( $1[14] , $2[14] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (    $GUI.img0.Text -eq "" ) { ( $MSG[15] )::Show( $1[15] , $2[15] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    ElseIf (    $GUI.img1.Text -eq "" ) { ( $MSG[16] )::Show( $1[16] , $2[16] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    ElseIf (      $GUI.n0.Text -eq "" ) { ( $MSG[17] )::Show( $1[17] , $2[17] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    Else { $GUI.DialogResult = $True }}) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    #//- [ Turning Variables into 'The GUI' ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    $Output = Show-WPFWindow -GUI $GUI # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    If ( $Output -eq $True ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    {   $SP = $GUI.dc2.SecurePassword #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $LMCRED = New-Object -TypeName System.Management.Automation.PSCredential -Args $GUI.dc1.Text , $SP #- - - - - - - - - - - - - - - - - - - - //#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    #//- [ Exporting the variables to a hash table ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    $DSC = [ Ordered ]@{R00_Company     =                                          "$( $GUI.p0.Text )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R01_UNCRoot     = "\\$( $Env:ComputerName )\$( $GUI.r2.Text.TrimEnd( '$' ) )$" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R02_Hostname    =                                     "$( $Env:ComputerName )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R03_DC_User     =                                      "$( $DCCred.Username )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R04_DC_Pass     =                                      "$( $DCCred.Password )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R05_WWW_Site    =                                          "$( $GUI.p1.Text )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R06_Phone       =                                          "$( $GUI.p2.Text )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R07_Hours       =                                          "$( $GUI.p3.Text )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R08_Logo        =                                        "$( $GUI.img0.Text )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R09_Background  =                                        "$( $GUI.img1.Text )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R10_Branch      =                                          "$( $GUI.n0.Text )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R11_Domain      =                                    "$( $env:USERDNSDOMAIN )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R12_LM_User     =                                      "$( $LMCRED.Username )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R13_LM_Pass     =               "$( $LMCRED.GetNetworkCredential().Password )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R14_Proxy       =                                     "$( $Env:ComputerName )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R15_NetBIOS     =                                       "$( $Env:UserDomain )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R16_DSC_Folder  =     "$( $GUI.r0.Text.TrimEnd( '\' ) )\$( ( $GUI.r1.Text ) )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R17_PSDrive     =                           "$( $GUI.r3.Text.TrimEnd( ':' ) )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R18_PSDrive_ID  =                                          "$( $GUI.r4.Text )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R19_BITS_Name   =                                        "$( $GUI.iis0.Text )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R20_BITS_Pool   =                                        "$( $GUI.iis1.Text )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        R21_BITS_Host   =                                        "$( $GUI.iis2.Text )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        R22_BITS_Root   =                            "https://$( $Env:USERDNSDOMAIN )" } # - - - - - - - - - - - - - - - - - - - - -//#
                        $NRoot          = "\\$( $Env:ComputerName )\$( $GUI.r2.Text.TrimEnd( '$' ) )$" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        $URI            =     "$( $GUI.r0.Text.TrimEnd( '\' ) )\$( ( $GUI.r1.Text ) )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        $SMB            =                          "$( $GUI.r2.Text.TrimEnd( '$' ) )$" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        $PSD            =                           "$( $GUI.r3.Text.TrimEnd( ':' ) )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        $TAG            =                                          "$( $GUI.r4.Text )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        $SiteRoot       =                                                  "$( $URI )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        $SiteName       =                                        "$( $GUI.iis0.Text )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        $SitePool       =                                        "$( $GUI.iis1.Text )" # - - - - - - - - - - - - - - - - - - - - - -//#
                        $Vhost          =                                        "$( $GUI.iis2.Text )" #- - - - - - - - - - - - - - - - - - - - - - \\#
                        $PName          =                                          "$( $GUI.p0.Text )" # - - - - - - - - - - - - - - - - - - - - - -//#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #//- [ Common Variables ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $CPU     =                                                            $env:PROCESSOR_ARCHITECTURE    # CPU Arch                             //#
        $SRV     =                                                                      $env:COMPUTERNAME    # Server Name                          \\#
        $Install =                                               "$Env:SystemDrive\Secure Digits Plus LLC"   # Install Folder                       //#
        $MDTFile =                                                         "MicrosoftDeployment`Toolkit_x"   # MDT File                             \\#
        $MDTURL  =    "https://download.microsoft.com/download/3/3/9/339BE62D-B4B8-4956-B58D-73C4685FC492"   # MDT Base URL                         //#
        $ADK     =                                                 "Windows Assessment and Deployment Kit"   # ADK String                           \\#
        $MDT     =                                                          "Microsoft Deployment Toolkit"   # MDT String                           //#
        $7zu     =                                                              "https://www.7-zip.org/a"    # 7 Zip Base URL                       \\#
        $Install | ? { ( Test-Path $_ ) -ne $True } | % { NI -Path $_ -ItemType Directory }
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #// - [ Registry Checker ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Path = "" , "\WOW6432Node" | % { "HKLM:\Software$_\Microsoft\Windows\CurrentVersion\Uninstall" } # - - - - - - - - - - - - - - - - - - - - \\#
        If ( $CPU -eq "x86" ) { $Reg = $Path[   0] | % { GP "$_\*" } ; $MDTFile = "$MDTFile`86.msi" ; $7zip = "7Z1900.exe"     } # - - - - - - - - -//#
        Else                  { $Reg = $Path[0..1] | % { GP "$_\*" } ; $MDTFile = "$MDTFile`64.msi" ; $7zip = "7z1900-x64.exe" } #- - - - - - - - - \\#
        #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $List = @{ # - [ Because real men use hash tables with arrays in them ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        0 = # - [ Windows ADK ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                                                                             "Deployment Kit - Windows 10" , # Regex String                         //#
                                                                                            "10.1.17763.1" , # Minimum Version                      \\#
                                                                                                  "WinADK" , # ID                                   //#
                                                                   "Windows Assessment and Deployment Kit" , # Title                                \\#
                                                                                         "$Install\WinADK" , # Target Path                          //#
                                                                                          "winadk1903.exe" , # Target File                          \\#
                                                         "https://go.microsoft.com/fwlink/?linkid=2086042" , # URL                                  //#
                                                "/quiet /norestart /log $env:temp\win_adk.log /features +"   # Silent Arguments                     \\#
        1 = # - [ Windows PE ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                                                                         "Preinstallation" , # Regex String                         \\#
                                                                                            "10.1.17763.1" , # Minimum Version                      //#
                                                                                                   "WinPE" , # ID                                   \\#
                                                                 "Windows ADK Preinstallation Environment" , # Title                                //#
                                                                                          "$Install\WinPE" , # Target Path                          \\#
                                                                                           "winpe1903.exe" , # Target File                          //#
                                                         "https://go.microsoft.com/fwlink/?linkid=2087112" , # URL                                  \\#
                                                "/quiet /norestart /log $env:temp\win_adk.log /features +"   # Silent Arguments                     //#
        2 = # - [ Microsoft Deployment Toolkit ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                                                                                         "Deployment Tool" , # Regex String                         //#
                                                                                           "6.3.8450.0000" , # Minimum Version                      \\#
                                                                                                     "MDT" , # ID                                   //#
                                                                            "Microsoft Deployment Toolkit" , # Title                                \\#
                                                                                            "$Install\MDT" , # Target Path                          //#
                                                                                                "$MDTFile" , # Target File                          \\#
                                                                                        "$MDTURL/$MDTFile" , # URL                                  //#
                                                                                       "/quiet /norestart"   # Silent Arguments                     \\#
        3 = # - [ 7-Zip ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                                                                                   "7-Zip" , # Regex String                         \\#
                                                                                                   "19.00" , # Minimum Version                      //#
                                                                                                   "7-Zip" , # ID                                   \\#
                                                                                 "7-Zip Archiving Utility" , # Title                                //#
                                                                                          "$Install\7-Zip" , # Target Path                          \\#
                                                                                                   "$7zip" , # Target File                          //#
                                                                                              "$7zu/$7zip" , # URL                                  \\#
                                                                                                      "/S" } # Silent Arguments                     //#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    #// - [ Variables Declared, Run the loop ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Foreach ( $i in 0..3 ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        {   $Item = $Reg | ? { $_.DisplayName -like "*$( $List[$i][0] )*" } | Select DisplayName , DisplayVersion #- - - - - - - - - - - - - - - - -\\#
            If ( ( $Item -ne $Null ) -and ( $Item.DisplayVersion -ge $List[$i][1] ) ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
            {   Wrap-Action -Type "Dependency"  -Info "$( $List[$i][2] ) meets minimum requirements" } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
            Else #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
            {   Wrap-Action -Type "Dependency"  -Info "$( $List[$i][2] ) does not meet minimum requirements" # - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                Wrap-Action -Type "Downloading" -Info "$( $List[$i][2] )" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                Provision-Dependency -ID $List[$i][3] -Path  $List[$i][4] -File $List[$i][5] -URL $List[$i][6] -Args $List[$i][7] #- - - - - - - - -\\#
                If ( $? -eq $True ) { Wrap-Action -Type  "Successful" -Info "[+] $( $List[$i][2] ) Updated"          } #- - - - - - - - - - - - - - //#
                Else                { Wrap-Action -Type   "Exception" -Info "[!] $( $List[$i][2] ) Failed to update" # - - - - - - - - - - - - - - -\\#
                                      Read-Host "Press Enter to Exit" ; Exit } } } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    #// - [ Create the Base Deployment Share ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $MDTID = ( ( GP "HKLM:\SOFTWARE\Microsoft\Deployment 4" ).Install_Dir ).TrimEnd( '\' ) ; IPMO "$MDTID\Bin\MicrosoftDeploymentToolkit.psd1" #//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Create URI Folder ]-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( ( Test-Path $URI ) -eq $False ) { NI -Path $URI -ItemType Directory # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                                               If ( $? -eq $True ) { Wrap-Action -Type "Success" -Info "[+] '$URI' Created" } # - - - - - - - - - - \\#
                                               Else { Read-Host "Exception [!] '$URI' creation failed. Press Enter to Exit" ; Exit } } # - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Generate SMB Share ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( ( GSMBS | ? { $_.Path -eq $URI } -EA 0 ) -eq $Null ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        {   NSMBS -Name $SMB -Path $URI -Description $TAG -FullAccess Administrators #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            If ( $? -eq $True ) { Wrap-Action -Type     "Created" -Info "[+] SMB Share" } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            Else                { Wrap-Action -Type   "Exception" -Info "[!] New-SMBShare '$SMB' failed" #- - - - - - - - - - - - - - - - - - - - - \\#
                                  Read-Host "Press Enter to Exit" ; Exit } } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Generate PSDrive ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( ( GDR -Name $PSD -EA 0 ) -eq $Null ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        {   NDR -Name $PSD -PSProvider MDTProvider -Root $URI -Description $TAG -NetworkPath "$NRoot" | Add-MDTPersistentDrive #- - - - - - - - - - \\#
            If ( $? -eq $True ) { Wrap-Action -Type "Created" -Info "[+] New-PSDrive '$PSD'" } # - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            Else { Read-Host "Exception [!] New-PSDrive '$PSD' failed, Press Enter to Exit" ; Exit } } #- - - - - - - - - - - - - - - - - - - - - - \\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #//- [ Declare Registry Paths ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $RegRoot     =                                               'HKLM:\SOFTWARE\Policies' #- - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $RegFull     =    "Secure Digits Plus LLC\Hybrid\Desired State Controller\$PName\$PSD" # - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $RegRecurse  =                                                   $RegFull.Split( '\' ) #- - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #//- [ Create Registry Path ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        0 | % { If ( ( Test-Path "$RegRoot\$( $RegRecurse[0] )" ) -ne $True ) { $Null = NI -Path $RegRoot -Name $RegRecurse[0] } } #- - - - - - - - \\#
        $RegPath = "$RegRoot\$( $RegRecurse[0] )" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        1..4 | % {  If ( ( Test-Path "$RegPath\$( $RegRecurse[$_] )" ) -ne $True ) { $Null = NI -Path $RegPath -Name $RegRecurse[$_] } #- - - - - - \\#
                    $RegPath = "$RegPath\$( $RegRecurse[$_] )" } ; $RegFull = "$RegRoot\$RegFull" #- - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Create Registry Key/Value Pairs ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( ( Test-Path $RegFull ) -eq $True ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        {   $RegName = @() ; $RegValue = @() ; $DSC.Keys | % { $RegName += $_ } ; $DSC.Values | % { $RegValue += $_ } # - - - - - - - - - - - - - - \\#
            0..22 | % { SP -Path "$RegFull" -Name "$( $RegName[$_] )" -Value "$( $RegValue[$_] )" -Force } } # - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Error Handling ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Else { Wrap-Action -Type "Exception" -Info "The user exited the dialogue" ; Read-Host "Press Enter to Exit" ; Exit } # - - - - - - - - - - -//#
        #\\/\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/\\#
        #//\/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- -[ Switch It Up ( Legacy / PowerShell ) ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Switch ( $host.UI.PromptForChoice( 'PowerShell Deployment' , 'Standard MDT, or Upgrade to PSD-Development?' , #- - - - - - - - - - - - - - -//#
        [ System.Management.Automation.Host.ChoiceDescription [] ]@( '&Standard MDT' , '&PSD-Development' ) , [ Int ] 1 ) ) # - - - - - - - - - - - \\#
        {   0   #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                #// - [ What sissies will choose ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            {   Wrap-Action -Type "Selected" -Info "MDT [Deployment] Share created" } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            1   #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                #// - [ What real men will choose ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            {   Wrap-Action -Type "Creating" -Info "PowerShell [Deployment/Development] Share" #- - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                #// - [ PSD-Scripts ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                @( gci "$Install\$( $Scripts = "Scripts" )" -Filter "*.ps1" -EA 0 ).Name | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                Robocopy   "$Install\$Scripts"   "$URI\$Scripts" $_ ; Dir   "$URI\$Scripts\$_" | Unblock-File } #- - - - - - - - - - - - - - - - - -//#
                #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #// [ PSD-Templates ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                @( gci "$Install\$( $Templates = "Templates" )").Name | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                Robocopy "$Install\$Templates" "$URI\$Templates" $_ ; Dir "$URI\$Templates\$_" | Unblock-File } # - - - - - - - - - - - - - - - - - \\#
                #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                #// - [ PSD-Modules ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                "PSDGather", "PSDDeploymentShare", "PSDUtility", "PSDWizard" | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                $ModPath  = "$URI\$($Modules="Tools\Modules")\$_" ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                If ( ( Test-Path "$ModPath" ) -eq $False ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                {   $Null = NI "$ModPath" -ItemType Directory ; Wrap-Action -Type "Created" -Info "[+] Directory $_" } # - - - - - - - - - - - - - -//#
                Wrap-Action -Type "Copying" -Info "Module $_ to $ModPath" ; Robocopy "$Install\$Scripts" "$ModPath" "$_.psm1" # - - - - - - - - - - \\#
                Dir "$ModPath" | Unblock-File } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #//- [ PSD-SnapIns ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                Wrap-Action -Type "Copying" -Info "[+] $URI\$Modules" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                If ( ( Test-Path "$URI\$Modules\$($BDD="Microsoft.BDD").PSSnapin" ) -ne $True ) # - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                {   $Null = NI "$URI\$Modules\$BDD.PSSnapIn" -ItemType Directory # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                    Wrap-Action -Type "Created" -Info "[+] Directory" } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                $PSSnapIn = ( ( "" , ".config" , "-help.xml" | % { ".dll$_" } ) + ( ".Format" , ".Types" | % { "$_.ps1xml" } ) | % { ` # - - - - - -//#
                "PSSnapIn$_" } ) + ( "" , ".config" | % { "Core.dll$_" } ) + "ConfigManager.dll" | % { #- - - - - - - - - - - - - - - - - - - - - - \\#
                CP "$MDTDir\Bin\$BDD.$_" "$URI\$Modules\$BDD.PSSnapIn" } ; Wrap-Action -Type "Copying" -Info "[+] $URI\$Templates" # - - - - - - - -//#
                If ( ( Test-Path "$URI\$Templates" ) -eq $False ) { $Null = NI "$URI\$Templates" } #- - - - - - - - - - - - - - - - - - - - - - - - \\#
                "Groups" , "Medias" , "OperatingSystems" , "Packages" , "SelectionProfiles" , "TaskSequences" , "Applications" , "Drivers" , # - - -//#
                "LinkedDeploymentShares" | % { "$_.xsd" } | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                CP "$MDTDir\$Templates\$_" "$URI\$Templates" ; Wrap-Action -Type "Copying" -Info "[+] $URI\$Templates" } # - - - - - - - - - - - - -//#
                #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #//- [ "0" Touching - That means you, Zuckerberg XD... ( It's not cool to make fun of people Michael... Even if it is funny... )]- -//#
                #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                Wrap-Action -Type "Sending" -Info "[+] ZTIGather.XML to correct folder" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                ( gci $MDTDir\Templates\Distribution\Scripts -Filter "*Gather.xml" -EA 0 ) | % { CP $_.FullName "$URI\$Modules\PSDGather" } # - - - \\#
                #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                #// -[ Random things that I'll likely replace ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                $MsgType  = "Logs" , "Dynamics Logs Sub" , "DriverSources" , "DriverPackages" | % { "$_ Folder" } # - - - - - - - - - - - - - - - - \\#
                $DirType  = "Logs" ,          "Logs\Dyn" , "DriverSources" , "DriverPackages" #- - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                0..3 | % { Wrap-Action -Type "Creating" -Info "$( $Message[$_] ) in $URI\$( $Path[$_] )" #- - - - - - - - - - - - - - - - - - - - - \\#
                $Null = NI -ItemType Directory -Path "$URI\$( $Path[$_] )" -Force } } } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ / End Switch ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #///\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \///#
        #\\\/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\\\#
        #//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - [ Set-Permissions ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-Action -Type "Reducing" -Info "[~] Permissions Hardening on $SMB" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Target = "Users" , "Administrators" , "SYSTEM" | % { "$_`:(OI)(CI)(RX)" } ; $Target | % { $Null = ICACLS $URI /Grant "$_" } # - - - - - - -//#
        GRSMBA -Name $SMB -AccountName "EVERYONE" -AccessRight Change -Force ; RKSMBA -Name $SMB -AccountName "CREATOR OWNER" -Force #- - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// -[ Designate-SSLTLS ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $SSLTLS = "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols" ; $Types = "Client" , "Server" #- - - - - - - - - - \\#
        $SK2V   = ( 0..7 | % { 0 } ) + ( 8..9 | % { 1 } ) ; $Protocols = @( 2..3 | % { "SSL $_.0" } ) + @( 0..2 | % { "TLS 1.$_" } ) # - - - - - - -//#
        $Protocols | % { $Path = "$SSLTLS\$_" ; If ( ( Test-Path $Path ) -ne $True ) { NI -Path "$SSLTLS" -Name "$_" } #- - - - - - - - - - - - - - \\#
                                                $Types | % { If ( ( Test-Path "$Path\$_" ) -ne $True ) { NI -Path "$Path" -Name "$_" } } } # - - - -//#
        $Path   = @( $Protocols | % { "$SSLTLS\$_\Client" ; "$SSLTLS\$_\Server" } ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        0..( $Path.Count - 1 ) | % { If ( ( gci $Path ) -eq $Null ) { SP -Path ( $Path[$_] ) -Name "DisabledByDefault" -Type DWORD -Value 0 #- - - -//#
                                                                      SP -Path ( $Path[$_] ) -Name "Enabled" -Type DWORD -Value ( $SK2V[$_] ) } } # \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// - [ Deploy-Website ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        (  $SD , $Date , $LogPath , $Server ) = ( $env:SystemDrive , ( Get-Date -UFormat "%m-%d-%Y" ) , "$Home\Desktop\ACL" , $Env:ComputerName ) # \\#
        ( $PSP ,  $DWS ,     $SWS ,    $WSS ) = ( "Machine/Webroot/AppHost" , "$SiteName" , "System.WebServer" , "Security/Authentication" ) # - - -//#
                                        $Full = "IIS:\Sites\$SiteName\$VHost" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( ( Test-Path $SiteRoot ) -eq $False ) { NI -Path $SiteRoot -ItemType Directory -Name $SiteRoot # - - - - - - - - - - - - - - - - - - - -//#
            If ( $? -eq $True ) { Wrap-Action -Type "Successful" -Info "[+] '$SiteRoot' Created" } #- - - - - - - - - - - - - - - - - - - - - - - - \\#
            Else { Wrap-Action -Type "Exception"  -Info "[!] '$SiteRoot' failed to be created." ; Read-Host "Press Enter to Exit" ; Exit } } # - - -//#
        Else {     Wrap-Action -Type  "Detected"  -Info "[+] '$SiteRoot' already exists. . ." } # - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// [ Declare-WindowsFeatures ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Web = @(                   "Web-Server" ; # Installs the base 'Web Server functions ... ( $SE = Self Explanatory )                         \\#
                                   "DSC-Service" ; # Installs the Desired State Configuration Service                                               //#
                                      "FS-SMBBW" ; # Updates the file system to allow for Samba Bandwidth to be differentially allocated            \\#
                               "ManagementOData" ; # Creates an ASP.NET Web Service end point that exposes your management data ( Raw Doggin' it )  //#
                    "WindowsPowerShellWebAccess" ; # Allows for access to PS API over the web. Falls under $SE                                      \\#
                             "WebDAV-Redirector" ; # Allows for Web Server to use reverse/forward proxies, useful for security AND trolling people  //#
        @( "BITS" | % {                     "$_" ; # Background Intelligent Transfer Service - Sends/Receives files without being annoying          \\#
                                    "$_-IIS-Ext" ; # Extension for BITS to be used in Internet Information Services                                 //#
                                "RSAT-$_-Server" } ) ; # Allows for the remote administration of BITS, but in a less cool way than RDP              \\#
        @(  "Net" | % { "$_-Framework-45-ASPNET" ; # It's what you need to run any ASP.Net webpage in IIS                                           //#
                      "$_-WCF-HTTP-Activation45" } ) ; # It's the Windows Communication Foundation's way of attempting to be important              \\#
        @(                         @(  "App-Dev" ; # Application Development Module for IIS/Web                                                     //#
                                       "AppInit" ; # Initializes any WPF/C#/ASP applications for instance, MVC, or what have you.                   \\#
                                     "Asp-Net45" ; # Another Module for ASP                                                                         //#
                                    "Basic-Auth" ; # Allows for authentication that could be considered 'Basic'                                     \\#
                                   "Common-Http" ; # A bunch of functions that the 'machine/operating system' converts into 'visual objects'        //#
                                "Custom-Logging" ; # Allows for customized logging of whatever happens on your web server                           \\#
                                "DAV-Publishing" ; # Publishes WebDAV modules to use/distribute to other machines/systems                           //#
                                   "Default-Doc" ; # Falls under $SE                                                                                \\#
                                   "Digest-Auth" ; # More advanced than Basic authentication, but still pretty fkin basic...                        //#
                                  "Dir-Browsing" ; # Allows any authenticated user to browse the contents of the web directory                      \\#
                                     "Filtering" ; # Mime Types and things of that nature                                                           //#
                                        "Health" ; # If you don't understand how $SE this is..? Go outside. Stop trying to program or read scripts. \\#
                    @( "HTTP" | % {  "$_-Errors" ; # Falls under the above entry                                                                    //#
                                    "$_-Logging" ; # Also falls under that same entry                                                               \\#
                                   "$_-Redirect" ; # Works with WebDAV to keep people on the outside guessing what the hell is happening            //#
                                    "$_-Tracing" } ) ; # Like tracert but for 'tracking the IP addresses attempting to access the site'             \\#
                                      "Includes" ; # It allows static content to be more dynamic, without messing up the content                    //#
                   @( "ISAPI" | % {     "$_-Ext" ; # APPCMD.EXE ... and WebConfig, basically.                                                       \\#
                                     "$_-Filter" } ) ; # Allows 'Shell or VBScript to look through the content of WebConfig data. Similar to XML.   //#
                                 "Log-Libraries" ; # Pretty $SE if you ask me                                                                       \\#
                                      "Metabase" ; # Like a database, but for business or server side analytics... It's like CEIP without the OS    //#
                                  "Mgmt-Console" ; # Also rather $SE                                                                                \\#
                                     "Net-Ext45" ; # Yet another extension for ASP.Net to work with your website. Probably for turning C# into html //#
                                   "Performance" ; # $SE continued                                                                                  \\#
                               "Request-Monitor" ; # An analytical logbook that specifically logs SSI requests, pretty sure anyway                  //#
                                      "Security" ; # What every website should use, but, may not unless you've studied how to use it.               \\#
                              "Stat-Compression" ; # Takes statistics and zips em up                                                                //#
                                "Static-Content" ; # Works with Web-Includes                                                                        \\#
                                      "Url-Auth" ; # Similar to when you log into Gmail                                                             //#
                                     "WebServer" ; # The service that is nearly an exact replica of Apache                                          \\#
                                  "Windows-Auth" ) | % { "Web-$_" } ) ; # Allows the WebSite to use NTLM/Kerberos authentication ( Most Secure )    //#
        @( "WAS" | % {                      "$_" ; # Series of services that takes HTTP and says "You don't need HTTP. You can use whatever we tell \\#
                              "$_-Process-Model" ; # you to use, cause that's what Windows Process Activation Services means, it's just turning     //#
                                "$_-Config-APIs" } ) ) # HTML into XML and vice versa. Like $Magic = @( David | % { $_ Blaine ; $_ Copperfield } )  \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// - [ Install-WindowsFeatures using "0" XML files - What a "Desired State Controller" appears to be ] - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $GWF = @( Get-WindowsFeature ) ; $DWS = "Default Web Site" ; $SAS = "ServerAutoStart" # - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Check = ForEach ( $i in $Web ) { $GWF | ? { ( $_.Name -eq $i ) } } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Check | ? { $_.InstallState -eq "Installed" } | % { Echo "[ $( $_.Name ) ] [ $( $_.InstallState ) ]"  } #- - - - - - - - - - - - - - - - - \\#
        $Check | ? { $_.InstallState -ne "Installed" } | % { Install-WindowsFeature -Name $i }  #- - - - - - - - - - - - - - - - - - - - - - - - - -//#
        IPMO WebAdministration #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Get-Website -Name $DWS -EA 0 | ? { $_ -ne $Null -and $_.State -eq 'Running' } | % { Stop-Website | SP "IIS:\Sites\$DWS" $SAS False } # - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- -[ Check-WebServices ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        "MRxDAV" , "WebClient" | % { Get-Service -ComputerName $Server -Name $_ -EA 0 } | ? { $_.Status -ne "Running" } | % {  # - - - - - - - - - -//#
        Set-Service -ComputerName $Server -StartupType Automatic -EA 4 -Status Start -Name $_ } ; New-WebAppPool -Name $SitePool -Force # - - - - - \\#
        $N = "Enable32BitAppOnWin64" , "ManagedRuntimeVersion" , "ManagedPipelineMode" ; $V = "True" , "v4.0" , "Integrated" # - - - - - - - - - - -//#
        0..2 | % { SP -Path IIS:\AppPools\$SitePool -Name "$( $N[$_] )" -Value "$( $V[$_] )" } ; Restart-WebAppPool -Name $SitePool # - - - - - - - \\#
        New-Website -Name $SiteName -ApplicationPool $SitePool -PhysicalPath $SiteRoot -Force ; Start-Website -Name $SiteName #- - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Create-VHost ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        New-WebVirtualDirectory -Site "$SiteName" -Name "$Vhost" -PhysicalPath "$SiteRoot" -Force ; $SI = "IIS:\Sites\$SiteName\$Vhost" #- - - - - -//#
        ( $MWA , $SWS , $WSS , $STC ) = ( "MACHINE/WEBROOT/APPHOST" , "System.WebServer" , "Security/Authentication" , "StaticContent" ) #- - - - - \\#
        Set-WebConfigurationProperty -PSPath $MWA -Location $SiteName -Filter "$SWS/webdav/authoring" -Name "Enabled" -Value "True" #- - - - - - - -//#
        $DAV = "Set Config '$SiteName/$Vhost' /Section:$SWS/webdav/authoringRules /+[Users='*',Path='*',Access='Read,Source'] /Commit:AppHost" #- - \\#
        $Sys32 = "$SD\Windows\System32" ; $Results = SAPS "$Sys32\inetsrv\AppCMD.EXE" -Args $DAV -NoNewWindow -PassThru | Out-Null # - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Set-WebConfiguration ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( ! ( ( Get-WebConfigurationProperty -PSPath "$MWA" -Filter "$SWS/$STC" -Name "." ).Collection | ? { $_.FileExtension -eq ".*" } ) ) #- -//#
        { $Mi = Add-WebConfigurationProperty -PSPath $SI -Filter "$SWS/$STC" -Name "." -Value @{ FileExtension = '.*' ; MimeType = 'Text/Plain' } }#\\#
        Set-WebConfigurationProperty -Filter "/$SWS/DirectoryBrowse" -Name "Enabled" -PSPath "IIS:\Sites\$SiteName\$VHost" -Value $True # - - - - - //#
        $TGT = "anonymousAuthentication" , "windowsAuthentication" + # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        @( "webdav/authoring" | % { "$_`Rules" ; ( @( "$_/Properties" ) * 2 ) } ) + # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        @( ( $SRF = "security/RequestFiltering" ) | % { @( "$_/FileExtensions" ) * 2  + @( "$_/Verbs" ) * 2 } ) ; # - - - - - - - - - - - - - - - - \\#
        $WCP = @{ 0 = "$SiteName/$VHost" , "$SWS/$WSS/$( $TGT[0] )" ,                    "Enabled" ,    "False" #- - - - - - - - - - - - - - - - - -//#
                  1 = "$SiteName/$VHost" , "$SWS/$WSS/$( $TGT[1] )" ,                    "Enabled" ,     "True" # - - - - - - - - - - - - - - - - - \\#
                  2 = "$SiteName/"       , "$SWS/$(      $TGT[2] )" ,            "DefaultMimeType" , "Text/XML" #- - - - - - - - - - - - - - - - - -//#
                  3 = "$SiteName/$VHost" , "$SWS/$(      $TGT[3] )" , "AllowInfinitePropfindDepth" ,     "True" # - - - - - - - - - - - - - - - - - \\#
                  4 = "$SiteName"        , "$SWS/$(      $TGT[4] )" , "AllowInfinitePropfindDepth" ,     "True" #- - - - - - - - - - - - - - - - - -//#
                  5 = "$SiteName/$VHost" , "$SWS/$(      $TGT[5] )" ,              "ApplyToWebDAV" ,    "False" # - - - - - - - - - - - - - - - - - \\#
                  6 = "$SiteName/"       , "$SWS/$(      $TGT[6] )" ,              "ApplyToWebDAV" ,    "False" #- - - - - - - - - - - - - - - - - -//#
                  7 = "$SiteName/$VHost" , "$SWS/$(      $TGT[7] )" ,              "ApplyToWebDAV" ,    "False" # - - - - - - - - - - - - - - - - - \\#
                  8 = "$SiteName/"       , "$SWS/$(      $TGT[8] )" ,              "ApplyToWebDAV" ,    "False" } #- - - - - - - - - - - - - - - - -//#
        0..8 | % { Set-WebConfigurationProperty -PSPath $MWA -Location $WCP[$_][0] -Filter $WCP[$_][1] -Name $WCP[$_][2] -Value $WCP[$_][3] } # - - \\#
        $Filtering = Get-IISConfigSection | ? { $_.SectionPath -like "*$SWS/$SRF*" } | Get-IISConfigElement -ChildElementName 'HiddenSegments' # - -//#
        Set-IISConfigAttributeValue -ConfigElement $Filtering -AttributeName "$ATWD" -AttributeValue $False # - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// -[ Set-ASPPermissions ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $AppData = "$SiteRoot" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        'IIS_IUSRS', 'IUSR', "IIS APPPOOL\$SitePool" | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            $Obj = New-AclObject -SamAccountName $_ -Permission 'ReadAndExecute' -Inheritance 'ContainerInherit' , 'ObjectInherit' ; #- - - - - - - \\#
            Add-Acl -Path $SiteRoot -AceObject $Obj } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        'IIS_IUSRS', "IIS APPPOOL\$SitePool"         | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $Obj = New-AclObject -SamAccountName $_ -Permission 'Modify' -Inheritance 'ContainerInherit' , 'ObjectInherit' ; # - - - - - - - - - - -//#
            Add-Acl -Path $AppData  -AceObject $Obj } } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Else { Wrap-Action -Type "Exception" -Info "[!] The dialog has failed you sir/ma'am" ; Read-Host "Press Enter to Exit" ; Exit } #- - - - - -//#
        } # - [ Will Include Further Hybrid Modification Installation Entries Later ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #//  -[ Mobilize-7zip ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $7Zip    = 'C:\Program Files\7-Zip\7z.exe' ; $Base = "$URI\$Pname" ; $Install = "C:\Hybrid-Installation\Hybrid" #- - - - - - - - - - - - - -//#
        $URLBase = "https://drive.google.com/drive/folders/1tmS-BelyD9Pd7IeCUaZTnrigQSt9ozwQ?usp=sharing" # - - - - - - - - - - - - - - - - - - - - \\#
        $DISMGUI = "http://cdn.chuyu.me/Dism++10.1.1000.100_2d2bf466baca088c4b35248f5a7316f4e00cac0b.zip" #- - - - - - - - - - - - - - - - - - - - -//#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #//  -[ Generate-DSCRoot ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $DSCR = @{ Tree = @( "Resources" , "Tools" , "Images" , "Profiles" , "Certificates" , "Applications" ) # - - - - - - - - - - - - - - - - - -//#
                   Path = @{ 0 = @() ; 1 = @( "Drivers" , "DISM++" , "VM" ) ; 2 = @( "DC2016" ; @( "E" , "H" , "P" | % { "$_`64" ; "$_`86" } | % {# \\#
                   "10$_" } ) ) ; 3 = @() ; 4 = @( "Root" | % { "$_" , "CA" , "Auth$_" } )  ; 5 = @( "chrome" ; "silverlight" ; "jre" ; #- - - - - -//#
                   "libre" ; "mwb" ; "flash" ; "air" ; "reader" ; "ccleaner" ; "klite" ;  "tv"  ) } # - - - - - - - - - - - - - - - - - - - - - - - \\#
                   File = @{ 0 = @(   "Server" , "Client" | % { "Initialize-Hybrid$_.ps1" } ; "logo.bmp" , "bg.jpg" | % { "OEM$_" } ; #- - - - - - -//#
                   "StartLayout.xml" ; "UEV-Profile.ps1" ) ; 1 = @() ; 2 = @() ; 3 = @() ; 4 = @() ; 5 = @() } } #- - - - - - - - - - - - - - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #// - [ Scaffold-DSCRoot ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $DSCR | % { $H = $_.Tree ; $C = 0..( $_.Tree.Count - 1 ) ; $P = $C | % { "$Base\($_)$( $H[$_] )" } #- - - - - - - - - - - - - - - - - - - - \\#
            $C  | ? { ( Test-Path "$( $P[$_] )" ) -ne $True } | % { NI -Path "$( $P[$_] )" -ItemType Directory  } } #- - - - - - - - - - - - - - - -//#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #//- -[ Scaffold-DSCFolders ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $T = @( gci $Base ).FullName ; ForEach ( $i in 0..( $T.Count - 1 ) ) { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            $DSCR.Path[$i].Count | ? { $_ -gt 0 } | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $H = $DSCR.Path[$i] ; $C = 0..( $H.Count - 1 ) ; $P  = @( $C | % { "$( $T[$i] )\($_)$( $H[$_] )"  } ) ; #- - - - - - - - - - - - - - - -//#
            $C | ? { ( Test-Path "$( $P[$_] )" ) -ne $True } | % { NI -Path "$( $P[$_] )" -ItemType Directory } } # - - - - - - - - - - - - - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #// - [ Scaffold-DSCFiles ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
            $DSCR.File[$i].Count | ? { $_ -gt 0 } | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
            $H = $DSCR.File[$i] ; $C = 0..( $H.Count - 1 ) ; $P  = @( $C | % { "$( $T[$i] )\$( $H[$_] )" } ) ; # - - - - - - - - - - - - - - - - - -//#
            $C | ? { ( Test-Path "$( $P[$_] )" ) -ne $True } | % { CP -Path "$( $Inst[$i] )\$( $H[$_] )" -Destination "$( $P[$_] )" } } } # - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    #// - [ Source-Applications ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $URL = #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        # It's like shiny rims for your 'wheels' , except...? Like not that, at all... really. # - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        @( "" ,   "64" | % { "https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise$_.msi" } ) + # - - - - - - - - - - - - \\#
        # It's not 'Gold Heavy', but it's about as good as a VCR - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        @( "" , "_x64" | % { "https://download.microsoft.com/download/F/D/0/FD0B0093-DE8A-4C4E-BDC4-F0C56D72018C/50907.00/Silverlight$_.exe" } ) + #\\#
        # Because everyone needs some coffee in their life. Who needs Dunkin when you've got Oracle... - - - - - - - - - - - - - - - - - - - - - - -//#
        @( 7 , 9 | % { "https://javadl.oracle.com/webapps/download/AutoDL?BundleId=23872$_`_478a62b7d4e34b78b671c754eaaf38ab" } ) + # - - - - - - - \\#
        # When you want a free version of Office that doesn't spy on you, and does a lot more out of the box - - - - - - - - - - - - - - - - - - - -//#
        @( ( "" , 86 ) , ( "_64" , 64 ) | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        "https://download.documentfoundation.org/libreoffice/stable/6.2.5/win/x86$( $_[0] )/LibreOffice_6.2.5_Win_x$( $_[1] ).msi" } ) + # - - - - -//#
        # Because Malware 'bytes', and...? Microsoft's idea of free protection is similar to "raw doggin' it". #- - - - - - - - - - - - - - - - - - \\#
        "https://downloads.malwarebytes.com/file/mb3/" , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        # Not the type of 'flash' you probably wanna see? But you live and learn. # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        "https://download.macromedia.com/get/flashplayer/pdc/32.0.0.223/install_flash_player_32_plugin.msi" , #- - - - - - - - - - - - - - - - - - -//#
        # When it's hard for you to breathe, or, you feel like getting the jump on something... then catch some 'Air'. #- - - - - - - - - - - - - - \\#
        "http://airdownload.adobe.com/air/win/download/32.0/AdobeAIRInstaller.exe" , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        # If you know how to 'read' then Adobe's got you covered. If you don't? Well... you might have other issues. #- - - - - - - - - - - - - - - \\#
        "http://ardownload.adobe.com/pub/adobe/reader/win/AcrobatDC/1901020064/AcroRdrDC1901020064_MUI.exe" , #- - - - - - - - - - - - - - - - - - -//#
        # ...and, it comes with 'multiple languages' in case you're a real boss. Like me. # - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        "http://ftp.adobe.com/pub/adobe/reader/win/AcrobatDC/1901220035/AcroRdrDCUpd1901220035_MUI.msp" , #- - - - - - - - - - - - - - - - - - - - -//#
        # For operating system maintenance that Microsoft sucks at doing by default. #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        "https://download.ccleaner.com/ccsetup560.exe" , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        # Codec's for your brodecks. I know that word doesn't exist... just roll with it. # - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        "https://files3.codecguide.com/K-Lite_Codec_Pack_1504_Full.exe" , #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        # Cause we're all on the same team, except the hackers that created Azure. #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        "https://download.teamviewer.com/download/version_14x/TeamViewer_Setup.exe" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Designate-AppList ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $DisplayName = @( @( "Google Chrome" , "Microsoft Silverlight" , "Java Runtime Environment" , "Libre Office Fresh" | % { ` # - - - - - - - -//#
        "$_ (x86)" , "$_ (x64)" } ) ; @( "Malwarebytes" ; @( "Flash" , "Air" + @( "Reader DC" | % { "$_" ; "$_ MUI" } ) | % { ` # - - - - - - - - - \\#
        "Adobe $_" } ) + "CCleaner" , "K-Lite Codec Pack Full" , "Teamviewer 14" ) | % { "$_ (x22)" } ) #- - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- -[ Designate-AppVersions ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Version = @( 0..1 | % { "75.0.3770.142" } ; 0..1 | % { "5.1.50907.0" } ; 0..1 | % { "8.0.211" } ; 0..1 | % { "6.2.5" } ; #- - - - - - - - -//#
        "3.8.3.296511612" ; "32.0.0.223" ; "32.0.0.125" ; "2019.012.20064" ; "2019.012.20035" ; "5.60.7307" ; "15.0.4" ; "14.4.2669" ) #- - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// - [ Define-Names ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $File = @( @( "chrome" , "silverlight" , "jre" , "libre" | % { "$_(x86)" , "$_(x64)" } ) ; #- - - - - - - - - - - - - - - - - - - - - - - - \\#
        @( "mwb" ; @( "flash" , "air" + @( "reader" | % { "$_" ; "$_`mui" } ) ) + "ccleaner" , "klite" , "tv" ) | % { "$_(x22)" } ) #- - - - - - - -//#
        $Exe = @( 0..1 | % { "msi" } ; 0..3 | % { "exe" } ; 0..1 | % { "msi" } ; 0..3 | % { "exe" } ; "msp" ; 0..2 | % { "exe" } ) #- - - - - - - - \\#
        $Folder = gci $Base -Filter "*Applications" -EA 0 ; $T = gci $Folder.FullName ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $P = @( 0..1 | % { $T[0] } ; 2..3 | % { $T[1] } ; 4..5 | % { $T[3] } ; 6..7 | % { $T[4] } ; 8 | % { $T[5] } ; 9 | % { $T[6] } ; # - - - - - \\#
        10 | % { $T[7] } ; 11..12 | % { $T[8] } ; 13 | % { $T[9] } ; 14 | % { $T[10] } ; 15 | % { $T[2] } ) #- - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #//- -[ Declare-FileHashes ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $Checksum = "f5ae4e45ec177ee53513426aabef2d0c0967584c30327678afb6f77535718357" , # Google Chrome x86 # - - - - - - - - - - - - - - - - - - -\\#
                    "a5941959bf0f5058702252d411cf39c2982c751f5b662c48b651d94ce4a7ee19" , # Google Chrome x64 #- - - - - - - - - - - - - - - - - - - //#
                    "88e1b76bdf799478a72fa27db0bfe7bc5d02cc7e53675967399300448f0e266f" , # Silverlight x86 # - - - - - - - - - - - - - - - - - - - -\\#
                    "8d263a6f42a378073b6f057f242a42076f9f4082340153c2e27ecc959c5036aa" , # Silverlight x64 #- - - - - - - - - - - - - - - - - - - - //#
                    "47DE97325B8EA90EA9F93E1595CC7F843DA0C9C6E4C9532ABEA3A194CFB621D9" , # Java x86 #- - - - - - - - - - - - - - - - - - - - - - - -\\#
                    "C18CF8F2776B69DC838440AADFAAE36F50717636F38EEC5F1E4A27A8CB4F20FB" , # Java x64 # - - - - - - - - - - - - - - - - - - - - - - - //#
                    "717fb9e17a3feb8af1662e668b919db86fab343303b78f88c7859003056ee010" , # Libre x86 # - - - - - - - - - - - - - - - - - - - - - - -\\#
                    "9b01f6f382dbb31367e12cfb0ad4c684546f00edb20054eeac121e7e036a5389" , # Libre x64 #- - - - - - - - - - - - - - - - - - - - - - - //#
                    "f8247c1c6d47165640e70ee9cfa9a7a7b4e0e96cb850852690742508f70e2f01" , # Malwarebytes #- - - - - - - - - - - - - - - - - - - - - -\\#
                    "ee34f7a2ecd40039738861fd331ff9d9c5320a33d61b62ae71e108b78f999892" , # Adobe Flash #- - - - - - - - - - - - - - - - - - - - - - //#
                    "6718308E10A45176155D0ECC8458BD3606308925B91F26A7D08C148CF52C9DB3" , # Adobe Air # - - - - - - - - - - - - - - - - - - - - - - -\\#
                    "81953f3cf426cbe9e6702d1af7f727c59514c012d8d90bacfb012079c7da6d23" , # Adobe Reader DC #- - - - - - - - - - - - - - - - - - - - //#
                    "67AAB19943FA63393F15E1354FACCE65BED476D1C2BB5D311DB8450614A33200" , # Adobe Reader DC MUI/Update #- - - - - - - - - - - - - - -\\#
                    "00be05f95e08eb4f181ccde15403e782150a616cb93fd74525c99920f53a2cea" , # CCleaner # - - - - - - - - - - - - - - - - - - - - - - - //#
                    "1F6BDE89E752811FDC04492D0F73216720B625E54966B3E350659BABD9AD7A83" , # K-Lite Codec Pack # - - - - - - - - - - - - - - - - - - -\\#
                    "df26627cc29716b65a3ed72f78d59808244f9bc4ad2624657ddbee79d2baa422"   # Teamviewer 14 #- - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// -[ Download-Applications ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Foreach ( $i in 0..15 ) { $Outfile = "$( $P.FullName[$i] )\$( $File[$i] ).$( $Exe[$i] )" ; #- - - - - - - - - - - - - - - - - - - - - - - - //#
        $Info  = "$( $Name[$i] ) v$( $Ver[$i] )" ; $Check = "$( $Checksum[$i] )" ; # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        If ( ( Test-Path $Outfile ) -ne $True ) { Wrap-Action -Type "Downloading" -Info $Info ; IWR -URI $URL[$i] -OutFile $Outfile } # - - - - - - //#
        Else                                    { Wrap-Action -Type    "Detected" -Info $Info } #- - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #//- [ Get-FileHash ] - - - - -- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $Hash = ( Get-FileHash -Path $Outfile -Algorithm SHA256 ).Hash # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        If ( $Hash -eq $Check ) { Wrap-Action -Type "Validated" -Info "[+] $Check" } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                           Else { Wrap-Action -Type "Exception" -Info "[!] $Check" ; # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                  Wrap-Action -Type "Removing"  -Info "[!] $Info"  ; RI $OutFile -Force } } # - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// -[ Get-Tools ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#



        "$Base\(1)Tools\(1)DISM++" | % { IWR -Uri $DISMGUI -OutFile "$_.zip" ; Set-Alias SZ $7zip ; SZ x "$_.zip" -o"$_" ; RI "$_.zip" -Force } # - //#



        $URL      = @( ( "x86" , "i386" ) , ( "x64" , "x86_64" ) | % { ` # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                    "https://packages.vmware.com/tools/releases/10.3.10/windows/$( $_[0] )/VMware-tools-10.3.10-12406962-$( $_[1] ).exe" } ) + #- - //#
                    "https://download.virtualbox.org/virtualbox/6.0.10/VBoxGuestAdditions_6.0.10.iso" #- - - - - - - - - - - - - - - - - - - - - - -\\#
        $checksum = "59A498CC1641A04C10D08709AC6DC6AA95CAFC7B56E6D613D3630E89083F0F4C" # VMWare Tools x86 # - - - - - - - - - - - - - - - - - - - - //#
                    "65D5CC22D2FAE73F104E985BAA7885A1544ADCEB0774CC302522C03541E5DD82" # VMWare Tools x64 #- - - - - - - - - - - - - - - - - - - - -\\#
                    "c8a686f8c7ad9ca8375961ab19815cec6b1f0d2496900a356a38ce86fe8a1325" # VirtualBox Guest Additions # - - - - - - - - - - - - - - - //#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ \\#
#\\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\  [ Provision-Imaging ] @: Initializes the Hybrid Imaging Process                                                                                //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ //#
#// \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
    Function Provision-Imaging #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
    {   Wrap-Function -ID "Provision-Imaging" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $LM = @( $Env:ComputerName ; $Env:Processor_Architecture ; "$Env:SystemDrive\" ; @( $Env:SystemRoot | % { "$_" ; "$_\System32" } ) + #- - - \\#
        $Env:ProgramData ; $Env:ProgramFiles ) ; $Tree = "Resources" , "Tools" , "Images" , "Profiles" , "Certificates" , "Applications" # - - - - -//#
        $HKL_ = "HKEY_LOCAL_MACHINE" ; $HKLM = "HKLM:" ; $SDP = "Secure Digits Plus LLC" ; $SC = "Server" , "Client" #- - - - - - - - - - - - - - - \\#
        $DSC = "SOFTWARE\Policies\$SDP\Hybrid\Desired State Controller" ; $Base = "$HKLM\$DSC" # - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        "C:\Program Files\Microsoft Deployment Toolkit\bin\MicrosoftDeploymentToolkit.psd1" | ? { ( Test-Path $_ ) -eq $True } | % { IPMO $_ } #- - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// -[ Filter-Company ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Provisionary    = @( $Base | ? { ( Test-Path $_ ) -ne $Null } | % { gci $Base -EA 0 } | ? { $_.Name -ne $Null } ) ; $Company = @( ) #- - - \\#
        $Provisionary    | ? { $_.Name.Count -gt 1 } | % {  $Company += $_.PSChildName # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                                                            Wrap-Action -Type "Selection" -Info "[~] Multiple Companies Found" #- - - - - - - - - - \\#
                                                            0..( $Company.Count - 1 ) | % { Echo "[$_] $( $Company[$_] )" } #- - - - - - - - - - - -//#
                                                            $SEL      = Read-Host "Select # of listed companies" #- - - - - - - - - - - - - - - - - \\#
                                                            $Company  = $( $Company[$SEL] ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Provisionary    | ? { $_.Name.Count -eq 1 } | % {  $Company  = $_.PSChildName } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Provisionary    | ? { $_.Name.Count -lt 1 } | % {  Wrap-Action -Type "Launching" -Info "Installer" #- - - - - - - - - - - - - - - - - - - -//#
                                                            Provision-Installation } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// -[ Filter-Share ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Drive           = @( gci "$Base\$Company" ) ; $Share = @( ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Drive           | ? { $_.Name.Count -gt 1 } | % {  Wrap-Action -Type "Selection" -Info "[~] Multiple Drives Found" #- - - - - - - - - - - -//#
                                                            0..( $Drive.Count - 1 ) | % { Echo "[$_] $( $Drive[$_] )" } # - - - - - - - - - - - - - \\#
                                                            $SEL      = Read-Host "Select # of listed drives" #- - - - - - - - - - - - - - - - - - -//#
                                                            $Share    = $( $Drive[$SEL] ) } # - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Drive           | ? { $_.Name.Count -eq 1 } | % {  $Share    = $_.PSChildName } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Drive           | ? { $_.Name.Count -lt 1 } | % {  Wrap-Action -Type "Launching" -Info "Installer" # - - - - - - - - - - - - - - - - - - - \\#
                                                            Provision-Installation } ; $Drive = "$Base\$Company\$Share" #- - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #//- [ Declare-Root ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $R               = gp $Drive | % {   $_.R00_Company ;    $_.R01_UNCRoot ; $_.R02_Hostname ;    $_.R03_DC_User ;    $_.R04_DC_Pass ; #- - - -//#
                                            $_.R05_WWW_Site ;      $_.R06_Phone ;    $_.R07_Hours ;       $_.R08_Logo ; $_.R09_Background ; # - - - \\#
                                              $_.R10_Branch ;     $_.R11_Domain ;  $_.R12_LM_User ;    $_.R13_LM_Pass ;      $_.R14_Proxy ; #- - - -//#
                                             $_.R15_NetBIOS ; $_.R16_DSC_Folder ;  $_.R17_PSDrive ; $_.R18_PSDrive_ID } # - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// -[ Declare-IIS ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $IIS             = gp $Drive | % { $_.R19_BITS_Name ; $_.R20_BITS_Pool ; $_.R21_BITS_Host ; $_.R22_BITS_Root } #- - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// -[ Target-Drive ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Drive           = ( $R[17] ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// -[ Target-Server ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        If ( $LM[0] -eq $R[2] ) { ( $DR , $SRV ) = ( $R[16] , "[ Yes ]" ) } Else { ( $DR , $SRV ) = ( $R[1] , "[ No ]" ) } $DS = "$DR\$( $R[0] )" # \\#
        $D = @( 0..5 | % { "$DS\($_)$( $Tree[$_] )" } ) ; $L = @( 0..5 | % { "$( $LM[2] + $R[0] )\($_)$( $Tree[$_] )" } ) # - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// -[ Declare-MDT ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $MDT = @( "MDTProvider" ; $Drive ; "Administrators" ; @( "Server" , "Client" | % { "$( $Drive ):\Operating Systems\$_" } ) + #- - - - - - - //#
               @( "Server" , "Client" | % { "$( $Drive ):\Task Sequences\$_" } ) + "$( $R[16] )" ; "$( $R[1].Split('\')[-1] )" ; "$( $R[1] )" ; #- -\\#
               @( "Boot" ; ( "Server" , "Client" | % { "Operating Systems\$_" } ) + "Scripts" ; "Control" ) | % { "$DR\$_" } ; "$( $R[18] )" )# - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// -[ Display-Root ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Title -Title "Provisional-Root" ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Section -Section "( Domain State Controller @ Source )" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $Type = @( "Provisionary" ; "( DSC ) Share" ; "( DSC ) Controller" ; @( $Tree[0..5] ) ) # - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $Info = @( $R[0..2] ; $D[0..5] ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type $Type[0] -Info $Info[0] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type $Type[1] -Info $Info[1] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type $Type[2] -Info $Info[2] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type $Type[3] -Info $Info[3] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type $Type[4] -Info $Info[4] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type $Type[5] -Info $Info[5] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type $Type[6] -Info $Info[6] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type $Type[7] -Info $Info[7] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type $Type[8] -Info $Info[8] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Section -Section "( Current Machine @ Variables )" ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $Type = @( "Server" ; "Hostname" ; "Architecture" ; "System Drive" ; "Windows Root" ; "System32" ; "Program Data" ) # - - - - - - - - - - - //#
        $Info = @( $SRV ; $R[2] ; $LM[1..5] ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type $Type[0] -Info $Info[0] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Wrap-ItemIn  -Type $Type[1] -Info $Info[1] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-ItemOut -Type $Type[2] -Info $Info[2] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Wrap-ItemIn  -Type $Type[3] -Info $Info[3] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-ItemOut -Type $Type[4] -Info $Info[4] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Wrap-ItemIn  -Type $Type[5] -Info $Info[5] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-ItemOut -Type $Type[6] -Info $Info[6] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-Section -Section "( Provision Index @ Bridge Control )" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Type = @( "( DSC ) Target" ; @( $Tree[0..5] ) + "Logo" ; "Background" ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $Info = @( $LM[0] ; $L[0..5] ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-ItemOut -Type $Type[0] -Info $Info[0] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Wrap-ItemIn  -Type $Type[1] -Info $Info[1] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-ItemOut -Type $Type[2] -Info $Info[2] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Wrap-ItemIn  -Type $Type[3] -Info $Info[3] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-ItemOut -Type $Type[4] -Info $Info[4] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        Wrap-ItemIn  -Type $Type[5] -Info $Info[5] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-ItemOut -Type $Type[6] -Info $Info[6] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-In ; Wrap-Out ; Wrap-Bot ; Read-Host "Press Enter to Continue" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// - [ Provision-Images ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-Function -ID "Provision-Images" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $di   = $d[2] ; $dt = "Server" , "Client" | % { "$dr\Operating Systems\$_" } ; $Ed = "Education" , "Home" , "Professional" # - - - - - - - -//#
        $Date = "$( Get-Date -UFormat "%Y%m%d" )" , "( $( Get-Date -UFormat "%m-%d-%Y" ) MC-SDP )" ; $NA = "Not Detected" # - - - - - - - - - - - - \\#
        $Wim  = @{ Name = @( @( "Server 2016 Datacenter (x64)" ; @( $Ed | % { "$_ (x64)" ; "$_ (x86)" } | % { "10 $_" } ) ) | % { "Windows $_" } ) #//#
                    Tag = @( "DC2016" ; @( "E" , "H" , "P" | % { "$_`64" ; "$_`86" } | % { "10$_" } ) ) # - - - - - - - - - - - - - - - - - - - - - \\#
                   Sign = @( 0..6 | % {                "$( $Date[1] ) [ $( $Tag[$_] ) ]" } ) # - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                  Build = @(    0 | % { "10.0.14393.693" } ; 1..6 | % { "10.0.18362.207" } ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                  Major = @(    0 | % {           "1607" } ; 1..6 | % {           "1903" } ) # - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                  Minor = @(    0 | % {          "(693)" } ; 1..6 | % {          "(207)" } ) } #- - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $Stamp = @( 0..6 | % {    "$( $wim.Build[$_] ) [ $( $wim.Major[$_] ) ]" } ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $DISM = @( 0..6 ) ; ForEach ( $i in 0..6 ) { $DISM[$i] = $Wim | % { $_.Tag[$i] , $_.Name[$i] , $_.Sign[$i] , $Stamp[$i] , $r[0] } } # - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// - [ Stored WIM Info ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        Wrap-Action -Type "DISM" -Info "[+] WIM Store" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $DI | ? { ( Test-Path $DI ) -ne $True } | % { NI -Path $_ -ItemType Directory } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $OnDeck = @( GCI $DI -EA 0 ) ; $OnDeckWIM = @( $OnDeck.FullName | % { GCI $_ -Filter "*.wim" -EA 0 } ) #- - - - - - - - - - - - - - - - - - \\#
        If ( $OnDeckWIM.Count -eq 0 ) { $Store = @{ Name = $NA ; File = $NA ; Tag = $NA ; Path = $NA ; Date = $NA ; Full = $NA ; Build = $NA } } # -//#
        Else {  $Store   = @( $OnDeckWim | Select       @{ Name =  "Name" ; Expression = {   Get-WIMName  -IP $_.FullName                    } } , #\\#
                                                        @{ Name =  "File" ; Expression = {                    $_.Name                        } } , #//#
                                                        @{ Name =   "Tag" ; Expression = {                    $_.BaseName                    } } , #\\#
                                                        @{ Name =  "Path" ; Expression = {               $_.DirectoryName                    } } , #//#
                                                        @{ Name =  "Date" ; Expression = {               $_.LastWriteTime                    } } , #\\#
                                                        @{ Name =  "Full" ; Expression = {                    $_.FullName                    } } , #//#
                                                        @{ Name = "Build" ; Expression = {   Get-WIMBuild -IP $_.FullName -ID 1            } } ) } #\\#
        Wrap-Title -Title "Stored-WIM(S)" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        0..( $Store.Count - 1 ) | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Section -Section                    $Store.Name[$_] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type    "[+] Path " -Info  $Store.Path[$_] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type    "[+] File " -Info  $Store.File[$_] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type    "[+] Date " -Info  $Store.Date[$_] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type    "[+] Build" -Info  $Store.Build[$_] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Out } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Bot ; Read-Host "Verify list. Press Enter to Continue" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// - [ Current-WIM Info ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Action -Type "MDT" -Info "[+] Server WIM" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $DT[0] | ? { ( Test-Path $_ ) -ne $True } | % { NI -Path $_ -ItemType Directory } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $OnBaseServer    = @( GCI $DT[0] -EA 0 ) ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $OnBaseServerWIM = @( $OnBaseServer.FullName | % { GCI $_ -Filter "*.wim" -EA 0 } ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        If ( $OnBaseServerWIM.Count -eq 0 ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        {       $CServer = [ Ordered ]@{  Name = $NA ; File = $NA ; Tag = $NA ; Path = $NA ; Date = $NA ; Full = $NA ; Build = $NA             } } #\\#
        Else {  $CServer = @( $OnBaseServerWim | Select @{ Name =  "Name" ; Expression = {   "Windows Server 2016 Datacenter (x64)"          } } , #//#
                                                        @{ Name =  "File" ; Expression = {                    $_.Name                        } } , #\\#
                                                        @{ Name =   "Tag" ; Expression = {                    $_.BaseName                    } } , #//#
                                                        @{ Name =  "Path" ; Expression = {               $_.DirectoryName                    } } , #\\#
                                                        @{ Name =  "Date" ; Expression = {               $_.LastWriteTime                    } } , #//#
                                                        @{ Name =  "Full" ; Expression = {                    $_.FullName                    } } , #\\#
                                                        @{ Name = "Build" ; Expression = {   Get-WIMBuild -IP $_.FullName -ID 1            } } ) } #//#
        Wrap-Action -Type "MDT" -Info "[+] Client WIM" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        $OnBaseClient  = @( GCI $DT[1] -EA 0 ) ; $OnBaseClientWIM = @( $OnBaseClient.FullName | % { GCI $_ -Filter "*.wim" -EA 0 } ) # - - - - - - -//#
        If ( $OnBaseClientWIM.Count -eq 0 ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        {       $CClient = [ Ordered ]@{  Name = $NA ; File = $NA ; Tag = $NA ; Path = $NA ; Date = $NA ; Full = $NA ; Build = $NA             } } #//#
        Else {  $CClient = @( $OnBaseClientWim | Select @{ Name =  "Name" ; Expression = { "Windows 10 Home/Education/Pro (x86/64)"          } } , #\\#
                                                        @{ Name =  "File" ; Expression = {                    $_.Name                        } } , #//#
                                                        @{ Name =   "Tag" ; Expression = {                    $_.BaseName                    } } , #\\#
                                                        @{ Name =  "Path" ; Expression = {               $_.DirectoryName                    } } , #//#
                                                        @{ Name =  "Date" ; Expression = {               $_.LastWriteTime                    } } , #\\#
                                                        @{ Name =  "Full" ; Expression = {                    $_.FullName                    } } , #//#
                                                        @{ Name = "Build" ; Expression = {   Get-WIMBuild -IP $_.FullName -ID 1            } } ) } #\\#
        Wrap-Title  -Title   "Current-WIM(S)" ; $Current = $CServer , $CClient #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $Current | % { # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Section -Section                    $_.Name #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type     "[+] Path " -Info $_.Path # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type     "[+] File " -Info $_.File #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type     "[+] Date " -Info $_.Date # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type     "[+] Build" -Info $_.Build # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Out } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Bot ; Read-Host "Press Enter to Continue" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// - [ Update-WIM Info ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Action -Type "Transfer / Update" -Info "[+] DISM -> MDT WIM Information" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                $Update   = [ Ordered ]@{ Name  = ( "Server 2016 Datacenter (x64)" , "10 Home/Education/Pro (x86/64)" | % { "Windows $_" } ) # - - -\\#
                                          File  = ( 0..1 | % {               "$( $Date[0] )_$( $WIM.Major[$_] )_$( $WIM.Minor[$_] ).wim" } ) #- - - //#
                                          Tag   = ( 0..6 | % {                                                           "$( $Tag[$_] )" } ) # - - -\\#
                                          Path  =                                                                                  "$di" #- - - - - //#
                                          Date  =                                                                        "$( $Date[0] )" # - - - - -\\#
                                          Full  = ( 0..1 | % {           "$di\$( $Date[0] )_$( $WIM.Major[$_] )_$( $WIM.Minor[$_] ).wim" } ) #- - - //#
                                          Build = ( 0..1 | % {                                                     "$( $WIM.Build[$_] )" } ) } # - -\\#
        Wrap-Title -Title "Update-WIM(S)" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        0..( $Update.File.Count - 1 ) | % { #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Section -Section                        $Update.Name[$_] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Itemout -Type     "[+] Path " -Info     $Update.Path #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type     "[+] File " -Info     $Update.File[$_] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-ItemOut -Type     "[+] Date " -Info     $Update.Date #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-ItemIn  -Type     "[+] Build" -Info     $Update.Build[$_] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Out } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Wrap-Bot ; Read-Host "Press Enter to Continue" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// -[ Update-ServerWIM ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $Update.Full[0] | ? { ( Test-Path $_ ) -eq $True } | % { RI $_ } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        0..( $Store.Count - 1 ) | ? { $Store[$_].Name -like "*Serv*" } | % { Wrap-Action -Type "Process" -Info $Store[$_].Name ; # - - - - - - - - -\\#
        Echo "[ Current Image Info ]" , $DISM[$_] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Robocopy $Store.Path[0] $di $Store.File[0] ; RI "$di\$( $Store.File[0] )" -NewName $Update.Full[0] ; # - - - - - - - - - - - - - - - - - - -\\#
        If ( $? -eq $True ) { Wrap-Action -Type "Successful" -Info "[+] Server Image Updated"     } # - - - - - - - - - - - - - - - - - - - - - - - //#
        Else                { Wrap-Action -Type     "Failed" -Info "[!] Server Image not updated" } #- - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #//- -[ Update-ClientWIM ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $Update.Full[1] | ? { ( Test-Path $_ ) -eq $True } | % { RI $_ } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        0..( $Store.Count - 1 ) | ? { $Store[$_].Name -like "*10*" } | % { Wrap-Action -Type "Process" -Info $Store[$_].Name ; #- - - - - - - - - - //#
        Wrap-Action -Type "DISM" -Info ( $Store.Name[$_] ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Echo "[ Current Image Info ]" , $DISM[$_] # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Export-WindowsImage -SIP ( $Store.Full[$_] ) -SN ( $Store.Name[$_] ) -DIP ( $Update.Full[1] ) -DN ( $Store.Name[$_]  ) -VB # - - - - - - - -\\#
        If ( $? -eq $True ) { Wrap-Action -Type   "Success" -Info "[+] Image $( $Store.Name[$_] ) Updated"     } #- - - - - - - - - - - - - - - - - //#
        Else                { Wrap-Action -Type "Exception" -Info "[!] Image $( $Store.Name[$_] ) Not Updated" } } # - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #//- -[ Recycle-MDT ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Function -ID "Recycle-MDT" ; $PSD  = @( $MDT[3..6] ) + @( $MDT[11..12] ) ; $Name = @( ( "Server" , "Client" | % { $_ } ) * 3 ) #- - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #//- -[ Generate-PSPaths ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        0..3 | ? { If ( ( Test-Path $PSD[$_] ) -eq $True ) { Wrap-Action -Type "Path Found" -Info "[+] $( $PSD[$_] )" } #- - - - - - - - - - - - - -\\#
                   Else   { NI -Path $Path[$_] -Enable "True" -Name $Name[$_] -Comments "$( $Date[1] )" -ItemType "Folder" -VB #- - - - - - - - - - //#
                            If ( $? -eq $True )     { Wrap-Action -Type "Path Created" -Info "[+] $( $PSD[$_] )" } # - - - - - - - - - - - - - - - -\\#
                            Else                    { Wrap-Action -Type "Path Failure" -Info "[-] $( $PSD[$_] )" } } } #- - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// -[ Generate-WIMPaths ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        4..5 | % { If ( ( Test-Path $PSD[$_] ) -eq $True ) { Wrap-Action -Type "Path Found" -Info "[+] $( $PSD[$_] )" } # - - - - - - - - - - - - - //#
                   Else   { NI -Path $PSD[$_] -ItemType Directory -Value $PSD[$_] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                            If ( $? -eq $True ) { Wrap-Action -Type "Directory Created" -Info "[+] $( $PSD[$_] )" } # - - - - - - - - - - - - - - - //#
                            Else                { Wrap-Action -Type "Directory Failure" -Info "[!] $( $PSD[$_] )" } } } #- - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #// -[ Remove-MDTOSTS ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        0..5 | % { $Name = @( GCI ( $PSD[$_] ) -EA 0 ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        If ( $Name.Count -eq 1 )            { If ( $Name  -ne $null ) { RI "$( $PSD[$_] )\$( $Name.Name )"  -Recurse -VB -EA 0 } } #- - - - - - - - //#
        Else {  ForEach ( $Names in $Name ) { If ( $Names -ne $Null ) { RI "$( $PSD[$_] )\$( $Names.Name )" -Recurse -VB -EA 0 } } } # - - - - - - -\\#
                If ( $? -eq $True ) { Wrap-Action -Type   "Removed" -Info "[+] $( $PSD[$_] ) Child Items"  } #- - - - - - - - - - - - - - - - - - - //#
                Else                { Wrap-Action -Type "Exception" -Info "[-] $( $PSD[$_] ) Child Items"  } } # - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #// -[ Import-MDTOS ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        0..1 | % {  If ( ( Test-Path $Update.Full[$_] ) -ne $True ) { Wrap-Action -Type "Image Missing" -Info "[!] $( $Update.Full[$_] )" } #- - - -\\#
                    Else                                            { Wrap-Action -Type   "Image Found" -Info "[+] $( $Update.Full[$_] )" # - - - - //#
                    If ( $_ -eq 0 ) { $Folder = "Server" } Else { $Folder = "Client" } } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                    Import-NewOSImage -IP $PSD[$_] -SF $Update.Full[$_] -DF "$Folder\$( $WIM.Build[$_])" #- - - - - - - - - - - - - - - - - - - - - //#
                    If ( $? -eq $True ) { Wrap-Action -Type "Import Successful" -Info "[+] $( $Update.Full[$_] )" } #- - - - - - - - - - - - - - - -\\#
                    Else                { Wrap-Action -Type         "Exception" -Info "[!] Import Failed"       } } # - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// - [ Import-MDTTS ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                    $TemplateXML = @( $SC | % { "MDT$_`Mod.xml" } ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                    $PSDCheck = @( gci "$dr\Tools\Modules" -Filter "*PSD*" -EA 0 ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                    $PSDCheck | ? { $_.Count -gt 0 } | % { $TemplateXML = @( $SC | % { "PSD$_`Mod.xml" } ) } #- - - - - - - - - - - - - - - - - - - //#
                    $ServerXML = $TemplateXML[0] ; $ClientXML = $TemplateXML[1] } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                    $Server = @{ List = @( GCI $PSD[0] -EA 0 ) ; Temp = @( "$di\Control\$ServerXML" ) } # - - - - - - - - - - - - - - - - - - - - - //#
                    $Client = @{ List = @( GCI $PSD[1] -EA 0 ) ; Temp = @( "$di\Control\$ClientXML" ) } #- - - - - - - - - - - - - - - - - - - - - -\\#
                    0..6 | % { If ( $_ -eq 0 ) { $XML = @( GC $Server.Temp ) ; $PSP = $MDT[5] ; # - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                                 $SIP = "$( $MDT[3] )\$( $Server.List.Name )" ; #- - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                                 $GUID = $Server.List.GUID }  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                    Else                       { $XML = @( GC $Client.Temp ) ; $PSP = $MDT[6] ; #- - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                                 $SIP = "$( $MDT[4] )\$( $Client.List.Name[ ( $_ - 1 ) ] )" # - - - - - - - - - - - - - - - - - - - //#
                                                 $GUID = $Client.List.GUID[ ( $_ - 1 ) ] }  #- - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $XMLArray = @() ; 0..$XML.Count | % { If ( $XML[$_] -like "*OSGUID*" ) { $XMLArray += $_ } } #- - - - - - - - - - - - - - - - - - - - - - - //#
        ForEach ( $i in $XMLArray ) { $XML[$i] = $XML[$i].Split('{')[0] + $GUID + $XML[$i].Split('}')[1] } # - - - - - - - - - - - - - - - - - - - -\\#
        $XML_Path  = "$( $Store.Path[$_] )\$( $Tag[$_] ).xml" ; SC -Path $XML_Path -Value $XML -Force  #- - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Action -Type "Import-NewTask" -Info "[+] $( $DISM[$_][0] ) / $( $DISM[$_][1] )" # - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Import-NewTask -PSP $PSP -Formal $DISM[$_][1] -XML $XML_Path -Info $NT.Info $Date[1] -ID $DISM[$_][0] -Ver $Date[0] -SIP $SIP ` # - - - - - //#
            -TSName $DISM[$_][1] -Org $R[0] -WWW $R[5] -LMCred $lmcred.GetNetworkCredential().Password } # - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #// - [ Import-MDTTS ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Wrap-Action -Type "[ MDT ]" -Info "Updating PSDrive $( $MDT[1] ) Properties" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $Array  = @( ".GenerateLiteTouchISO" ; @( "WIMDescription" , "ISOName" | % { ".LiteTouch$_" } ) ; ".BackgroundFile" ) # - - - - - - - - - - //#
        $DSC    = @( "$( $MDT[1] ):" ; @( $Array | % { "Boot.x64$_" } ) + @( $Array | % { "Boot.x86$_" } ) ) # - - - - - - - - - - - - - - - - - - -\\#
        $Name   = @( "Comments" , "MonitorHost" + $DSC ) #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $Value  = @( $Date[1] ; $r[2] ; "True" ; @( ' (x64)' | % { "$_" , "$_.iso" } | % { "$( $r[0] )$($_)" } ) + "$( $d[0] )\$( $r[9] )" ; # - - -\\#
                                        "True" ; @( ' (x86)' | % { "$_" , "$_.iso" } | % { "$( $r[0] )$($_)" } ) + "$( $d[0] )\$( $r[9] )" ) #- - - //#
        0..$Name.Count | % {  SP          -Path $DSC[0]   -Name $Name[$_] -Value $Value[$_] ; #- - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                              Wrap-Action -Type "Drive Property" -Info "$( $Name[$_] ) set to . . ." ; Echo $Value[$_]     } #- - - - - - - - - - - //#
        If ( $? -eq $True ) { Wrap-Action -Type "[ MDT ]" -Info "PSDrive $( $MDT[1] ) Properties updated Successfully"     } # - - - - - - - - - - -\\#
        Else                { Wrap-Action -Type "[ MDT ]" -Info "PSDrive $( $MDT[1] ) Properties failed to update" ; Break } #- - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// -[ Recycle-BootStrap ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $BootStrap_HT      = @{ Settings = @{ Priority       = "Default" } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                Default  = @{ DeployRoot     = "http://$( $r[2] ),$( $r[1] )" #- - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                              UserID         = "$( $r[3] )" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                              UserPassword   = "$( $dccred.GetNetworkCredential().Password )" #- - - - - - - - - - - - - - - - - - -\\#
                                              UserDomain     = "$( $r[15] )" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                              SkipBDDWelcome = "YES" } } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $BootStrap_INI = "$( $MDT[14] )\Bootstrap.ini" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        If ( ! ( Test-Path $BootStrap_INI ) ) { RI $BootStrap_INI -EA 0 -Force } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Export-Ini -Filepath $BootStrap_INI -Encoding UTF8 -Force -InputObject $BootStrap_HT -Passthru #- - - - - - - - - - - - - - - - - - - - - - //#
        [ System.IO.File ]::WriteAllLines( ( $BootStrap_INI ), ( GC $BootStrap_INI ) , ( New-Object System.Text.UTF8Encoding $False ) ) #- - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #// -[ Recycle-CustomSettings ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $CustomSettings_HT = @{ Settings = @{ Priority           = "Default" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                              Properties         = "MyCustomProperty" } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                Default  = @{ _SMSTSOrgName      = "$( $r[0] )" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                              OSInstall          = "Y" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                              SkipCapture        = "NO" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                              SkipAdminPassword  = "YES" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                              SkipProductKey     = "YES" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                              SkipComputerBackup = "NO" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                              SkipBitLocker      = "YES" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                              KeyboardLocale     = "en-US" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                              TimeZoneName       = "$( ( Get-TimeZone ).ID )" #- - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
                                              EventService       = "http://$( $r[2] ):9800" } } # - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $CustomSettings_INI = "$( $MDT[14] )\CustomSettings.ini" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        If ( ( Test-Path $CustomSettings_INI ) -eq $True ) { RI $CustomSettings_INI -EA 0 -Force } #  - - - - - - - - - - - - - - - - - - - - - - - //#
        Export-Ini -Filepath $CustomSettings_INI -Encoding UTF8 -Force -InputObject $CustomSettings_HT -Passthru # - - - - - - - - - - - - - - - - -\\#
        [ System.IO.File ]::WriteAllLines( ( $CustomSettings_INI ) , ( GC $CustomSettings_INI ) , ( New-Object System.Text.UTF8Encoding $False ) ) #//#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// - [ Replace-Graphics ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $Graphics = "*computer.png" , "*header-image.png" | % { ( gci "$DI\Control" -Filter $_ -EA 0 ) } #- - - - - - - - - - - - - - - - - - - - - //#
        $Graphics | ? { $_.Exists } | % { CP $_.FullName "$( $MDT[13] )\$( $_.Name )" } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #//- -[ Inject-BridgeScript ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        $Script = @"
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ \\#
#\\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ //#
#// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\                                                                                                                                                 //#
#//    <@[ Initialize-Hybrid ]@>                                                                                           "Michael C. Cook Sr."    \\#
#\\                                                                                                                                                 //#
#//                                       [ Secure Digits Plus LLC | Hybrid ] [ Desired State Controller ]                                          \\#
#\\                                                                                                                                                 //#
#//                                [ https://www.securedigitsplus.com | Server/Client | Seedling/Spawning Script ]                                  \\#
#\\                                                                                                                                                 //#
#//                                                                                                                                                 \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ \\#
#\\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\  [ Initialize-Hybrid ] @: Initializes the Functions needed for all sub-script usage, AKA "what sissies refer to as a module"                    //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ //#
#// \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \\#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    using namespace System.Security.Principal ; `$OS = gcim Win32_OperatingSystem ; `$Hybrid = "Initialize-Hybrid" ;
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
#//- [ Elevate-Script ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    Function Elevate-Script #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    {   ( [ WindowsPrincipal ] [ WindowsIdentity ]::GetCurrent() ).IsInRole( "Administrators" ) | % { # - - - - - - - - - - - - - - - - - - - - - - //#
        If ( ( `$_ -eq `$False ) -and ( [ Int ] `$OS.BuildNumber -ge 6000 ) )
        {   Echo "Attempting [~] Script Elevation" ; #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
            SAPS -FilePath PowerShell.exe -Verb Runas -Args "-File `$PSCommandPath `$( `$MyInvocation.UnboundArguments )"
            If ( `$? -eq `$True ) { Echo "[+] Elevation Successful"   ; Echo      "[+] Access Granted" ; Bridge-Script }
            Else                { Echo "[!] Elevation Failed"       ; Read-Host "[!] Access Denied"  ;          Exit } }
        ElseIf ( `$_ -eq `$True ) {                                     Echo      "[+] Access Granted" ; Bridge-Script } } }
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#// -[ Bridge-Script ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    Function Bridge-Script #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    {   Set-ExecutionPolicy Bypass -Scope Process -Force # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        CMDKEY /add:$( $r[2] ) /user:$( $r[3] ) /pass:$( $dccred.GetNetworkCredential().Password )
        `$Type = "Client" ; `$OS.Caption | ? { `$_ -like "*Server*" } | % { `$Type = "Server" }
        CP -Path "$( $r[1] )\$( $r[0] )\(0)Resources\`$Hybrid`$Type.ps1" -Destination "`$home\Desktop" -Force
        SC -Path "`$home\Desktop\RootVar.ini" -Value ("$( $r[0] )" , "$(  $r[1] )" , "$( $r[2] )" , "$( $r[3] )" ,
        "$( $dccred.GetNetworkCredential().Password )" , "$( $r[5] )" , "$(  $r[6] )", "$( $r[7] )", "$( $r[8] )", "$( $r[9] )", "$( $r[10] )",
        "$( $r[11] )", "$( $r[12] )", "$( $lmcred.GetNetworkCredential().Password )", "$( $r[14] )", "$( $r[15] )", "$( $r[16] )" )
        "`$home\Desktop\`$Hybrid.ps1" | ? { ( Test-Path `$_ ) -eq `$True } | % { RI `$_ -Force  }
        SAPS -FilePath PowerShell.EXE -Verb RunAs `
            -Args "-File '`$Home\Desktop\`$Hybrid`$Type.ps1' Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -Force " `
            -WorkingDirectory "C:\Windows\System32\WindowsPowerShell\v1.0" }
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
#//- [ Test-Credential ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    Function Test-Credential # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    {   [ CmdLetBinding () ][ OutputType ( [ String ] ) ] Param ( # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
            [ Parameter ( ValueFromPipeLine = `$True , ValueFromPipelineByPropertyName = `$True ) ]
                [ Alias ( 'PSCredential' ) ] [ ValidateNotNull () ][ System.Management.Automation.PSCredential ] #- - - - - - - - - - - - - - - - - //#
                [ System.Management.Automation.Credential () ] `$Credentials )
        ( `$Domain , `$Root , `$Username , `$Password ) = @( 0..3 | % { `$Null } )
      #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        If ( `$Credentials -eq `$null ) {   Try   { `$Credentials = Get-Credential "domain\`$env:username" -EA 4 }
                                          Catch { `$ErrorMsg    = `$_.Exception.Message
                                                  Echo "Failure [!] Account Validation" # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                                                  Read-Host "Press Enter to Exit" ; Exit } } # - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Try       { `$Domain   = New-Object System.DirectoryServices.DirectoryEntry(
                                      "LDAP://`$( ( [ ADSI ]'').distinguishedName )" , 
                                                       "`$( `$Credentials.Username )" , 
                                "`$( `$Credentials.GetNetworkCredential().Password )" ) }
        Catch     { `$_.Exception.Message ; Continue } 
        If ( ! `$Domain ) {   Echo "Exception [!] Domain does not exist"
                             Echo "Install [!] Active Directory Domain Services" #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
                             Read-Host "Press Enter to Exit" ; Exit } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        Else {   If ( `$Domain.Name -ne `$Null ) { Return "Authenticated" ; Elevate-Script }
                 Else { Echo "Authentication [!] Failure" ; Sleep -Seconds 2 ; Exit  } } }
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
#//- [ Enter-Account ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    [ System.Windows.MessageBox ]::Show( "Enter Service Account Credentials to Continue" )
    `$DCCRED = Get-Credential ; If ( ( `$DCCRED | Test-Credential ) -ne "Authenticated" ) { Exit } Else { Elevate-Script }
"@      #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// -[ Set-ScriptContent ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        SC -Path "$( $MDT[13] )\Initialize-Hybrid.ps1" -Value $Script -Force #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        #// - [ Update-Hybrid ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        $Drive = $DSC[0] #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
        Switch( $host.UI.PromptForChoice( 'Recycle-MDT' , 'Select MDT Update Method' , # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
        [ System.Management.Automation.Host.ChoiceDescription[] ]@( '&Full' , '&Fast' , '&Compress' ) , # - - - - - - - - - - - - - - - - - - - - - //#
        [ Int ] 0 )  ) {    0 { Update-MDTDeploymentShare -Path $Drive    -Force -VB } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
                            1 { Update-MDTDeploymentShare -Path $Drive           -VB } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
                            2 { Update-MDTDeploymentShare -Path $Drive -Compress -VB } } #- - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        #// - [ Rename-BootImages ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        #\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        $OEM       = "$( $R[0].Replace( ' ' , '_' ) )" ; $Types = "x64" , "x86" ; # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        GCI $MDT[10] -Filter "*$( $OEM )*" -EA 0 | RI -Force # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
        "x64" , "x86" | % { Remove-WDSBootImage -Architecture $_ -ImageName "$( $R[0] ) ($_)" -EA 0 -VB } # - - - - - - - - - - - - - - - - - - - - \\#
        GCI $MDT[10] -Filter "*LiteTouch*" -EA 0 | RNI -NewName { $_.Name -Replace 'LiteTouchPE' , $OEM } #- - - - - - - - - - - - - - - - - - - - -//#
        $Boot  = $Types | % { GCI $MDT[10] -Filter "*_$_.wim" -EA 0 } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        0..1 | % { Import-WDSBootImage -Path $Boot[$_].FullName -NewDescription "$( $R[0] +' ('+ $Types[0] +')')" -SkipVerify -VB } #- - - - - - - -//#
        Wrap-Function -ID "Restart-WDS" ; Restart-Service -Name WDSServer ; # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
        If ( $? -eq $true ) { Wrap-Action -Type "WDS Image" -Info "[+] Successfully updated!" ; Display-Foot ; Exit } #- - - - - - - - - - - - - - -//#
        Else                { Wrap-Action -Type "WDS Image" -Info "[-] Update failed"         ; Display-Foot ; Exit } } # - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ / Declare-Functions ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ \\#
#\\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ //#
#// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\                                                                                                                                                 //#
#//    <@[ Execute-Script ]@>                                                                                                                       \\#
#\\                                                                                                                                                 //#
#//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ //#
#// \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \/ /\ \\#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
#// [ Initialize Service Account Credential ]- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //#
    [ System.Windows.MessageBox ]::Show( "Enter Service Account Credentials to Continue" ) # - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
    $DCCred = Get-Credential ; If ( ( $DCCred | Test-Credential ) -ne "Authenticated" ) { Exit } Else { Elevate-Script } #- - - - - - - - - - - - - //#
    Switch( $host.UI.PromptForChoice( "[ Install / Generate ] Deployment Share, or Update Boot Images?" , 'Select [ Installation / Imaging ]' , #- -\\#
    [ System.Management.Automation.Host.ChoiceDescription[] ]@( '&Installation' , '&Imaging' ) , #- - - - - - - - - - - - - - - - - - - - - - - - - //#
    [ Int] 1 )  ) { 0 { Provision-Installation } 1 { Provision-Imaging } } # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
#// -[ / Script-Initialized ] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \\#
#\\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//#
