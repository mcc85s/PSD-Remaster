#_____________________________________________________________________________________________________________________________________________________
#//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯     __________________________________________________________     ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯ -=-=-=-=-=-=-=[ Dynamically Engineered Digital Security ]-=-=-=-=-=-=--=-= ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                           ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   Application Development | Virtualization | Network and Hardware Magistration   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\
#\\  [ Install-HybridClient ] @: Accesses the Deployment Share to configure a Windows 10 Client image, after it has been deployed.           //  \\__//
#//__________________________________________________________________________________________________________________________________________\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
                                                                                                                                     #\__//¯¯\\__//¯¯\\
    Using Namespace System.Security.Principal
    Using Namespace System.Security.AccessControl
    Using Namespace System.Management.Automation
    Using NameSpace System.DirectoryServices

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Action # Ties this commandlet into Write-Output for styling strings                                    #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdletBinding () ] Param (
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ][ String ] $Type ,
            [ Parameter ( Position = 1 , Mandatory , ValueFromPipeline = $True ) ][ String ] $Info )

            $fs = " // " ; $bs = " \\ " ; $x = " " * ( 25 - $Type.Length ) ; $y = " " * ( 80 - $Info.Length )

            Echo @( "" ; ( $fs + ( "¯-" * 54 ) + $bs ) ;
            "$( $bs + $x + $Type ) : $( $Info + $y + $fs )" ;
            ( $fs + ( "-_" * 54 ) + $bs ) ; "" ) 
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Title # Ties this commandlet into Write-Output for styling strings                                     #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdLetBinding () ] Param ( 
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ][ String ] $Title )

            $fs = " // " ; $bs = " \\ " ; $th = "[ $Title ]" ; $y  = $th.length ; $x  = 108 - $y
            If ( $x % 4 -ge 2 ) { $x  = $x - 2 ; $y  = $th.replace( "[" , " [ " ) ; $th = $y }
            If ( $x % 2 -ge 1 ) { $x  = $x - 1 ; $y  = $th.replace( "]" , " ]" )  ; $th = $y ; $z  = 0 }
            If ( $z = 1 ) { $z = " -" } Else { $z = "- " } $y = $z * ( $x / 4 ) ; $x = "- " * ( $x / 4 )
            Echo @( "" ; ( $fs + ( "¯-" * 54 ) + $bs )
                    "$( $bs + $x + $th + $y + $fs )" )
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Array # Ties this commandlet into Write-Output for styling a string array                              #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdletBinding () ] Param (
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] [ Array ] $Block )

                $fs = " // " ; $bs = " \\ "
                Echo @( " " * 112 ; $fs + "¯-" * 54 + $bs )
                Echo $Block
                Echo @( $fs + "-_" * 54 + $bs ; " " * 112 ) 
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Section                                                                                                #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdLetBinding () ] Param (
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] [ String ] $Section , [ Switch ] $In , [ Switch ] $Out )

            If ( $In )  { $fs = " // " ; $bs = " \\ " } ; If ( $Out ) { $bs = " // " ; $fs = " \\ " }
            $z = $Section ; $x = " " * 10 ; $y = " " * ( 98 - $z.Length )
            ( $fs + "  " * 54 + $bs )
            Echo "$( $bs + $x + $z + $y + $fs )" 
            ( $fs + "  " * 54 + $bs )
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Item                                                                                                   #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdLetBinding () ] Param (
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] [ String ] $Type ,
            [ Parameter ( Position = 1 , Mandatory , ValueFromPipeline = $True ) ] [ String ] $Info , [ Switch ] $In , [ Switch ] $Out )
 
            If ( $In )  { $fs = " // " ; $bs = " \\ " } ; If ( $Out ) { $bs = " // " ; $fs = " \\ " }
            $x = " " * ( 25 - $Type.Length ) ; $y = " " * ( 80 - $Info.Length )
            Echo "$( $bs + $x + $Type ) : $( $Info + $y + $fs )" 
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Space                                                                                                  #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdLetBinding () ] Param ( [ Switch ] $In , [ Switch ] $Out )

            If ( $In  ) { $fs = " // " ; $bs = " \\ " } ; If ( $Out ) { $bs = " // " ; $fs = " \\ " }
            Echo @( $bs + ( " " * 108 ) + $fs )
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Foot                                                                                                    #¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        $fs = " // " ; $bs = " \\ " ; Echo @( ( $fs + ( "¯-" * 54 ) + $bs ) ; "" )
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Display-TrueColors # Draws this static string array on the screen ( Will replace with Math at some point )   ¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                           # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Wrap-Array -Block @(
        " \\  __________________________________________________________________________________________________________  // " ;
        " // /¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__/ // " ;
        " // /¯¯\\                                                                                                  //¯¯\ \\ " ;
        " \\ \__//    [ The beginning of the fight against Technological Tyranny and Cyber Criminal Activities ]    \\__/ // " ;
        " // /¯¯\\    __________________________________________________________________________________________    //¯¯\ \\ " ;
        " \\ \__//    \\                                     ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]________________________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]___[ Dynamically Engineered Digital Security ]__\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]________________________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]__[ Application Development - Virtualization ]__\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]________________________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]_______[ Network & Hardware Magistration ]______\\    //¯¯\ \\ " ;
        " \\ \__//    \\     What America Once Stood For     ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //_____________________________________]________________________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //_________________________________[=]\_/[=]\_/[=]\_/[=]________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //_________________________________[=]  H Y B R I D  [=]________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //__________________[=]\_/[=]\_/[=]|=|      B Y      |=|[=]\_/[=]\_/[=]_________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //__________________[-] S E C U R E - D I G I T S - P L U S - L L C [-]_________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //___________[=]\_/[=]\_/[=]\_/[=]\_/[=]\__/[=]\__/[=]\_/[=]\_/[=]\_/[=]\_/[=]__________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯[=]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯[=]¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //___________[=]  0 8 / 2 1 / 2 0 1 9  |  M I C H A E L  C  C O O K  S R   [=]__________\\    //¯¯\ \\ " ;
        " \\ \__//    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    \\__/ // " ;
        " // /¯¯\\                                [ A Heightened Sense Of Security ]                                //¯¯\ \\ " ;
        " \\ \__//                                ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                \\__/ // " ;
        " // /¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__/ // " )

        Sleep -S 2 
        
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Display-Foot # Same as the above, just using this string array below at the end of the script                ¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                     # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

        Wrap-Array -Block @(

        " // /¯¯\\__//¯¯\\__//¯¯\\    __________________________________________________________    //¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__//    Secure Digits Plus LLC | Hybrid | Desired State Controller    \\__//¯¯\\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\__//¯¯      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯      ¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯  -=-=-=-=-=-=-=[ Dynamically Engineered Digital Security ]-=-=-=-=-=-=--=-=  ¯¯\\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                           ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    //¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//   Application Development | Virtualization | Network and Hardware Magistration   \\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   //¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\__ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    //¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__         You've just deployed a heightened sense of security          __//¯¯\\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\__//¯¯\\__________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__/ // " )
        
        Sleep -S 2 
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Convert-XAMLToWindow # Overloads a block of XAML strings to convert into interactive content dynamically     ¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                             # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Param ( [ Parameter ( Mandatory ) ] [ String ]                    $XAML ,
                                            [ String [] ] $NamedElement = $Null ,
                                            [ Switch ]                $PassThru )

        @( "Framework" , "Core" | % { "Presentation$_" } ) + "WindowsBase" | % { Add-Type -AssemblyName $_ }

        $Reader       = [ XML.XMLReader ]::Create([ IO.StringReader ] $XAML )

        $Output       = [ Windows.Markup.XAMLReader ]::Load( $Reader )

        $NamedElement | % { $Output | Add-Member -MemberType NoteProperty -Name $_ -Value $Output.FindName( $_ ) -Force }

        If ( $PassThru )  { $Output }

        Else { $Null = $GUI.Dispatcher.InvokeAsync{ $Output = $GUI.ShowDialog() ;
        SV -Name Output -Value $Output -Scope 1 }.Wait() ; $Output } }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Show-WPFWindow # Displays the previously overloaded XAML string      ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
    {                       # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Param ( [ Parameter ( Mandatory ) ] [ Windows.Window ] $GUI )

        $Output = $Null ; $Null = $GUI.Dispatcher.InvokeAsync{ $Output = $GUI.ShowDialog()
                                  SV -Name Output -Value $Output -Scope 1 }.Wait() ; $Output 
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Collect-LocalMachine # Turns local machine info into an array        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
    {
        Return @( $Env:ComputerName ; $Env:Processor_Architecture ; "$Env:SystemDrive\" ;
        @( $Env:SystemRoot | % { "$_" , "$_\System32" } ) ; $Env:ProgramData ; $Env:ProgramFiles )
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Collect-Registry # Collects installed applications from the registry ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
    {                         # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Return "" , "\WOW6432Node" | % { gp "HKLM:\SOFTWARE$_\Microsoft\Windows\CurrentVersion\Uninstall\*" }
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Install-7Zip
    {
        If ( $LM[1] -eq "x86" ) { $File = "7Z1900.exe" } Else { $File = "7z1900-x64.exe" }
        $URL  = "https://www.7-zip.org/a/$File"
        $Name = "7-Zip Archiving Utility" 
        $Path = "$Env:Temp\7-Zip" 
        $Argm = "/S" 

        If ( ( Test-Path $Path ) -ne $True ) 
        { 
            NI $Path -ItemType Directory -Value $Path 
            Wrap-Action -Type "Created" -Info "[+] Directory @: $Path" } 

            Wrap-Action "Downloading" "$Name"
            [ Net.ServicePointManager ]::SecurityProtocol = [ Net.SecurityProtocolType ]::Tls12
            IWR -URI $URL -OutFile "$Path\$File"

            Wrap-Action "Installing" "[+] $Name"
            $Dependency = SAPS -FilePath $File -Args $Argm -WorkingDirectory $Path -PassThru
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Extract-Archive # Downloads dependency programs & files              ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
    {
        $Reg = @( Collect-Registry )
        $7z  = "$( ( $Reg | ? { $_.DisplayName -like "*7-zip*" } ).InstallLocation )7z.exe"
        Return $7Z
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Initialize-HybridClient
    {
        $Script = @( "RootVar.ini" ; @( "Initialize-Hybrid" | % { "$_.ps1" , "$_`Client.ps1" } ) ) | % { "$home\Desktop\$_" }

        $Script[0] | % { If ( ( Test-Path $_ ) -eq $True ) { $R = @( GC $_ -EA 0 ) ; RI $_ -Force -EA 0 } }

        $Script[1..2] | % { If ( ( Test-Path $_ ) -eq $True ) { RI $_  -EA 0 -Force } }

        Wrap-Action "Initialized" "Hybrid"
    
        Display-TrueColors

        # Determine Bridge Variables

        $LM   = @( Collect-LocalMachine )

        $Tree = "Resources" , "Tools" , "Images" , "Profiles" , "Certificates" , "Applications"

        If ( $LM[0] -eq $R[2] ) { $DR , $SRV = $R[16] , "[ Yes ]" } Else { $DR , $SRV = $R[1] , "[ No ]" }

        $DS = "$DR\$( $R[0] )"

        $D , $P = @( )
        @( gci $DS -EA 0 ) | % { $D += @( $_.FullName ) ; $P += @( "$( $LM[2] + $R[0] )\$( $_.Name )" ) }

        $L = @( 0..5 | % { If ( ( Test-Path $P[$_] ) -ne $True ) { NI $P[$_] -ItemType Directory } Else { GI $P[$_] } } ).FullName

        # Display Root Variables

        Wrap-Title "Provisional-Root"

        Wrap-Section "[ Domain State Controller @ Source ]" -In
        $Type = @( "Provisionary" ; "( DSC ) Share" ; "( DSC ) Controller" ; "Resources" ; "Tools" ; "Images" ; "Profiles" ; "Certificates" ; "Applications" )
        $Info = @( $R[0..2] ; $D[0..5] ) 
        0..8 | % { If ( $_ % 2 -ge 1 ) { Wrap-Item $Type[$_] $Info[$_] -Out } Else { Wrap-Item $Type[$_] $Info[$_] -In } }
        Sleep -M 250

        Wrap-Section "[ Current Machine @ Variables ]" -In
        $Type = @( "Server" ; "Hostname" ; "Architecture" ; "System Drive" ; "Windows Root" ; "System32" ; "Program Data" )
        $Info = @( $SRV ; $R[2] ; $LM[1..5] )
        0..6 | % { If ( $_ % 2 -ge 1 ) { Wrap-Item $Type[$_] $Info[$_] -Out } Else { Wrap-Item $Type[$_] $Info[$_] -In } }
        Sleep -M 250

        Wrap-Section "[ Provision Index @ Bridge Control ]" -In
        $Type = @( "( DSC ) Target" ; @( $Tree[0..5] ) )
        $Info = @( $LM[0] ; $L[0..5] ) 
        0..6 | % { If ( $_ % 2 -ge 1 ) { Wrap-Item $Type[$_] $Info[$_] -Out } Else { Wrap-Item $Type[$_] $Info[$_] -In } }
        Sleep -M 250

        Wrap-Section "[ Company / Provisionary / Support Details ]" -In
        $Type = @( "Name" , "Website" , "Phone" , "Hours" , "Logo" , "Background" | % { "Company $_" } )
        $Info = @( $R[0] ; $R[5..9] )
        0..5 | % { If ( $_ % 2 -ge 1 ) { Wrap-Item $Type[$_] $Info[$_] -Out } Else { Wrap-Item $Type[$_] $Info[$_] -In } }

        Wrap-Space -In ; Wrap-Foot ; Read-Host "Validate this information. Press 'Enter' to Continue"

        Install-7Zip
        
        Set-Alias SZ $( Extract-Archive )

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        
        # Certificate Chains / # Will automatically inject if in the correct folders

        Wrap-Action "Installing" "[~] Certificate Chain"
            
        $Full , $Name , $CRT = 0..2 | % { @( ) }

        gci $d[4] -EA 0 | % { $Full += @( $_.FullName ) ; $Name += @( $_.Name.Split(')')[-1] ) }

        ForEach ( $i in 0..2 ) 
        { 
            If ( ( Test-Path $Full[$i] ) -eq $True ) 
            { 
                $CRT += gci $Full[$i] -Filter "*.crt" | % {
                
                    If ( $CRT -ne $Null ) 
                    {
                        Import-Certificate -FilePath $_.FullName -CertStoreLocation "Cert:\LocalMachine\$( $Name[$i] )"
                        If ( $? -eq $True ) { Wrap-Action "Installed" "[+] $( $_.BaseName )" }
                    }
                }

                $CRT = @( )
            }
        }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        # Virtual Machine Template / # Will Automatically Select the correct package

        Wrap-Action "Provision" "[~] Virtualization"
        $Model = ( gcim Win32_ComputerSystem ).Model
        $Dir = $D[1] , $L[1] | % { "$_\(2)VM" }

        If ( $Model -like "*VMWare*" )
        {
            Wrap-Action "Detected" "[+] VMWare"

            $Filter = $( If ( $LM[1] -eq "AMD64" ) { "x86_64" } Else { "i386" } )
            $Exe = ( gci $Dir[0] -Filter "*$Filter*" -EA 0 ).Name
            Robocopy $Dir[0..1] $Exe
            $VM = "$( $Dir[1] )\$Exe" , '/s /v "/qn reboot=r"' , "VMWare Tools ( $( $LM[1] ) )"

            $VirtualMachine = 1
        }

        If ( $Model -like "*VirtualBox*" )
        {
            Wrap-Action "Detected" "[+] Oracle"
                
            $Filter = $( If ( $LM[1] -eq "AMD64" ) { "AMD64" } Else { "x86" } )
            $Exe = ( gci $Dir[0] -Filter "*Guest*" -EA 0 ).Name
            Robocopy $Dir[0..1] $Exe

            SZ x "$( $Dir[1] )\$Exe" -o"$( $Dir[1] )"
            RI "$( $Dir[1] )\$Exe"
            $Exe = $Exe.Replace( "_$( $Exe.Split('_')[1] )" , "-$Filter.exe" )

            1 , 256 | % {
            Import-Certificate -FilePath "$( $Dir[1] )\cert\vbox-sha$_.cer" -CertStoreLocation "Cert:\LocalMachine\TrustedPublisher" }

            $VM = "$( $Dir[1] )\$Exe" , '/s "/qn reboot=r"' , "VirtualBox Guest Additions $( $LM[1] )"

            $VirtualMachine = 1
        }

        If ( $VirtualMachine -eq 1 )
        {
            $VirtualMachine = SAPS -FilePath $vm[0] -ArgumentList $vm[1] -PassThru

            For ( $j = 0 ; $j -le 100 ; $j = ( $j + 1 ) % 100 )
            {
                Write-Progress -Activity "[ Installing ] $( $vm[2] )" -PercentComplete $j -Status "$( $j )% Complete"
                Sleep -M 650

                If ( $VirtualMachine.HasExited )
                {
                    Write-Progress -Activity "[ Installed ] $( $vm[2] )" -Completed
                    Return
                }
            }
        }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        # Branding Template

        Wrap-Action "Branding" "[+] Apply OEM/Support Information"

        $Res = ( $R[8] , $R[9] ) | % { GCI $d[0] -Filter $_ -EA 0 }
        
        $Res | % { Robocopy $_.DirectoryName $l[0] $_.Name }

        $LG , $BG = $R[8..9] | % { ( GCI $l[0] -Filter $_ -EA 0 ) }

        $H    = "HKLM:" , "HKCU:"

        $OR   = 'Software\Policies\Microsoft\Windows'       , 
                'Software\Microsoft\Windows\CurrentVersion' , 
                'Policies'                                  , 
                'OEMInformation'                            , 
                'Authentication\LogonUI\Background'         , 
                'Control Panel\Desktop'
        
        $OC   = @( $H[0] + $OR[0] ; @( $H[0..1] | % { $_ + $OR[1] } ) )

        $TP   = 'Personalization' ,       'System' ,   'Manufacturer' ,    'SupportURL' , 
                   'SupportPhone' , 'SupportHours' ,           'Logo' , 'OEMBackground' , 
                'LockScreenImage' ,    'Wallpaper' , 'WallPaperStyle'

        $OF =         'OOBE\Info' ,  'Backgrounds' ,  'Microsoft\User Account Pictures' ,
                     'Web\Screen' , 'Web\Wallpaper\Windows'

        # C:\WINDOWS\System32\OOBE\Info 

        $OEM = "$( $LM[4] )\$( $OF[0] )"

        # [+] Backgrounds

        $OEM | % { "$_\$( $OF[1] )" | % { 

            If ( ( Test-Path $_ ) -ne $True ) { NI -Path $_ -ItemType Directory ; Wrap-Action "Directory" "[+] $F" } 
            Else { GI $_ } 
            } 
        }

        # Copy Logo to System Folders

        @( "$( $LM[4] )" | % { "$_" , "$_\$( $OF[0] )" } ) + "$( $LM[5] )\$( $OF[2] )" | % { 

            If ( Test-Path $_ ) 
            { 
                Robocopy $LG.DirectoryName $_ $LG.Name
                Wrap-Action "Logo" "[+] Copied $_"
            }
        }
        
        # Copy Background to System Folders

        @( "$OEM\$( $OF[1] )" ; @( $OF[3] , $OF[4] | % { "$( $LM[3] )\$_" } ) ) | % { 

            If ( Test-Path $_ )
            {
                Robocopy $BG.DirectoryName $_ $BG.Name
                Wrap-Action "Background" "[+] copied $_"
            }
        }

        # HKLM:\Software\Policies\Microsoft\Windows [+] Personalization 

        $Path , $Type = $OC[0] , $TP[0]
        If ( ( Test-Path "$Path\$Type" ) -ne $True ) { NI -Path $Path -Name $Type -Force ; Wrap-Action "Created" $Type }

        # Lock Screen

        $Path  = "$Path\$Type" ; $Type , $Value = "$( $TP[8] )" , "$( $LM[3] )\$( $OF[3] )\$( $R[9] )"
        SP $Path -Name $Type -Value $Value ; If ( $? -eq $True ) { Wrap-Action "$Type" "[+] $Value" }

        # HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies [+] System

        $Path , $Type = "$( $OC[2] )\$( $OR[2] )" , "$( $TP[1] )"
        If ( ( Test-Path "$Path\$Type" ) -ne $True ) { NI -Path $Path -Name $Type -Force ; Wrap-Action "Created" $Type }

        # Set Wallpaper / Style

        $Value = "$( $LM[3] )\$( $OF[4] )\$( $R[9] )" , 2 ; $Type  = $TP[9..10]
        ForEach ( $i in 0..1 ) 
        { 
            SP $Path -Name $Type[$i] -Value $Value[$i]        
            If ( $? -eq $True ) 
            { 
                Wrap-Action "$( $Type[$i] )" "[+] $( If ( $i -eq 1 ) { echo "Fit to Screen" } Else { echo $Value[$i] } )" }     
        }

        # HKLM:\Software\Microsoft\Windows\CurrentVersion\OEMInformation
        # Provisionary Name / Provisionary Website / Support Phone Number / Support Hours / Logo

        $Path  = "$( $OC[1] )\$( $OR[3] )" ; $Value = @( $R[0] ; $R[5..7] ; "$( $LM[4] )\$( $R[8] )" ) ; $Type  = $TP[2..6]
        ForEach ( $i in 0..4 )
        {
            SP $Path -Name $Type[$i] -Value $Value[$i] 
            If ( $i -eq 4 ) { $Value[$i] = $LG.Name }
            If ( $? -eq $True ) { Wrap-Action "$( $Type[$i] )" "[+] $( $Value[$i] )" } 
        }

        # HKLM:\Software\Microsoft\Windows\CurrentVersion\Authentication\LogonUI\Background
        # Logon Background
        $Path , $Type , $Value = "$( $OC[1] )\$( $OR[4] )" , $TP[7] , 1

        SP $Path -Name $Type -Value $Value
        If ( $? -eq $True ) { Wrap-Action $Type "[+] Background" }

        # HKCU:\Control Panel\Desktop'
        $Path , $Type , $Value = "$( $H[1] )\$( $OR[5] )" , "$( $TP[9] )" , "$( $LM[3] )\$( $OF[4] )\$( $R[9] )"

        SP $Path -Name $Type -Value $Value

        rundll32.exe user32.dll , UpdatePerUserSystemParameters 1 , True

        If ( $? -eq $True ) { Wrap-Action $Type        "[+] Wallpaper Set"     }
        Else                { Wrap-Action "Exception"  "[!] Wallpaper not set" }

        # Launch the System Panel for review
        Control /name microsoft.system
        Wrap-Action "Complete" "[+] OEM Branding Applied"

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        # Provisioning Drivers

    Wrap-Action "Provision" "[~] Drivers"

    switch ( $host.UI.PromptForChoice( 'Provision-Drivers' , 'Install the drivers for this machine?' , 
    [ Host.ChoiceDescription [] ]@( '&Yes' , '&No' ) , [ Int ] 1 ) )
    {
        0
        {   Wrap-Action "Loading" "[+] Dynamic Driver Template"

            # Target the Snappy Driver Installer Library from DSC

            $Drivers = ( gci "$( $D[1] )\(0)Drivers" ).FullName
            $SDI     = ( gci $Drivers -Filter "*$( If ( $LM[1] -eq "AMD64" ) { "SDI_x64_R" } Else { "SDI_R" } )*" ).FullName
            $CFG     = @"  
                           "-drp_dir:drivers"         , 
                         "-index_dir:indexes\SDI"     , 
                        "-output_dir:indexes\SDI\txt" ,
                          "-data_dir:tools\SDI"       , 
                           "-log_dir:logs"            , 
                        "-finish_cmd:-autoclose"      , 
                      "-finishrb_cmd:"                , 
                    "-finish_upd_cmd:"                , 
                              "-lang:English"         , 
                             "-theme:Lite"            , 
                         "-hintdelay:500"             , 
                           "-license:1"               , 
                             "-wndwx:800"             , 
                             "-wndwy:600"             , 
                             "-wndsc:1"               , 
                             "-scale:250"             , 
                           "-filters:166"             , 
                              "-port:50171"           , 
                         "-downlimit:0"               , 
                           "-uplimit:0"               , 
                       "-connections:0"               , 
                    "-expertmode -norestorepnt -showdrpnames2 -checkupdates" 
                        "-extractdir:'$( $L[1] )\(0)Drivers'"
"@
                SC -Path "$Drivers\SDI.cfg" -Value $CFG -Force
                
                $Firewall = @{ DisplayName   = "$( Split-Path -Leaf $SDI )"
                               Direction     = "Inbound"
                               Program       = "$SDI"
                               RemoteAddress = "LocalSubnet"
                               Action        = "Allow" }

                Wrap-Action "Creating" "Firewall Entries for $( $Firewall.DisplayName )"

                New-NetFirewallRule @Firewall ; $Firewall.Direction = "Outbound" ; New-NetFirewallRule @Firewall

                Wrap-Action "Launching" "Snappy Driver Installer"
                
                SAPS -FilePath "$Drivers\SDI.bat"

            }

            1
            {   Wrap-Action "Bypass" "[-] Dynamic Driver Template" }

        }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        # Provisioning Applications

    Wrap-Function "Provision" "[~] Applications"

    switch ( $host.UI.PromptForChoice( 'Provision-Applications' , 'Install standard applications via Local Proxy or Chocolatey ?' , 
    [ Host.ChoiceDescription[]]@( '&Local' , '&Chocolatey' , '&Skip' ) , [ Int ] 0 ) )
    {
        # Pull applications from proxy/DC
        0
        {   Wrap-Action "Selected" "Local Proxy"

            $Apps  = @( gci $D[5] )[0,0,1,1,3,3,4,4,5,6,7,8,8,9,10,2]

            $Path  = "chrome" , "silverlight" , "jre" , "libre" , "mwb" , "flash" , "air" , "reader" , "ccleaner" , "klite" ,  "tv"
            0..10  | % { "$( $L[5] )\($_)$( $Path[$_] )" | % { If ( ( Test-Path $_ ) -ne $True ) { NI "$_" -ItemType Directory } Else { GI $_ } } }

            $Dest  = @( gci $L[5] )[0,0,1,1,3,3,4,4,5,6,7,8,8,9,10,2]

            $List  = gc ( gci $D[5] -Filter "*List.ini*" ).FullName

            $z = 0
            $h = $List[80..0] | Group-Object { $z % 5 ; $script:z++ } -AsHashTable

            $Item = @( 0..15 )
            ForEach ( $i in 0..15 ) 
            { 
                $Item[$i] = @{   File = $h[3][$i].Replace( 'File=' , '' )
                                 Name = $h[2][$i].Replace( 'Name=' , '' )
                                  Sum = $h[1][$i].Replace(  'Sum=' , '' ) 
                                  URL = $h[0][$i].Replace(  'URL=' , '' ) } }

            If ( $LM[1] -eq "AMD64" ) { $Selection = 1 , 3 , 5 + 7..15 }
            If ( $LM[1] -eq "x86"   ) { $Selection = 0 , 2 , 4 , 6 + 8..15 }

            $Argm   = @( 0..1 | % { "/quiet /norestart" } ;
                         0..1 | % { "/q" } ;
                         0..1 | % { "/s REBOOT=0 SPONSORS=0 AUTO_UPDATE=0" } ;
                         0..1 | % { "/qn /norestart AllUsers=1"  } ; 
                         "/VERYSILENT /SUPPRESSMSGBOXES /NORESTART" , 
                         "/quiet /norestart REMOVE_PREVIOUS=YES" , 
                         "-silent -eulaAccepted" , 
                         "/sAll /msi /norestart /quiet ALLUSERS=1 EULA_ACCEPT=YES UPDATE_MODE=3 /L*v '$( "$Env:Temp\Adobe Reader DC" )'"
                         "/p '$( "$Env:Temp\Adobe Reader DC" )' /norestart /quiet ALLUSERS=1 EULA_ACCEPT=YES /L*v '$( "$Env:Temp\Adobe Reader DC MSP Update" ) )'"
                         "/S /L=$( ( Get-Culture ).LCID )" , 
                         "/VERYSILENT /NORESTART" , 
                         "/S" )

            IPMO BitsTransfer
            [ Net.ServicePointManager ]::SecurityProtocol = [ Net.SecurityProtocolType ]::TLS12
            ForEach ( $i in $Selection )
            {
                If ( ( Test-Path $Item[$i].File ) -ne $True )
                {
                    $Item[$i] | % { Start-BitsTransfer -Source $_.URL -Destination $_.File -Description $_.Name
                    If ( $? -ne $True ) { IWR -URI $_.URL -OutFile $_.File }
                    }
                }

                If ( $i -eq 13 ) 
                {
                    $CC = @( "" , "\WOW6432Node" | % { "HKLM:\Software$_\Google\No" } | % { "$_ Chrome" , "$_ Toolbar" } ) | % { "$_ Offer Until" } 

                    If ( $CPU -eq "x86" ) { $CC = $cc[0..1] } Else { $CC = $cc[2..3] }

                    $CC | % {   NI $_ -ItemType Directory -Force 
                                SP -Name "Piriform" -Path $_ -PropertyType "DWORD" -Value "20991231" -Force }
                }

                Else 
                {
                    $Source = $Apps[$i].FullName
                    $Target = $Dest[$i].FullName
                    $File   = ( Split-Path $Item[$i].File -Leaf )
                    $ArgL   = $Argm[$i] 

                    Robocopy $Source $Target $File
                    $Application = SAPS -FilePath "$Target\$File" -ArgumentList "$ArgL" -PassThru 
               

                    For ( $j = 0 ; $j -le 100 ; $j = ( $j + 1 ) % 100 )
                    {
                        Write-Progress -Activity " [ Installing ] $FullName" -PercentComplete $j -Status "$( $j )% Complete"     
                        Sleep -M 500
                                
                        If ( $Application.HasExited ) 
                        {
                            Write-Progress -Activity "[ Installed ]" -Completed
                            Return
                        }
                    }
                }
            }

            # Pull Applications from Chocolatey...
            1
            {   Wrap-Action "Selected" "Chocolatey Package Manager"
                IEX ( New-Object Net.Webclient ).DownloadString( 'https://chocolatey.org/install.ps1' )

                $package = "googlechrome" , "malwarebytes" , "flashplayerplugin" , 
                "adobeair" , "adobereader" , "silverlight" , "jre8" , "ccleaner" , 
                "k-litecodecpackfull" , "teamviewer"

                $package | % { 

                    Wrap-Action "Installing" "$_"
                    choco install $_ -y

                    If ( $? -eq $True ) { Wrap-Action "Installed" "[+] Chocolatey @ $_"      }
                    Else                { Wrap-Action "Exception" "[!] $_ was not installed" }

                    Wrap-Action "Complete" "[+] Chocolatey - Default Applications Installed"
                }

            }

            # Skip / Don't install applications at this time
            2
            {   Wrap-Action "Bypass" "Default Applications Skipped" }
        }
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        # Provisioning Any Missing Windows Updates

    Wrap-Action "Provision-Updates"

    Function Install-Update 
    {
        $Update = SAPS -FilePath $_.FullName -PassThru

        For ( $j = 0 ; $j -le 100 ; $j = ( $j + 1 ) % 100 )
        {
            Write-Progress -Activity " [ Installing ] $( $_.Name )" -PercentComplete $j -Status "$( $j )% Complete"
            Sleep -M 500
                                
            If ( $Update.HasExited ) { Write-Progress -Activity "[ Installed ]" -Completed ; Return }
        }
    }

    If ( $lm[1] -eq "x86" ) { $Arch = "x86" } Else { $Arch = "x64" }
    
    "$( $D[2] )\Updates\$Arch" | % { If ( ( Test-Path $_ ) -eq $True ) { gci $_ -EA 0 | % { Install-Update } } }
        
    Start ms-settings:windowsupdate-action

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        # Designate a User Account, and/or migrate their data

    Wrap-Function "Designate" "[~] User Account"

    Switch ( $host.UI.PromptForChoice( 'Designate-Account' , 'Migrate/Create User Account, or skip ?' , 
    [ Host.ChoiceDescription [] ]@( '&Create' , '&Skip' ) , [ Int ] 1 ) )
    {
        # User Account Designation GUI
        0
        {   Wrap-Action "Select" "[+] User Account"

            $xaml = @"
        <Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
            Title="Secure Digits Plus LLC | Hybrid @ Account Designation" Width="480" Height="300" 
            HorizontalAlignment="Center" ResizeMode="NoResize" WindowStartupLocation="CenterScreen" 
            Topmost="True">
            <GroupBox Header="Enter Username and Password" HorizontalAlignment="Center" VerticalAlignment="Center" Height="250" Margin="10,10,10,10" Width="460">
                <Grid Height="200">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="25*"/>
                        <ColumnDefinition Width="75*"/>
                        <ColumnDefinition Width="34*"/>
                        <ColumnDefinition Width="75*"/>
                        <ColumnDefinition Width="25*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height = "*" />
                        <RowDefinition Height = "*" />
                        <RowDefinition Height = "1.5*" />
                        <RowDefinition Height = "1.5*" />
                        <RowDefinition Height = "1.5*" />
                        <RowDefinition Height = "1.5*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.ColumnSpan="3" Grid.Row="0" FontSize="12" HorizontalAlignment="Center" Width="353" Grid.Column="1" TextAlignment="Center" Text="Enter the credentials you would like to designate to your user."/>
                    <TextBlock Grid.ColumnSpan="3" Grid.Row="1" FontSize="12" HorizontalAlignment="Center" Width="353" Grid.Column="1">A password is required, but may be changed after logging in.</TextBlock>
                    <TextBlock Grid.Row="2" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,25,0" Height="20" Width="120" TextAlignment="Right" Grid.Column="1">Username:</TextBlock>
                    <TextBlock Grid.Row="3" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,25,0" Height="20" Width="120" TextAlignment="Right" Text="Password:" Grid.Column="1"/>
                    <TextBlock Grid.Row="4" FontSize="12" HorizontalAlignment="Right" VerticalAlignment="Center" Height="20" Width="120" Text="Confirm:" Margin="0,0,25,0" Grid.Column="1" TextAlignment="Right"/>
                    <TextBox Name="Username" Grid.Row="2" Grid.Column="2" Height="24" Width="180" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="40,0,0,0" Grid.ColumnSpan="3"></TextBox>
                    <PasswordBox Name="Password" PasswordChar="*" Grid.Row="3" Grid.Column="2" Height="24" Width="180" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="40,0,0,0" Grid.ColumnSpan="3"></PasswordBox>
                    <PasswordBox Name="Confirm" PasswordChar="*" Grid.Row="4" Grid.Column="2" Height="24" Width="180" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="40,0,0,0" Grid.ColumnSpan="3"></PasswordBox>
                    <Button Grid.Row="5" Grid.Column="1" Name="Ok" Content="OK" Width="140" HorizontalAlignment="Right" Margin="0,15,0,0"/>
                    <Button Grid.Row="5" Grid.Column="3" Name="Cancel" Content="Cancel" Width="140" HorizontalAlignment="Center" Margin="0,15,0,0"/>
                </Grid>
            </GroupBox>
        </Window>
"@
            $GUI = Convert-XAMLtoWindow -Xaml $xaml -NamedElement 'Username', 'Password', 'Confirm', 'Ok', 'Cancel' -PassThru

            $GUI.Cancel.add_Click( { $GUI.DialogResult = $false } )

            $GUI.Ok.add_Click({ 

            $0 = "Username" , "Password" , "Confirmation"
            $1 = $0 | % { "You must enter a $_" } ; $2 = $0 | % { "$_ Missing" } ;
            $MSG = 0..2 | % { "[ System.Windows.MessageBox ]::Show( '$( $1[$_] )' , '$( $2[$_] )' ) " }

            If     ( $GUI.Username.Text     -eq "" )                    { IEX $MSG[0] }
            ElseIf ( $GUI.Password.Password -eq "" )                    { IEX $MSG[1] }
            ElseIf ( $GUI.Password.Password -ne $GUI.Confirm.Password ) { IEX $MSG[2] }
            
            Else { $GUI.DialogResult = $True }
            
            })

            $GUI.Username.Text     = ''
            $GUI.Password.Password = ''
            $GUI.Confirm.Password  = ''

            $Null = $GUI.Username.Focus()

            $Output = Show-WPFWindow -GUI $GUI

            If ( $Output -eq $True )
            { 
                Wrap-Action "Generating" "[+] User Account"

                $Username = $GUI.Username.Text
                $Password = $GUI.SecurePassword.Password
                $SP = $Password

                NLU $Username -Password $SP -Description "Target User account"
                ALGM -Group "Administrators" -Member $Username

                $Account = [ PSCredential ]::new( $Username , $SP )

                SAPS explorer.exe -Credential $Account -Args "/separate" -WorkingDirectory "C:\Windows"

                If ( $? -eq $True ) 
                { 
                    Wrap-Action "Profile" "[+] Successfully created"
                    If ( ( Test-Path "$( $D[0] )\StartLayout.xml" ) -eq $True )
                    {
                        Robocopy $D[0] $L[0] "StartLayout.xml"
                        Import-StartLayout -LayoutPath "$( $l[0] )\StartLayout.xml" -MountPath "$( $lm[2] )"
                        If ( $? -eq $True ) { Wrap-Action "Layout" "[+] Import Successful" }
                        Else { Wrap-Action "Exception" "[!] Layout was not imported successfully" }
                    }

                    Switch ( $host.UI.PromptForChoice( 'Migrate-Account' , 'Migrate an existing account, or skip ?' , 
                    [ Host.ChoiceDescription [] ]@( '&Migrate' , '&Skip' ) , [ Int ] 1 ) )
                    {
                        0
                        {   Wrap-Action "Selected" "[+] Account Migration"
                            Robocopy $D[0] "$( $LM[2] )Users\$Username\Desktop" "UEV-Profile.ps1"
                            If ( $? -eq $True ) { Wrap-Action "Profile" "[+] Import Script copied Successful" }
                            Else { Wrap-Action "Exception" "[!] Import script failed to be copied" }
                        }

                        1
                        {   Wrap-Action "Selected" "[+] Bypass" }
                    }

                    If ( $LM[0] -ne $R[2] ) { DLU -Name $( $R[12] ) -Confirm }
                }

            }

            Else { Wrap-Action "Cancelled" "The user either cancelled the dialog or it failed" }

            1
            {   Wrap-Action "Skipping" "[~] User Account Generation" }
        }
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        # Make certain that Windows is Activated

    Wrap-Action "Activate" "[+] Windows"
    
    Start ms-settings:activation

    MSINFO32

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
        # Final steps before UEV Profile Import can commence

    Wrap-Action "Close" "[!] Script"

        Switch ( $host.UI.PromptForChoice( 'Close-Script' , 'Things happened. [W]ait for drivers/apps, or [R]eboot ?' , 
        [ Host.ChoiceDescription [] ]@( '&Wait' , '&Reboot' ) , [ Int ] 1 ) )
        {
            0
            {   Wrap-Action "Waiting" "For things to like, do stuff. That's OK in my book."
                Display-Foot ; Sleep -S 3 ; Exit 
            }

            1
            {   Wrap-Action "Reboot" "[+] Machine is now in the process of rebooting."
                Display-Foot ; Sleep -S 3 ; Restart-Computer 
            }

        }
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
            Initialize-HybridClient                             #//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\______________________________________________________________\\__//__\\__//__\\__//__\\__//__\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯     __________________________________________________________     ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯ -=-=-=-=-=-=-=[ Dynamically Engineered Digital Security ]-=-=-=-=-=-=--=-= ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                           ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   Application Development | Virtualization | Network and Hardware Magistration   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\
#¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
