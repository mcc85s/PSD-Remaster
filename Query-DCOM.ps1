#_____________________________________________________________________________________________________________________________________________________
#//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\--//--\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯     __________________________________________________________     ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯ -=-=-=-=-=-=-=[ Dynamically Engineered Digital Security ]-=-=-=-=-=-=--=-= ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                           ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   Application Development | Virtualization | Network and Hardware Magistration   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
#//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\
#\\  [ Secure-System ] @: The module or set of modules that scopes out all things registry, DCOM, AppID, CLSID, and permissions related.
#//__________________________________________________________________________________________________________________________________________\\__//¯¯\\
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
                                                                                                                                     #\__//¯¯\\__//¯¯\\
    Using Namespace System.Security.Principal
    Using Namespace System.Security.AccessControl
    Using Namespace System.Management.Automation
    Using NameSpace System.DirectoryServices

    $CS , $OS = "ComputerSystem" , "OperatingSystem" | % { GCIM Win32_$_ }
    If ( $CS.PartOfDomain -eq $True ) { $LoadActiveDirectory = 1 }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Action # Ties this commandlet into Write-Output for styling strings                                    #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdletBinding () ] Param (
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ][ String ] $Type ,
            [ Parameter ( Position = 1 , Mandatory , ValueFromPipeline = $True ) ][ String ] $Info )

            $fs = " // " ; $bs = " \\ " ; $x = " " * ( 25 - $Type.Length ) ; $y = " " * ( 80 - $Info.Length )

            Echo @( "" ; ( $fs + ( "¯-" * 54 ) + $bs ) ;
            "$( $bs + $x + $Type ) : $( $Info + $y + $fs )" ;
            ( $fs + ( "-_" * 54 ) + $bs ) ; "" ) 
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Title # Ties this commandlet into Write-Output for styling strings                                     #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdLetBinding () ] Param ( 
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ][ String ] $Title )

            $fs = " // " ; $bs = " \\ " ; $th = "[ $Title ]" ; $y  = $th.length ; $x  = 108 - $y
            If ( $x % 4 -ge 2 ) { $x  = $x - 2 ; $y  = $th.replace( "[" , " [ " ) ; $th = $y }
            If ( $x % 2 -ge 1 ) { $x  = $x - 1 ; $y  = $th.replace( "]" , " ]" )  ; $th = $y ; $z  = 0 }
            If ( $z = 1 ) { $z = " -" } Else { $z = "- " } $y = $z * ( $x / 4 ) ; $x = "- " * ( $x / 4 )
            Echo @( "" ; ( $fs + ( "¯-" * 54 ) + $bs )
                    "$( $bs + $x + $th + $y + $fs )" )
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Array # Ties this commandlet into Write-Output for styling a string array                              #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdletBinding () ] Param (
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] [ Array ] $Block )

                $fs = " // " ; $bs = " \\ "
                Echo @( " " * 112 ; $fs + "¯-" * 54 + $bs )
                Echo $Block
                Echo @( $fs + "-_" * 54 + $bs ; " " * 112 ) 
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Section                                                                                                #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdLetBinding () ] Param (
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] [ String ] $Section , [ Switch ] $In , [ Switch ] $Out )

            If ( $In )  { $fs = " // " ; $bs = " \\ " } ; If ( $Out ) { $bs = " // " ; $fs = " \\ " }
            $z = $Section ; $x = " " * 10 ; $y = " " * ( 98 - $z.Length )
            ( $fs + "  " * 54 + $bs )
            Echo "$( $bs + $x + $z + $y + $fs )" 
            ( $fs + "  " * 54 + $bs )
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Item                                                                                                   #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdLetBinding () ] Param (
            [ Parameter ( Position = 0 , Mandatory , ValueFromPipeline = $True ) ] [ String ] $Type ,
            [ Parameter ( Position = 1 , Mandatory , ValueFromPipeline = $True ) ] [ String ] $Info , [ Switch ] $In , [ Switch ] $Out )
 
            If ( $In )  { $fs = " // " ; $bs = " \\ " } ; If ( $Out ) { $bs = " // " ; $fs = " \\ " }
            $x = " " * ( 25 - $Type.Length ) ; $y = " " * ( 80 - $Info.Length )
            Echo "$( $bs + $x + $Type ) : $( $Info + $y + $fs )" 
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Space                                                                                                  #¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        [ CmdLetBinding () ] Param ( [ Switch ] $In , [ Switch ] $Out )

            If ( $In  ) { $fs = " // " ; $bs = " \\ " } ; If ( $Out ) { $bs = " // " ; $fs = " \\ " }
            Echo @( $bs + ( " " * 108 ) + $fs )
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Wrap-Foot                                                                                                    #¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                                                                                                                        #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        $fs = " // " ; $bs = " \\ " ; Echo @( ( $fs + ( "¯-" * 54 ) + $bs ) ; "" )
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Display-TrueColors # Draws this static string array on the screen ( Will replace with Math at some point )   ¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                           # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Wrap-Array -Block @(
        " \\  __________________________________________________________________________________________________________  // " ;
        " // /¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__/ // " ;
        " // /¯¯\\                                                                                                  //¯¯\ \\ " ;
        " \\ \__//    [ The beginning of the fight against Technological Tyranny and Cyber Criminal Activities ]    \\__/ // " ;
        " // /¯¯\\    __________________________________________________________________________________________    //¯¯\ \\ " ;
        " \\ \__//    \\                                     ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]________________________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]___[ Dynamically Engineered Digital Security ]__\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]________________________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]__[ Application Development - Virtualization ]__\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]________________________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\      *     *     *     *     *      ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //   *     *     *     *     *     *   ]_______[ Network & Hardware Magistration ]______\\    //¯¯\ \\ " ;
        " \\ \__//    \\     What America Once Stood For     ]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //_____________________________________]________________________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //_________________________________[=]\_/[=]\_/[=]\_/[=]________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //_________________________________[=]  H Y B R I D  [=]________________________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //__________________[=]\_/[=]\_/[=]|=|      B Y      |=|[=]\_/[=]\_/[=]_________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯| |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //__________________[-] S E C U R E - D I G I T S - P L U S - L L C [-]_________________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //___________[=]\_/[=]\_/[=]\_/[=]\_/[=]\__/[=]\__/[=]\_/[=]\_/[=]\_/[=]\_/[=]__________\\    //¯¯\ \\ " ;
        " \\ \__//    \\¯¯¯¯¯¯¯¯¯¯¯[=]¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯[=]¯¯¯¯¯¯¯¯¯¯//    \\__/ // " ;
        " // /¯¯\\    //___________[=]  0 8 / 1 8 / 2 0 1 9  |  M I C H A E L  C  C O O K  S R   [=]__________\\    //¯¯\ \\ " ;
        " \\ \__//    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    \\__/ // " ;
        " // /¯¯\\                                [ A Heightened Sense Of Security ]                                //¯¯\ \\ " ;
        " \\ \__//                                ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                \\__/ // " ;
        " // /¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__/ // " )

        Sleep -S 2 
        
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Display-Foot # Same as the above, just using this string array below at the end of the script                ¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                     # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

        Wrap-Array -Block @(

        " // /¯¯\\__//¯¯\\__//¯¯\\    __________________________________________________________    //¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__//    Secure Digits Plus LLC | Hybrid | Desired State Controller    \\__//¯¯\\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\__//¯¯      ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯      ¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯  -=-=-=-=-=-=-=[ Dynamically Engineered Digital Security ]-=-=-=-=-=-=--=-=  ¯¯\\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                           ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    //¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//   Application Development | Virtualization | Network and Hardware Magistration   \\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   //¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\__ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    //¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__         You've just deployed a heightened sense of security          __//¯¯\\__//¯¯\\__/ // " ;
        " // /¯¯\\__//¯¯\\__//¯¯\\__________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\ \\ " ;
        " \\ \__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__/ // " )
        
        Sleep -S 2 
    }

# ____                                                                                                                    ____________________________
#//¯¯\\__________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Convert-XAMLToWindow # Overloads a block of XAML strings to convert into interactive content dynamically     ¯¯¯\\__//¯¯\\__//__\\__//¯¯\\
    {                             # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Param ( [ Parameter ( Mandatory ) ] [ String ] $XAML , [ String [] ] $NamedElement = $Null , [ Switch ] $PassThru )

        @( "Framework" , "Core" | % { "Presentation$_" } ) + "WindowsBase" | % { Add-Type -AssemblyName $_ }

        $Reader = [ XML.XMLReader ]::Create( [ IO.StringReader ] $XAML )

        $Output = [ Windows.Markup.XAMLReader ]::Load( $Reader ) 

        $NamedElement | % { $Output | Add-Member -MemberType NoteProperty -Name $_ -Value $Output.FindName( $_ ) -Force }

        If ( $PassThru )  { $Output }

        Else { $Null = $GUI.Dispatcher.InvokeAsync{ $Output = $GUI.ShowDialog() ;
        SV -Name Output -Value $Output -Scope 1 }.Wait() ; $Output } }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Show-WPFWindow # Displays the previously overloaded XAML string      ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
    {                       # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
        Param ( [ Parameter ( Mandatory ) ] [ Windows.Window ] $GUI )

        $Output = $Null ; $Null = $GUI.Dispatcher.InvokeAsync{ $Output = $GUI.ShowDialog()
                                  SV -Name Output -Value $Output -Scope 1 }.Wait() ; $Output 
    }

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Test-Creds # Tests an input credential for AD/WG Authentication      ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
    {
        [ CmdLetBinding () ][ OutputType ( [ Int ] ) ] Param ( 
        
            [ Parameter ( ValueFromPipeLine = $True , ValueFromPipelineByPropertyName = $True ) ]
        
                [ Alias ( 'PSCredential' ) ] [ ValidateNotNull () ][ PSCredential ]
        
                [ Credential () ] $Creds )

        ( $Domain , $Root , $Username , $Password ) = @( 0..3 | % { $Null } )
     
        Try       
        {
            $AD      = "LDAP://$( ( [ ADSI ]'').distinguishedName )"
            $Creds   | % { $UN = $_.Username ; $PW = $_.GetNetworkCredential().Password } 
            $Domain  = New-Object System.DirectoryServices.DirectoryEntry( "$AD" , "$UN" , "$PW" ) }

        Catch     { $_.Exception.Message ; Continue } 

        If ( ! $Domain )
        {
            $a = @( Foreach ( $i in ( "Administrator" | % { "$_" , "$_`s" } | % { "( '$_' )" } ) )
            { "Windows" | % { IEX "( [ $_`Principal ][ $_`Identity ]::GetCurrent() ).IsInRole$( $i )" } } )
            If ( $a -contains "True" )    { Return 1 }
        }

        ElseIf ( $Domain.Name -ne $Null ) { Return 1 } 
        Else                              { Return 0 }
    } 

# ____                                                                            ____________________________________________________________________
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//
    Function Determine-Domain # A switch that determines workgroup or domain      ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
    {
        If ( ( GWMI Win32_ComputerSystem ).PartOfDomain -eq $True ) { $ENV:USERDOMAIN } Else { $ENV:ComputerName }
    }

# ____                                                                                                                        _________________________
#//¯¯\\______________________________________________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\
    Function Enter-ServiceAccount  # Pulls up a script login prompt                                                      \\__//¯¯\\__//¯¯\\__//  \\__//
    { 
        $GridC = 25 , 75 , 34 , 75 , 25 | % { 
                        "<ColumnDefinition Width='$_*' />"
        }
        
        $GridR = "" , "" + @( 0..3 | % { "1.5" } ) | % { 
                        "<RowDefinition Height = '$_*' />"
        }

        $XAML = @"
        <Window                      xmlns =                 "http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                   xmlns:x =                              "http://schemas.microsoft.com/winfx/2006/xaml" 
                                     Title =             "Secure Digits Plus LLC | Hybrid @ Service Account Designation" 
                                     Width =                                                                       "480" 
                                    Height =                                                                       "300" 
                       HorizontalAlignment =                                                                    "Center" 
                                ResizeMode =                                                                  "NoResize" 
                     WindowStartupLocation =                                                              "CenterScreen" 
                                   Topmost =                                                                      "True" >
            <GroupBox 
                                    Header =                                               "Enter Username and Password" 
                       HorizontalAlignment =                                                                    "Center" 
                         VerticalAlignment =                                                                    "Center" 
                                    Height =                                                                       "250" 
                                    Margin =                                                               "10,10,10,10" 
                                     Width =                                                                       "460" >
                <Grid 
                                    Height =                                                                       "200" >
                    <Grid.ColumnDefinitions>
                        $( $GridC )
                    </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                        $( $GridR )
                </Grid.RowDefinitions>
            <TextBlock Grid.ColumnSpan="3" Grid.Row="0" FontSize="12" HorizontalAlignment="Center" Width="350" Grid.Column="1">Enter the credentials you would like to designate to your user.</TextBlock>
            <TextBlock Grid.ColumnSpan="3" Grid.Row="1" FontSize="12" HorizontalAlignment="Center" Width="350" Grid.Column="1">A password is required, but may be changed after logging in.</TextBlock>
            <TextBlock Grid.Row="2" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,25,0" Height="20" Width="120" TextAlignment="Right" Grid.Column="1">Username:</TextBlock>
            <TextBlock Grid.Row="3" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,25,0" Height="20" Width="120" TextAlignment="Right" Grid.Column="1">Password:</TextBlock>
            <TextBlock Grid.Row="4" FontSize="12" HorizontalAlignment="Right" VerticalAlignment="Center" Height="20" Width="120" Text="Confirm:" Margin="0,0,25,0" Grid.Column="1" TextAlignment="Right"/>
            <TextBox Name="Username" Grid.Row="2" Grid.Column="2" Height="24" Width="180" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="40,0,0,0" Grid.ColumnSpan="3"></TextBox>
            <PasswordBox Name="Password" PasswordChar="*" Grid.Row="3" Grid.Column="2" Height="24" Width="180" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="40,0,0,0" Grid.ColumnSpan="3"></PasswordBox>
            <PasswordBox Name="Confirm" PasswordChar="*" Grid.Row="4" Grid.Column="2" Height="24" Width="180" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="40,0,0,0" Grid.ColumnSpan="3"></PasswordBox>
            <Button Grid.Row="5" Grid.Column="1" Name="Ok" Content="OK" Width="140" HorizontalAlignment="Right" Margin="0,15,0,0"/>
            <Button Grid.Row="5" Grid.Column="3" Name="Cancel" Content="Cancel" Width="140" HorizontalAlignment="Center" Margin="0,15,0,0"/>
        </Grid>
    </GroupBox>
</Window>
"@

        $GUI = Convert-XAMLtoWindow -Xaml $xaml -NamedElement 'Username', 'Password', 'Confirm', 'Ok', 'Cancel' -PassThru

        $GUI.Cancel.add_Click( { $GUI.DialogResult = $False } )

        $GUI.Ok.add_Click( 
        {
            $0      = "Username" , "Password" , "Confirmation" ; $1 = $0 | % { "You must enter a $_" } ; $2 = $0 | % { "$_ Error" }
            $1[2]   = $1[2].Replace( "You must enter a" , "Password Must Match the" )
            $1     += "The provided account is either incorrect or invalid. Try again, or hit cancel to exit" ; $2 += "Authentication Failure"
            $MSG    = 0..3 | % { "[ System.Windows.MessageBox ]::Show( '$( $1[$_] )' , '$( $2[$_] )' )" }

                If     ( $GUI.Username.Text -eq $Null )                                                                       { IEX $MSG[0] }
                ElseIf ( $GUI.Password.Password -eq $Null )                                                                   { IEX $MSG[1] }
                ElseIf ( ( $GUI.Password.Password -notmatch $GUI.Confirm.Password ) -or ( $GUI.Confirm.Password -eq $Null ) ) { IEX $MSG[2] }
                ElseIf ( ( [ PSCredential ]::New( $GUI.Username.Text , $GUI.Password.SecurePassword ) | Test-Creds ) -ne 1 )  { IEX $MSG[3] }
                Else { $GUI.DialogResult = $True }
        })

            $Null = $GUI.Username.Focus()

            $Output = Show-WPFWindow -GUI $GUI

            If ( $Output -eq $True ) { Return [ PSCredential ]::New( $GUI.Username.Text , $GUI.Password.SecurePassword ) }

            Else { Echo "Either the user cancelled, or the dialogue failed" }
    }

<#

 .SYNOPSIS
 Checks DCOM Applications, Access, and Launch Settings to display on the screen

 .DESCRIPTION
 For identifying any DCOM settings that may be unknown or not part of your system

 .USAGE
 Not quite done, but when finished, will display any singlestring or / piped arrays of GUIDs
 with associated Access/Launch permissions to screen

#>
    
    Display-TrueColors

    $DCCred = @( Enter-ServiceAccount )

    Function Load-HKCR
    {
        $H    = "Registry" , "HKCR" , "HKEY_CLASSES_ROOT"
        $HKCR = GDR -PSProvider $H[0] -Name $H[1] -EA 0 
        If ( $? -eq $False ) { $HKCR = ( NDR -PSProvider $H[0] -Name $H[1] -Root $H[2] ) } 
        Return "$( $HKCR ):" 
    }

    Function Get-CLSID
    {
        Param ( [ String ] $CLSID )

        "$( Load-HKCR )" , "HKLM:" | % { "$_\Software\Classes\CLSID\$CLSID" } | % { "$_" , "$_\InProcServer32" } | % { 
        
            If ( ( Test-Path $_ ) -eq $True ) 
            { 
                Return ( gp $_ )."(default)" 
            } 
            
            Else 
            { 
                Return "[!] $_ Missing/Invalid Entry" 
            } 
        }
    }

    Wrap-Action "Enabled" "CLSID Check via 'Get-CLSID -CLSID <enter>'"

# This System Identifier list is based off of Matt Pichelmayer's script located @ 
# "https://github.com/picheljitsu/Powershell/blob/master/ThreatHunting/Get-DCOMSecurity.ps1"
# I read what commands he was using, I took a much different approach after this list here.

    Function Collect-DefaultSID 
    {
        Return [ Ordered ]@{ 
    	    "S-1-0"                      = "Null Authority"
    	    "S-1-0-0"                    = "Nobody"
	        "S-1-1"                      = "World Authority"
	        "S-1-1-0"                    = "Everyone"
    	    "S-1-2"                      = "Local Authority"
	        "S-1-2-0"                    = "Local"
	        "S-1-2-1"                    = "Console Logon"
    	    "S-1-3"                      = "Creator Authority"
	        "S-1-3-0"                    = "Creator Owner"
	        "S-1-3-1"                    = "Creator Group"
    	    "S-1-3-2"                    = "Creator Owner Server"
	        "S-1-3-3"                    = "Creator Group Server"
	        "S-1-3-4 Name: Owner Rights" = "SID: S-1-3-4 Owner Rights"
    	    "S-1-4"                      = "Non-unique Authority"
	        "S-1-5"                      = "NT Authority"
	        "S-1-5-1"                    = "Dialup"
    	    "S-1-5-2"                    = "Network"
	        "S-1-5-3"                    = "Batch"
	        "S-1-5-4"                    = "Interactive"
    	    "S-1-5-5-X-Y"                = "Logon Session"
	        "S-1-5-6"                    = "Service"
	        "S-1-5-7"                    = "Anonymous"
    	    "S-1-5-8"                    = "Proxy"
	        "S-1-5-9"                    = "Enterprise Domain Controllers"
	        "S-1-5-10"                   = "Principal Self"
    	    "S-1-5-11"                   = "Authenticated Users"
	        "S-1-5-12"                   = "Restricted Code"
	        "S-1-5-13"                   = "Terminal Server Users"
    	    "S-1-5-14"                   = "Remote Interactive Logon"
	        "S-1-5-15"                   = "This Organization"
	        "S-1-5-17"                   = "This Organization"
    	    "S-1-5-18"                   = "Local System"
	        "S-1-5-19"                   = "NT Authority"
	        "S-1-5-20"                   = "NT Authority"
    	    "S-1-5-21domain-500"         = "Administrator"
	        "S-1-5-21domain-501"         = "Guest"
	        "S-1-5-21domain-502"         = "KRBTGT"
    	    "S-1-5-21domain-512"         = "Domain Admins"
	        "S-1-5-21domain-513"         = "Domain Users"
	        "S-1-5-21domain-514"         = "Domain Guests"
    	    "S-1-5-21domain-515"         = "Domain Computers"
	        "S-1-5-21domain-516"         = "Domain Controllers"
	        "S-1-5-21domain-517"         = "Cert Publishers"
    	    "S-1-5-21root domain-518"    = "Schema Admins"
	        "S-1-5-21root domain-519"    = "Enterprise Admins"
	        "S-1-5-21domain-520"         = "Group Policy Creator Owners"
    	    "S-1-5-21domain-526"         = "Key Admins"
	        "S-1-5-21domain-527"         = "Enterprise Key Admins"
	        "S-1-5-21domain-553"         = "RAS and IAS Servers"
    	    "S-1-5-32-544"               = "Administrators"
	        "S-1-5-32-545"               = "Users"
	        "S-1-5-32-546"               = "Guests"
    	    "S-1-5-32-547"               = "Power Users"
	        "S-1-5-32-548"               = "Account Operators"
	        "S-1-5-32-549"               = "Server Operators"
    	    "S-1-5-32-550"               = "Print Operators"
	        "S-1-5-32-551"               = "Backup Operators"
	        "S-1-5-32-552"               = "Replicators"
    	    "S-1-5-64-10"                = "NTLM Authentication"
	        "S-1-5-64-14"                = "SChannel Authentication"
	        "S-1-5-64-21"                = "Digest Authentication"
    	    "S-1-5-80"                   = "NT Service"
	        "S-1-5-80-0"                 = "All Services"
	        "S-1-5-83-0"                 = "NT VIRTUAL MACHINE\Virtual Machines"
    	    "S-1-16-0"                   = "Untrusted Mandatory Level"
	        "S-1-16-4096"                = "Low Mandatory Level"
	        "S-1-16-8192"                = "Medium Mandatory Level"
    	    "S-1-16-8448"                = "Medium Plus Mandatory Level"
	        "S-1-16-12288"               = "High Mandatory Level"
	        "S-1-16-16384"               = "System Mandatory Level"
    	    "S-1-16-20480"               = "Protected Process Mandatory Level"
	        "S-1-16-28672"               = "Secure Process Mandatory Level"
	        "S-1-5-32-554"               = "BUILTIN\Pre-Windows 2000 Compatible Access"
    	    "S-1-5-32-555"               = "BUILTIN\Remote Desktop Users"
	        "S-1-5-32-556"               = "BUILTIN\Network Configuration Operators"
	        "S-1-5-32-557"               = "BUILTIN\Incoming Forest Trust Builders"
    	    "S-1-5-32-558"               = "BUILTIN\Performance Monitor Users"
	        "S-1-5-32-559"               = "BUILTIN\Performance Log Users"
	        "S-1-5-32-560"               = "BUILTIN\Windows Authorization Access Group"
    	    "S-1-5-32-561"               = "BUILTIN\Terminal Server License Servers"
	        "S-1-5-32-562"               = "BUILTIN\Distributed COM Users"
	        "S-1-5- 21domain -498"       = "Enterprise Read-only Domain Controllers"
    	    "S-1-5- 21domain -521"       = "Read-only Domain Controllers"
	        "S-1-5-32-569"               = "BUILTIN\Cryptographic Operators"
	        "S-1-5-21 domain -571"       = "Allowed RODC Password Replication Group"
    	    "S-1-5- 21 domain -572"      = "Denied RODC Password Replication Group"
	        "S-1-5-32-573"               = "BUILTIN\Event Log Readers"
	        "S-1-5-32-574"               = "BUILTIN\Certificate Service DCOM Access"
    	    "S-1-5-21-domain-522"        = "Cloneable Domain Controllers"
	        "S-1-5-32-575"               = "BUILTIN\RDS Remote Access Servers"
	        "S-1-5-32-576"               = "BUILTIN\RDS Endpoint Servers"
    	    "S-1-5-32-577"               = "BUILTIN\RDS Management Servers"
	        "S-1-5-32-578"               = "BUILTIN\Hyper-V Administrators"
	        "S-1-5-32-579"               = "BUILTIN\Access Control Assistance Operators"
    	    "S-1-5-32-580"               = "BUILTIN\Remote Management Users" }
    }

    Wrap-Action "Collecting" "Default System Identifiers"

    $S = @( Collect-DefaultSID )
    $S | % { $Keys = @( $_.Keys ) ; $Values = @( $_.Values ) ; $Count = ( 0..( $_.Count - 1 ) ) }

    Function Collect-ADSID
    {
        # Start talking the proper language to AD Master/Catalogue
        $DC = $Env:UserDNSDomain.Split( '.' ) ; $DN = "DC=$( $DC -join ',DC=' )" ; $AD = "$( GDR -Name AD ):"

        # Create hash table of empty arrays to collect found objects
        $ID = @{ Catalog = @( ) ; Objects = @( ) ;    Root = [ Ordered ]@{ } ;  DN = @( ) ; 
                                     List = @( ) ; SubRoot = [ Ordered ]@{ } ; SDN = @( ) } 

        # Query AD Global Catalog Root Structure
        $ID.Catalog += gci $AD\$DN | Select Name , ObjectClass , DistinguishedName | Sort ObjectClass 

        # Filter Query List to Organize Output
        $ID.Catalog | % { If ( $_.ObjectClass -notin $ID.Objects ) { $ID.Objects += $_.ObjectClass } }

        # Create Hash Table with object classses as the keys, and save all child item DN's to that array
        ForEach ( $i in $ID.Objects ) 
        {
            $DIN = @( )
            $ID.Catalog | ? { $_.ObjectClass -eq $I } | % { $DIN += $_.DistinguishedName }
            $ID.Root.Add( $i , $DIN )
        }

        # Flatten the child item DN's for a query loop
        ForEach ( $i in 0..( $ID.Root.Count - 1 ) ) 
        { 
            If ( $ID.Root[$i].Count -gt 1 ) { ForEach ( $j in 0..( $ID.Root[$i].Count - 1 ) ) { $ID.DN += $ID.Root[$i][$j] } }
            Else { $ID.DN += $ID.Root[$i] }
        }

        # Query the flattened DN's
        $List = $ID.DN | % { gci $AD\$_ }
        $List | % { If ( $_.ObjectClass -notin $ID.List ) { $ID.List += $_.ObjectClass } }

        # SubRoot
        $ID.SubRoot = [ Ordered ]@{ }
        ForEach ( $i in $ID.List )
        {
            $DIN = @( )
            $List | ? { $_.ObjectClass -eq  "$i" } | % { $DIN += $_.DistinguishedName }
            $ID.SubRoot.Add( $i , $DIN )
        }

        # Do the same as above
        ForEach ( $i in 0..( $ID.SubRoot.Count - 1 ) ) 
        {
            If ( $ID.SubRoot[$i].Count -gt 1 ) { ForEach ( $j in 0..( $ID.SubRoot[$i].Count - 1 ) ) { $ID.SDN += $ID.SubRoot[$i][$j] } }
            Else { $ID.SDN += $ID.SubRoot[$i] }
        }

        # Capture all unique class/container items

        $Dist  = @( $ID.SDN | % { gci $AD\$_ } | Select Name , ObjectClass , DistinguishedName | Sort ObjectClass )
        $DOM   = @(   $Dist | ? { $_.ObjectClass   -eq            "Container" } ).DistinguishedName | % { gci $AD\$_ } | Select Name
        $GP    = @(   $Dist | ? { $_.ObjectClass   -eq "groupPolicyContainer" } ).DistinguishedName 
        $IPS   = @(   $Dist | ? { $_.ObjectClass -like               "ipsec*" } ).DistinguishedName
        $Group = @(   $List | ? { $_.ObjectClass   -eq                "Group" } ).DistinguishedName | % { Get-ADGroup -Identity $_ -Properties * } | Select ObjectGUID
        $User  = @(   $List | ? { $_.ObjectClass   -eq                 "User" } ).DistinguishedName | % { Get-ADUser  -Identity $_ -Properties * } | Select ObjectGUID

        # Output to a GUID Array

        $GUID  = @( )
        $GUID += $DOM   | % { "{$( $_.Name )}" }
        $GUID += $User  | % { "{$( $_.ObjectGUID )}" }
        $GUID += $Group | % { "{$( $_.ObjectGUID )}" }
            
        ForEach ( $i in $IPS , $GP ) 
        { 
            $g = [ Regex ]::Matches( $i , '{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}}' ).Value
            If ( $g -notin $GUID ) { $GUID += $G } 
        }

        Return $GUID
    }

    If ( $LoadActiveDirectory -eq 1 ) 
    { 
        IPMO ActiveDirectory
        Wrap-Action "Collecting" "Active Directory GUID List" 
        $ADSID = @( Collect-ADSID ) 
    }

    Function Collect-DCOM
    {
        $D = @( "" , "Access" , "Launch" | % { "Win32_DCOMApplication$_" } )
        1..2 | % { $D[$_] = "$( $D[$_] )AllowedSetting" }
        $Return = [ Ordered ]@{ }
        ForEach ( $i in 0..2 ) { $Return.Add( $D[$i] , @( GWMI $D[$i] ) ) }
        Return $Return
    }

    Wrap-Action "Collecting" "DCOM Application List"
    $D = @( Collect-DCOM )
       
    $GUIDList = ( $D.Win32_DCOMApplication ).AppID

    Function Query-DCOM
    {
        [ CmdLetBinding () ] Param (
            
            [ Parameter ( Position = 0 , Mandatory = $False , ValueFromPipeline = $True ) ] [ Array ] $List )
            
            Wrap-Action "Collecting" "Default System Identifiers"
            $S = @( Collect-DefaultSID )
            $S | % { $Keys = @( $_.Keys ) ; $Values = @( $_.Values ) ; $Count = ( 0..( $_.Count - 1 ) ) }

            ForEach ( $GUID in $List )
            {
                "#//¯¯\\_________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\"
                "#\\__//  GUID : $GUID  \\__//¯¯\\__//¯¯\\__//¯¯\\__//" | % {  Echo "$_" }

                $AppID  = $D.Win32_DCOMApplication  | ? { $_.AppID -like "*$GUID*" } | Select Name , AppID | Sort Name
                $Access = $D.Win32_DCOMApplicationAccessAllowedSetting | ? { $_.Element -like "*$GUID*" } | Select @{ Name = "SID" ; Expression = { ( $_.Setting.Split( '=' )[-1] ).Replace( '"' , '' ) } }
                $Launch = $D.Win32_DCOMApplicationLaunchAllowedSetting | ? { $_.Element -like "*$GUID*" } | Select @{ Name = "SID" ; Expression = { ( $_.Setting.Split( '=' )[-1] ).Replace( '"' , '' ) } }


                # - [ Output Application Information ] - #
                $Application = 
                $(  If ( $AppID.Name -eq $Null )     { "         Name : [!] Name Missing" , "" }
                    Else                             { "         Name : $( $AppID.Name )" , "" } )
                Echo $Application

                # - [ Output Access Information ] - #
                $AccessInfo = 
                $(  If ( $Access.SID -eq $Null )     { "       Access : [!] SID Missing" }
                    Else 
                    {
                        ForEach ( $i in $Count ) 
                        {
                            ForEach ( $v in $Access )
                            {
                                If ( $v.Sid -eq $Keys[$i] ) 
                                {   
                                    $w = "       Access : " ; 
                                    $x = "$( $v.SID ) "     ;
                                    $y = "." * ( 26 - $x.Length ) 
                                    $z = "$( $Values[$i] )" ; 
                                    Echo "$( $w + $x + $y + $z )"
                                }
                            }
                        }
                    } )
                Echo $AccessInfo

                # - [ Output Launch Information ] - #
                $LaunchInfo = 
                $(  If ( $Launch.SID -eq $Null )     { "       Launch : [!] SID Missing " }
                    Else 
                    {
                        ForEach ( $i in $Count ) 
                        {
                            ForEach ( $v in $Launch )
                            {
                                If ( $v.Sid -eq $Keys[$i] ) 
                                {   
                                    $w = "       Launch : " ;
                                    $x = "$( $v.SID ) " ;
                                    $y = "." * ( 26 - $x.Length )
                                    $z = "$( $Values[$i] )" ; 
                                    Echo "$( $w + $x + $y + $z )"
                                }
                            }
                        }
                    } )
                Echo $LaunchInfo , ""
            }
    }
