<#___ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____  
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯       _____________________________________________________        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯        __/¯¯\__[ Dynamically Engineered Digital Security ]__/¯¯\__         ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  _________________________ ________________ ___________________________________  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__// | Application Development | Virtualization | Network and Hardware Magistration | \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__// 
//¯¯    
\\  [ Hybrid-DSC ] @: Contains All Resources/Scripts/Modules/Functions of Hybrid-DSC 
//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____      
\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/---\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\___  
//¯¯\\___________________________________________________________________________________¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯\\ 
\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\___ __ ____ -- ____ __ ____ -- ____ __ ____ -- ____ __ ___// 
 ¯¯¯\\__[ Declares Namespaces, Loads Modules, then says peace out. ]____________________//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯¯  
     ¯¯¯¯                     ( it doesn't actually say peace out, but it could... )¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

#>      @( "AccessControl" , "Principal" | % { "Security.$_" } ; "Management.Automation" , "DirectoryServices" , "Net.NetworkInformation" ) | % { 
        
            IEX "Using Namespace System.$_"
        
        }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-HybridDSC # Module Root Path Delcaration __________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( ParameterSetName =   "Module" ) ] [ Switch ] $Module   ,
            [ Parameter ( ParameterSetName =     "Root" ) ] [ Switch ] $Root     ,
            [ Parameter ( ParameterSetName =    "Share" ) ] [ Switch ] $Share    ,
            [ Parameter ( ParameterSetName =   "Domain" ) ] [ Switch ] $Domain   ,
            [ Parameter ( ParameterSetName = "Graphics" ) ] [ Switch ] $Graphics )

        $Author = "Secure Digits Plus LLC"

        $Main   = $ENV:PSModulePath.Split( ';' ) | ? { GCI $_ -Recurse "*Hybrid-DSC*" } | % { "$_\Hybrid-DSC" }

        If ( $Module ) # Returns the default module path
        {
            $Main | % { 
            
                If ( $_ -eq $Null ) 
                { 
                    Write-Theme -Action "Exception [!]" "Hybrid-DSC Module Resources Missing"
                }
            
                If ( $_ -ne $Null )
                {
                    $Return = $Main
                }
            }
        }

        If ( ( $Root ) -or ( $Share ) ) # Returns Registry Keys / Path, will also install tools if missing
        {
            "HKLM:\Software\Policies" | % { 
            
                If ( ! ( Test-Path "$_\$Author" ) ) 
                { 
                    NI $_ -Name $Author 
                }
                
                $Tree = "$_\$Author" 
            }

            GP $Tree | % { 
            
                If ( $_ -eq $Null )
                {
                    Install-DSCRoot
                }

                $Return = @{ Root = $Tree
                             Tree = $_."Hybrid-DSC"
                             Date = $_."Installation Date" }
            }

            If ( $Root ) # Returns the root Hybrid-DSC keys
            {   
                Return $Return
            }

            If ( $Share ) # Returns a Hybrid-DSC share information from registry/installs deployment share
            {
                $Tree = $Return | % { $_.Root , "Hybrid-DSC" -join '\' }
                
                Test-Path $Tree | % { 
                
                    If ( $_ -ne $True ) 
                    {
                        Install-HybridDSC -Test
                    }
                }

                $Child = GCI $Tree |  % { $_.PSChildName }
            
                If ( $Child.Count -gt 1 )
                {
                    Write-Theme -Action "Option [~]" "Multiple Companies Found"

                    $C       = 0..( $Child.Count - 1 )
                    $Options = $C | % { "`n[$_] $( $Child[$_] )" }

                    Do
                    {
                        $Selection = Read-Host -Prompt @( "Select # of Company" ; $Options )
                        
                        If ( $Selection -notin $C ) { Echo "Not a valid option" }
                        If ( $Selection    -in $C ) { $Child = $Child[$Selection] }
                    }

                    Until ( $Child.Count -eq 1 )
                }
   
                $Provision = GCI "$Tree\$Child" | % { $_.PSChildName }
            
                If ( $Provision.Count -gt 1 )
                {
                    Write-Theme -Action "Option [~]" "Multiple Drives Found"

                    $C       = 0..( $Provision.Count - 1 )
                    $Options = $C | % { "`n[$_] $( $Provision[$_] )" }

                    Do
                    {
                        $Selection = Read-Host -Prompt @( "Select # of Drive" ; $Options )
                        
                        If ( $Selection -notin $C ) { Echo "Not a valid option" }
                        If ( $Selection    -in $C ) { $Provision = $Provision[$Selection] }
                    }

                    Until ( $Provision.Count -eq 1 )
                }

                $Path     = "$Tree\$Child\$Provision"

                $Property = GI $Path | % { $_.Property }

                $Return   = [ PSCustomObject ]@{ }

                $List     = GP $Path 

                $Property | % { $Return | Add-Member -MemberType NoteProperty -Name $_ -Value $List.$_ }

            }
        }

        If ( $Domain )
        {
            $CS = gcim Win32_ComputerSystem
            
            $Return = [ PSCustomObject ]@{ NetBIOS = "" ; Branch = "" ; Domain = "" }

            If ( $CS.PartOfDomain -eq $True )
            {
                $Return | % {     
                    $_.NetBIOS = $ENV:UserDomain
                    $_.Branch  = $ENV:USERDNSDOMAIN
                    $_.Domain  = $True
                }
            }

            If ( $CS.PartOfDomain -eq $False )
            {
                $NBT = nbtstat -n | ? { $_ -like "*REGISTERED*" } | % { 

                    [ PSCustomObject ]@{ 
                        Name   = ( $_[ 0..18] | ? { $_ -ne " " } ) -join '' 
                        ID     = ( $_[19..22] | ? { $_ -ne " " } ) -join '' 
                        Type   = ( $_[24..34] | ? { $_ -ne " " } ) -join '' 
                        Status = ( $_[35..50] | ? { $_ -ne " " } ) -join '' 
                    }
                }
            
                $NBID  = $NBT | ? { $_ -like  "*GROUP*" -and $_ -like "*<00>*" }
                If ( $NBID.Count -gt 1 ) {  $NBID =  $NBID[0] } Else { }

                $CNAME = $NBT | ? { $_ -like "*UNIQUE*" -and $_ -like "*<00>*" }
                If ( $NBID.Count -gt 1 ) { $CNAME = $CNAME[0] } Else { }
                
                $Return | % {

                    $_.NetBIOS = $NBID
                    $_.Branch  = $CNAME
                    $_.Domain  = $False 
                }
            }
        }

        If ( $Graphics )
        {
            $Items = "background.jpg" , "banner.png" , "oembg.jpg" , "icon.ico" , "oemlogo.bmp" | % { GCI $Main -Recurse "*$_*" | % { $_.FullName } }
            
            $Return = [ PSCustomObject ]@{ 

                Author     = $Author
                Title      = "$Author | Hybrid-DSC"
                Background = $Items[0]
                Banner     = $Items[1]
                Brand      = $Items[2]
                Icon       = $Items[3]
                Logo       = $Items[4]
            }
        }

        Return $Return
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}# ___                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function New-SubTable # Converts array of keys and values into an Object ___________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ][ String [] ]  $Items ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ][ String [] ] $Values )

        $Table = [ PSCustomObject ]@{ }

        If ( $Items.Count -eq $Values.Count )
        {
            If ( $Items.Count -gt 1 ) 
            { 
                $Count = 0..( $Items.Count - 1 )
                $Count | % { $Table | Add-Member -MemberType NoteProperty -Name "Item:$_" -Value @{ ID = "$( $Items[$_] )" ; Value = "$( $Values[$_] )" } }
            }
            
            If ( $Items.Count -eq 1 )
            {
                $Table | Add-Member -MemberType NoteProperty -Name "Item:0" -Value @{ ID = "$( $Items )" ; Value = "$( $Values )" } 
            }
        }
        
        If ( $Items.Count -ne $Values.Count ) 
        { 
            Throw '$Items -ne $Values' 
        }
        
        Return $Table                                                                #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function New-Table # Converts array of objects into a single object _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ][         String    ] $Title ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ][            Int    ] $Depth ,
            [ Parameter ( Position = 2 , Mandatory = $True , ValueFromPipeline = $True ) ][         String [] ] $ID    ,
            [ Parameter ( Position = 3 , Mandatory = $True , ValueFromPipeline = $True ) ][ PSCustomObject [] ] $Table )

        $Object = [ PSCustomObject ]@{ Class = $Title }
        
        If ( ( $ID.Count -ne $Depth ) -or ( $Table.Count -ne $Depth ) ) 
        { 
            Throw '$Depth -ne $ID.Count or $Table.Count' 
        }
        
        If ( $Depth -eq 1 ) 
        { 
            $Count = 1 
        } 
        
        If ( $Depth -gt 1 ) 
        { 
            $Count = 0..( $Depth - 1 ) 
        }
        
        $C         = $Null
        
        $Count     | % {

            If ( $Depth -gt 1 )
            {   
                If ( $C -ne $Null ) 
                { 
                    $C ++ 
                } 
                
                If ( $C -eq $Null ) 
                { 
                    $C = 0 
                } 
                
                $Index   = $ID[$C]
                $Section = $Table[$C] 
            }

            If ( $Depth -eq 1 )
            {   
                $C       = 0
                $Index   = $ID
                $Section = $Table 
            }

            $String = [ Ordered ]@{ }

            $NX = @( 0..9 | % { "{0:d1}" } ; 10..99 | % { "{0:d2}" } ; 100..999 | % { "{0:d3}" } ; 1000..9999 | % { "{0:d4}" } )[ $Depth ]

            $Object | Add-Member -MemberType NoteProperty -Name "ID:$C" -Value $Index

            $Keys = @( $Section | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )

            ForEach ( $S in $Keys )
            {   
                $SubTable = [ Ordered ]@{ }

                ForEach ( $K in $Keys ) 
                { 
                    $Section.$K | % { 
                    
                        $SubTable.Add( "$K" , @{ ID = $_.ID ; Value = $_.Value } ) 
                    } 
                } 
            } 

            $Object | Add-Member -MemberType NoteProperty -Name "Section:$C" -Value $SubTable
        }
        Return $Object                                                               #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Write-Theme # Even your grandmother might say "That's pretty cool."_________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] [ OutputType ( "String" ) ] Param ( 

            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 0 ) ][         Switch ]   $Action ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 1 ) ][         String ] $Function ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 2 ) ][      String [] ]    $Array ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 3 ) ][ PSCustomObject ]    $Table ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 4 ) ][         Switch ]     $Free ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][         Switch ]     $Foot ,
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 0 ) ][ String ]       $Type  ,
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 0 ) ][ String ]       $Info  ,
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 2 ) ][ String ]      $Title  ,
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 0 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 1 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 3 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 4 ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][    Int ]   $Edge = 11 ,
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 0 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 1 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 3 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 4 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][    Int ] $Center = 12 ,
            [ Parameter ( Position = 5 , ValueFromPipeline = $True , ParameterSetName = 0 ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 1 ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 3 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 4 ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][    Int ]   $Font = 15 ,
            [ Parameter ( Position = 6 , ValueFromPipeline = $True , ParameterSetName = 0 ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 1 ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 3 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 4 ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = 5 ) ][    Int ]   $Back =  0 ,
            [ Parameter ( Position = 5 , ValueFromPipeline = $True , ParameterSetName = 2 ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = 3 ) ][ String ]      $Prompt )

        Begin
        {
            $GX = $Edge , $Center , $Font , $Back , 15 , 12 , 9 , 0 , 10 ; $S = " // " , " \\ " ; $F = "/¯¯\" , "\__/" ; $PI = "($( [ Char ] 960 ))" ;
            $L  = $S[1..0] ; $R = $S ; $M = 0..3 | % { IEX "`$M$_ = 0..120 | % { @( '¯' , '_' , ' ' , '-' )[$_] * `$_ }" }
        }

        Process
        {
            If ( $Function )
            {
                $FA = $Function ; $FL = $FA.Length ; $Return = 0..4
                
                If ( $FL -le 58 ) { $Y  = " ]$( $M1[ 62 - $FL ] )__/" }
                If ( $FL -gt 58 ) { $FA = "$( $FA[ 0..58 ] -join '' )... " ; $Y  = "]__/" }
                
                ForEach ( $I in 0..4 ) 
                { 
                    $Return[$I] = [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" }
                    
                    If ( $I    -in 0 , 4 ) { $Return[$I] | % { $_.FG = 0 ; $_.BG = 3 } }
                    If ( $I -notin 0 , 4 ) { $Return[$I].BG = @( 3 ) * 13 }
                }

                $Return[0] | % { 

                    $_.ST  = "  ____  $( $M2[68] )$( "  ____  " * 5 )"
                    $_.FG  = 0
                }
                
                $Return[1] | % { 
                    
                    $_.ST  = @( " /" , $F[0] , "\$( $M1[70] )/" ; $F * 4 ; $F[0] , "\ " )
                    $_.FG  = @( 0 , 1 ) * 6 + 0
                }

                $Return[2] | % { 

                    $_.ST  = @( " \" , $F[1] , "/$( $M0[70] )\" ; @( $F[ 1 , 0 ] )  * 4 ; $F[1] , "/ " ) 
                    $_.FG  = @( 0 ; @( 1 ) * 11 ; 0 )
                }
                    
                $Return[3] | % {
                    
                    $_.ST  = @( "  ¯¯¯\" , "\__[ " , $FA , $Y ; @( $F ) * 4 ; "/¯¯¯  " )
                    $_.FG  = @( 0 , 1 , 2 ; @( 1 , 0 ) * 5 )
                }

                $Return[4] | % {
                    
                    $_.ST  = "      $( $M0[72] )$( "    ¯¯¯¯" * 4 )      "
                    $_.FG  = 0
                }
            }

            If ( $Action )
            {                
                $Return = 0..4
                
                If ( $Type.Length -gt 18 ) 
                { 
                    $T = "$( $Type[ 0..17 ] -join '' )..." 
                } 
                
                Else 
                { 
                    $T = "$( $M2[ ( 21 - $Type.Length ) ] )$Type" 
                }
                
                If ( $Info.Length -gt 66 ) 
                { 
                    $IN = "$( $Info[ 0..65 ] -join '' )..." 
                } 
                
                Else 
                { 
                    $IN = "$Info$( $M2[ ( 69 - $Info.Length ) ])"  
                }

                0..4 | % {

                    $Return[$_] = [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" }

                    If ( $_ -in 0 , 4 )
                    {
                        $Return[$_] | % { $_.FG = 0 ; $_.BG = 3 }
                    }
                    
                    If ( $_ -in 1 , 3 )
                    {
                        $Return[$_] | % { $_.FG = 0 , 1 , 0 , 1 , 0 ; $_.BG = @( 3 ) * 5 }
                    }

                    If ( $_ -eq 2 )
                    {
                        $Return[$_] | % { $_.FG = 0 , 1 , 1 , 2 , 1 , 1 , 0 ; $_.BG = @( 3 ) * 7 } 
                    }
                }

                $Return[0].ST = "  ____    $( $M1[100] )      "
                $Return[1].ST = @( " /" ; $F ; "/$( $M0[98] )\" , "\___  " )
                $Return[2].ST = @( " \" , $F[1] , "/¯¯¯ " , " $T : $In " , "___/" , $F[0] , "\ " )
                $Return[3].ST = @( "  ¯¯¯\" , "\$( $M1[98] )/" ; $F[ 0 , 1 ] ; "/ " )
                $Return[4].ST = "      $( $M0[100] )    ¯¯¯¯  "

            }

            If ( $Free )
            { 

                $FX          = [ PSCustomObject ]@{ 

                    Title    = "Beginning the fight against Technological Tyranny and Cyber Criminal Activities"
                    Sign     = "$( Get-Date -UFormat "%m/%d/%Y" | % { $_.ToCharArray() } )" , "M I C H A E L  C  C O O K  S R" -join '  |  '
                    E0       = "[=]" ; E1 = "\__/" ; E2 = "| |" ; B = ( "[=]" , "\_/" )[ 0 , 1 , 0 ] -join ''
                    ST       = @( "Dynamically Engineered Digital Security" , "Application Development - Virtualization" , "Network & Hardware Magistration" , "What America Once Stood For" | % { "[ $_ ]" } ;
                                  "$Pi A Heightened Sense Of Security $Pi" ; "H Y B R I D" , "B Y" , "S E C U R E - D I G I T S - P L U S - L L C" )
                }

                0..120 | % { IEX "`$B$_ = '_' * $_ ; `$T$_ = '¯' * $_ ; `$S$_ = ' ' * $_" }
                
                $LL0 = "\$S10" ; $LL1 = "/$S10" ; $LR0 = "$S10/" ; $LR1 = "$S10\" ; $N5 = "$( "     *" * 5 )      "
                $N6  = "  *   " * 6 ; 0..1 | % { IEX "`$F$_ = '$( $F[$_] )'" } ; 1..0 | % { IEX "`$R$_ = '$( $F[$_] )'" }
                    
                

                $Title        = $FX.Title | % { If ( $_.Length -gt 83 ) { "$( $_.Substring( 0 , 78 ) )..." } Else { $_ } } | % { "[ $_ ]" }

                $Rec          = $Title | % { 92 - $_.Length | % { $_ ; $_ % 2 ; ( $_ - ( $_ % 2 ) ) / 2 } }

                $NI           = $M1[$Rec[2]] , $M1[$Rec[1]] , $Title , $M1[$Rec[2]] -join ''
    
                $Return       = 0..38 | % { [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" } }
            
                $Return[0]    | % { 
    
                    $_.ST     = "  $B4" , $S4 , $B100 , $S6
                    $_.FG     = 0 , 0 , 0 , 0
                    $_.BG     = 3 , 3 , 3 , 3
                }
            
                $Return[1]    | % {
            
                    $_.ST     = " /" , $F0 , $F1 , "/$T98\" , "\___  "
                    $_.FG     = 0 , 1 , 0 , 1 , 0
                    $_.BG     = @( 3 ) * 5
                }

                $Return[2]    | % { 
            
                    $_.ST     = " \" , $F1 , "/¯¯¯" , "  $NI  " , "___/" , $F0 , "\ "
                    $_.FG     = 0 , 1 , 1 , 2 , 1 , 1 , 0
                    $_.BG     = @( 3 ) * 7
                }

                $Return[3]    | % {
                
                    $_.ST     = " /" , $F0 , "\$B98/" , $F0 , $F1 , "/ "
                    $_.FG     = 0 , 0 , 1 , 0 , 1 , 0
                    $_.BG     = @( 3 ) * 6
                }

                $Return[4]    | % {
                            
                    $_.ST     = " \" , "\   " , "$T100" , "    ¯¯\(  "
                    $_.FG     = 0 , 0 , 0 , 0
                    $_.BG     = @( 3 ) * 4
                }

                $Return[5]    | % { 
                            
                    $_.ST     = " /" , "/$S11" , $B88 , "$S11\" , "\ "
                    $_.FG     = 0 , 0 , 4 , 0 , 0
                    $_.BG     = @( 3 ) * 5
                }

                $Return[6]    | % {  
                            
                    $_.ST     = " \" , $LL0 , "//$T36]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     = 0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 5 , 7 , 7
                }

                $Return[7]    | % { 
                            
                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[$B48//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 5 , 7 , 7
                }

                $Return[8]    | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     = 0 , 0 , 4 , 5 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 4 , 7 , 7
                }

                $Return[9]    | % {

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[___"   , $FX.ST[0]  , "__//" , $LR1 , "\ "
                    $_.FG     = 0 , 0 , 4 , 5 , 5 , 5 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 4 , 4 , 4 , 7 , 7
                }

                $Return[10]   | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     = 0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 5 , 7 , 7 
                }

                $Return[11]   | % {

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[$B48//" , $LR1 , "\ "
                    $_.FG     = 0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 5 , 7 , 7 
                }

                $Return[12]   | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     = 0 , 0 , 4 , 5 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 4 , 7 , 7 
                }

                $Return[13]   | % { 

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[__"    , $FX.ST[1] , "__//" , $LR1 , "\ "
                    $_.FG     = 0 , 0 , 4 , 5 , 5 , 5 , 0 , 0
                    $_.BG     = 7 , 7 , 6 , 4 , 4 , 4 , 7 , 7 
                }

                $Return[14]   | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 5 , 7 , 7
                }

                $Return[15]   | % {

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[$B48//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 5 , 7 , 7 
                }

                $Return[16]   | % {

                    $_.ST     = " \" , $LL0 , "//$N5]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 4 , 7 , 7 
                }

                $Return[17]       | % {

                    $_.ST     = " /" , $LL1 , "\\$N6]" , "[$B7"   , $FX.ST[2] , "$B6//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 5 , 5 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 4 , 4 , 4 , 7 , 7 
                }

                $Return[18]   | % {

                    $_.ST     = " \" , $LL0 , "//  " , $FX.ST[3] , "   ]" , "[$T48\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 4 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 6 , 6 , 5 , 7 , 7
                }

                $Return[19]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B36]" , "[$B48//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 6 , 5 , 7 , 7
                }

                $Return[20]       | % {

                    $_.ST     = " \" , $LL0 , "//$T86\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7
                }
            
                $Return[21]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B32"  , $FX.B , "\__/" , $FX.B  , "$B32//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 4 , 7 , 7 
                }

                $Return[22]   | % {

                    $_.ST     = " \" , $LL0 , "//$T32"  , "| |$T16| |" , "$T32\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 5 , 7 , 7
                }

                $Return[23]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B32"  , "[=]" , $S2 , $FX.ST[5] , $S3 , "[=]" , "$B32//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 7 , 7 , 5 , 7 , 7 
                }

                $Return[24]   | % {

                    $_.ST     = " \" , $LL0 , "//$T32"  , "| |" , $T16 , "| |" , "$T32\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 4 , 7 , 7
                }

                $Return[25]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B17"  , ( $FX.B * 2 ) , $S6 , $FX.ST[6] , $S7 , ( $FX.B * 2 ) , "$B17//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 7 , 7 , 4 , 7 , 7 
                }
    
                $Return[26]   | % {

                    $_.ST     = " \" , $LL0 , "//$T17"  , "| |" , $T15 , $S6 , $T3 , $S7 , $T15 , "| |" , "$T17\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 8 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 5 , 7 , 7
                }

                $Return[27]   | % { 

                    $_.ST     = " /" , $LL1 , "\\$B17"  , "[=]" , $S1 , $FX.ST[7] , $S2 , "[=]" , "$B17//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 7 , 7 , 5 , 7 , 7
                }

                $Return[28]   | % {

                    $_.ST     = " \" , $LL0 , "//$T17"  , "\_/" , $S1 , $T43 , $S2 , "\_/" ,  "$T17\\" , $LR0 , "/ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 7 , 7 , 4 , 7 , 7
                }

                $Return[29]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B11"  , ( $FX.B * 3 ) , "[=]" , "\__/" , "[=]", ( $FX.B * 3 ) , "$B11//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 5 , 8 , 8 , 8 , 8 , 8 , 5 , 0 , 0
                    $_.BG     =  7 , 7 , 4 , 7 , 7 , 7 , 7 , 7 , 4 , 7 , 7
                }

                $Return[30]   | % {

                    $_.ST     = " \" , $LL0 , "//$T11"  , "[=]" , $T58 , "[=]" , "$T11\\" ,  $LR0 , "/ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 5 , 7 , 7
                }

                $Return[31]   | % {

                    $_.ST     = " /" , $LL1 , "\\$B11"  , "[=]", $S2 , $FX.Sign , $S2 , "[=]" , "$B11//" , $LR1 , "\ "
                    $_.FG     =  0 , 0 , 4 , 8 , 8 , 8 , 8 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 5 , 7 , 7 , 7 , 7 , 7 , 5 , 7 , 7
                }

                $Return[32]   | % {
                           
                    $_.ST     = " \" , "\$S11" , "$T13" , "¯¯  $T19     $T30  ¯¯" , "$T13" , "$S11/" , "/ "
                    $_.FG     =  0 , 0 , 4 , 8 , 4 , 0 , 0
                    $_.BG     =  7 , 7 , 7 , 7 , 7 , 7 , 7 
                }

                $Return[33]   | % {

                    $_.ST     = " /" , "/$S110\" , "\ "
                    $_.FG     = 0 , 0 , 0
                    $_.BG     = @( 3 ) * 3
                }

                $Return[34]   | % { 
                           
                    $_.ST     = " \" , "\___" + $S72 + @( 0..3 | % { "____" , "    " } ) + "___// "
                    $_.FG     = 0 , 0 , 0 , 0, 0, 0, 0, 0, 0 ,0 ,0 ,0, 0 , 0
                    $_.BG     = 7 , 7 , 7 , 7 , 7 ,7 ,7 ,7 ,7 ,7 ,7 , 7 , 7
                }

                $Return[35]   | % { 
                           
                    $_.ST     = " /" , $F0 , "\$B70/" + @( $F[ 0,1,0,1,0,1,0,1,0 ] ) + "\ "
                    $_.FG     = 0 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0
                    $_.BG     = 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7
                }

                $Return[36]   | % { 
                           
                    $_.ST     = " \" , $F1 , "/$T70\" + @( $F[ 1 , 0 ] ) * 4 + $F[1] , "/ "
                    $_.FG     = 0 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 5 , 0
                    $_.BG     = 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7
                }

                $Return[37]   | % {
                           
                    $_.ST     = "  ¯¯¯\" , "\__[ " , $FX.ST[4] , " ]$B26/" + $F * 4 + "/¯¯¯  "
                    $_.FG     = 0 , 5 , 2 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0 , 5 , 0
                    $_.BG     = 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 7
                }

                $Return[38]   | % {

                    $_.ST     = "      $T72$( "    ¯¯¯¯" * 4 )      "
                    $_.FG     = 0
                    $_.BG     = 7
        
                }
            }

            If ( $Foot )
            {
                $Return = 0..18 

                $SR = "Secure Digits Plus LLC" , "Hybrid | Desired State Controller" , "Dynamically Engineered Digital Security" , "| Application Development" ,
                "Virtualization" , "Network and Hardware Magistration |" , "https://www.securedigitsplus.com" , "Server-Client" , "Seedling-Spawning Script" ,
                "[ Provisional Author : Michael C Cook Sr. | 'The Buck Stops Here' ]";
                
                $Title , $Strength , $Mark = ( 0..1 ) , ( 3..5 ) , ( 6..8 ) | % { $SR[$_] -join ' | ' }

                $101 = @( $F[1] ; $F ) ; $010 = @( $F ; $F[0] ) ; $10 = @( $F[1 , 0] )

                $Math = [ PSCustomObject ]@{
                
                    FG = @{  0 = @( 1 , 0 ) * 14
                             1 = @( @( 0 , 1 ) * 13 ; 0 )
                             2 = @( 0 ; @( 1 ) * 27 ; 0 )
                             3 = @( 2 , 1 ; @( 0 , 1 ) *  9 ; 2 )
                             4 = @( 2 , 1 ; @( 0 ) * 10 ; 1 , 2 )
                             5 = @( 2 , 1 , 0 , 4 , 0 , 1 , 2 )
                             6 = @( 2 , 0 , 4 , 0 , 2 )
                            13 = 2 , 0 , 0 , 0 , 2
                            14 = @( 2 ; @( 0 ) * 11 ; 2 )
                            15 = @( 2 ; @( 0 , 1 ) * 9 ; 0 , 2 )
                            16 = @( 0 , 2 , 1 , 2 ; @( 1 ) * 19 ; 2 , 1 , 2 , 0 )
                            17 = @( @( 1 , 0 ) * 13 ; 1 )
                            18 = @( 0 , 1 ) * 13  
                    }

                    BG = @{  0 = 28 
                             1 = 27
                             2 = 29
                             3 = 29
                             4 = 22
                             5 = 15
                             6 = 13
                            13 = 13
                            14 = 21 
                            15 = 29
                            16 = 27
                            17 = 27
                            18 = 26 }

                    ST = @{  0 = @( "        " ; @( "____" , " -- " ) * 12 ; "____" , "        " )
                             1 = @( "    ___/" ; @( $F ) * 12 ; $F[ 0 ] , "\___    " )
                             2 = @( "   /"     ; @( $F ) * 13 ; $F[ 0 ] , "\   " )
                             3 = @( "   \"     ; $10 * 13 ; $F[ 1 ] , "/   " )
                             4 = @( "   /"     ; $F  *  2 ; $F[ 0 ] , "\ " ; @( "  ¯¯¯¯  " ) * 8 ; " /" ; $F * 2 ; $F[0] , "\   " )
                             5 = @( "   \"     ; $10 *  2 ; $F[ 1 ] , "/ " , " [ $Title ] " , " \" , $F[1] ; $F * 2 ; "/   " )
                             6 = @( "   /"     ; $F * 2  ; "/¯¯¯" , "   ¯¯¯¯\__/$( $M0[47] )\__/¯¯¯   " , "¯¯¯\" ; $10 * 2 ; "\   " )
                             7 = @( "   \"     ; $101 ; "/¯¯¯" , "         __/¯¯\ ([ $( $SR[2] ) ]) /¯¯\__        " , "¯¯¯\" ; $101 ; "/   " )
                             8 = @( "   /"     ; $010 ; "\" , "  $( $M1[9] )/¯¯\__/$( $M1[9] ) $( $M1[16] ) $( $M1[20] )\__/¯¯\$( $M1[8] )  " , "/" ; $010 ; "\   " )
                             9 = @( "   \"     ; $101 ; "/" , " $Strength " , "\" ; $101 ; "/   " )
                            10 = @( "   /"     ; $010 ; "\" , "  $( $M0[25] ) $( $M0[16] ) $( $M0[35] )  " , "/" ; $010 ; "\   " )
                            11 = @( "   \"     ; $101 ; "/" , "   $Mark    " , "\" ; $101 ; "/   " )
                            12 = @( "   /"     ; $010 ; "\___" , "$( $M0[32] )   $( $M0[13] )   $( $M0[24] ) " , "___/" ; $010 ; "\   " )
                            13 = @( "   \"     ; $10  * 2 ; "\ " , "  $( $SR[9] )   " , " /" ; $F * 2 ; "/   " )
                            14 = @( "   /"     ; $F * 2 ; "/ " ; @( "  ____  " ) * 9 ; " \" ; $10 * 2 ; "\   " )
                            15 = @( "   \"     ; $10 * 13 ; $F[1] ,"/   " )
                            16 = @( "    ¯¯¯\" ; $10 * 12 ; $F[1] , "/¯¯¯    " )
                            17 = @( "        " , "¯¯¯\" , $F[1] ; $F * 11 ; "/¯¯¯" , "        " )
                            18 = @( "        " ; @( " -- " , "¯¯¯¯" ) * 12 ; "            " ) }
                }

                ForEach ( $I in 7..12 )
                { 
                    $Math.FG[$I] = 0 , 4 , 0
                    $Math.BG[$I] = 11
                }

                ForEach ( $I in 0..18 ) 
                {
                    $Return[$I] = [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" }

                    $Return[$I].FG = $( If ( $I -in 3, 14, 15 ) { 0 , 1 , 2 , 1 ; $Math.FG[$I] ; 1 , 2 , 1 , 0 }
                                        If ( $I -in     4..13 ) { 0 , 1 , 2 , 2 ; $Math.FG[$I] ; 2 , 2 , 1 , 0 }
                                        If ( $I -notin  3..15 ) { $Math.FG[$I] } )

                    $Return[$I].BG = @( 3 ) * $Math.BG[$I]
                    $Return[$I].ST = $Math.ST[$I]
                }
            }

            If ( $Array )
            {
                $Top                     = 5
                $Bottom                  = @( 6 , 5 )[ $Array.Count % 2 ]
                
                $Return                  = 0..( $Top + $Array.Count - 1 + $Bottom )

                $Return                  | % {
                
                    $Return[$_]          = [ PSCustomObject ]@{ 
                    
                        ST               = ""
                        FG               = ""
                        BG               = "" 
                    } 
                }

                $Title                   = $Title | % { If ( $_.Length -gt 83 ) { "$( $_.Substring( 0 , 78 ) )..." } Else { $_ } } | % { "[ $_ ]" }

                $Recurse                 = $Title | % { 92 - $_.Length | % { $_ ; $_ % 2 ; ( $_ - ( $_ % 2 ) ) / 2 } }

                $Output                  = $M1[$Recurse[2]] , $M1[$Recurse[1]] , $Title , $M1[$Recurse[2]] -join ''

                $Z                       = 0

                $Return[$Z]              | % {

                    $_.ST                = "  ____    $( $M1[100] )      "
                    $_.FG                = 0
                    $_.BG                = 3
                }

                $Z ++

                $Return[$Z]              | % {
                
                    $_.ST                = @( " /" ; $F ; "/$( $M0[98] )\" , "\___  " )
                    $_.FG                = 0 , 1 , 0 , 1 , 0
                    $_.BG                = @( 3 ) * 5
                }

                $Z ++

                $Return[$Z]              | % {

                    $_.ST                = " \" , $F[1] , "/¯¯¯  " , $Output , "  ___/" , $F[0] , "\ "
                    $_.FG                = 0 , 1 , 1 , 2 , 1 , 1 , 0
                    $_.BG                = @( 3 ) * 7
                }

                $Z ++

                $Return[$Z]              | % { 
                
                    $_.ST                = @( " //¯¯\" , "\$( $M1[98] )/" ; $F ; "/ " )
                    $_.FG                = 0 , 1 , 0 , 1 , 0
                    $_.BG                = @( 3 ) * 5
                }

                $Z ++

                $Return[$Z]              | % { 

                    $_.ST                = " \\   $( $M0[100] )    ¯¯\(  "
                    $_.FG                = 0
                    $_.BG                = 3
                }

                $Z ++

                ForEach ( $I in 0..( $Array.Count - 1 ) )
                {
                    $Line                = $Array[$I] | % { If ( $_.Length -gt 108 ) { "$( $_.Substring( 0 , 105 ) )..." } Else { $_ } }

                    $Recurse             = $Line | % { 108 - $_.Length | % { $_ ; $_ % 2 ; ( $_ - ( $_ % 2 ) ) / 2 } }

                    $Output              = $M2[$Recurse[2]] , $M2[$Recurse[1]] , $Line , $M2[$Recurse[2]] -join ''

                    $Return[$Z]          | % { 

                        $_.ST            = $L[ $Z % 2 ] , $Output , $R[ $Z % 2 ]
                        $_.FG            = 0 , 2 , 0 
                        $_.BG            = @( 3 ) * 3
                    }

                    $Z++
                }

                If ( $Z % 2 -ne 0 ) 
                { 
                    $Return[$Z]          | % {
                    
                        $_.ST            = " // " , $M2[108] , " \\ "
                        $_.FG            = @( 0 ) * 3
                        $_.BG            = @( 3 ) * 3 
                    }

                    $Z  ++ 
                }

                $Return[$Z]              | % {

                    $_.ST                = @( " \\___" ; $M2[72] ; @( "____" , "    " ) * 4 ; "___// " )
                    $_.FG                = @( 0 ) * 11
                    $_.BG                = @( 3 ) * 11
                }

                $Z  ++

                $Return[$Z]              | % { 

                    $_.ST                = @( " /" , $F[0] , "\$( $M1[70] )/" ; $F * 4 ; $F[0] , "\ " )
                    $_.FG                = @( @( 0 , 1 ) *  6 ; 0 )
                    $_.BG                = @( 3 ) * 13
                }
                
                $Z  ++

                $Return[$Z]              | % { 

                    $_.ST                = @( " \" , $F[1] , "/$( $M0[70] )\" ; @( $F[ 1 , 0 ] ) * 4 ; $F[1] , "/ " ) -join ''
                    $_.FG                = @( 0 ; @( 1 ) * 11 ; 0 )
                    $_.BG                = @( 3 ) * 13
                }

                $Z  ++

               If ( ! $Prompt ) 
               { 

                    $Return[$Z]          | % {
                        
                        $_.ST            = @( "  ¯¯¯\" , "\$( $M1[70] )/" ; $F * 4 ; "/¯¯¯  " )
                        $_.FG            = @( 0 ; @( 1 , 0 ) * 6 )
                        $_.BG            = @( 3 ) * 13
                    }

                    $Z  ++
                }

                If ( $Prompt )
                {
                    $P = $Prompt | % { 

                        If ( $_.Length -gt 63 ) { "$( $_.Substring( 0 , 59 ) )..." , " ]__/"    } 
                        Else                    { " $_ " , "]$( $M1[ ( 61 - $_.Length ) ] )__/" }
                    }

                    $Return[$Z]          | % { 

                        $_.ST            = @( "  ¯¯¯\" , "\__[ " ; $P ; $F * 4 ; "/¯¯¯  " )
                        $_.FG            = @( 0 , 1 , 2 ; @( 1 , 0 ) * 6 )
                        $_.BG            = @( 3 ) * 13
                    }

                    $Z ++
                }

                $Return[$Z] | % {

                    $_.ST = "      $( $M0[72] )$( "    ¯¯¯¯" * 4 )      "
                    $_.FG = 0
                    $_.BG = 3
                }
            }

            If ( $Table )
            {
                $C                       = 0

                $List                    = [ PSCustomObject ]@{ 
                
                      Class              = @{ Name = $Table | GM | ? { $_.Name -like   "*Class*" } | % { $_.Name } ; Items = @( ) }
                      ID                 = @{ Name = $Table | GM | ? { $_.Name -like      "*ID*" } | % { $_.Name } ; Items = @( ) }
                      Section            = @{ Name = $Table | GM | ? { $_.Name -like "*Section*" } | % { $_.Name } ; Items = @( ) } 
                }

                # Determine Count
                
                $List.Class.Name         | % { $List.Class.Items   += $Table.$_ }
                $List.ID.Name            | % { $List.ID.Items      += $Table.$_ }
                $List.Section.Name       | % { $List.Section.Items += $Table.$_ }

                $List.Class.Items        | % { $C = $C + 5 }
                $List.Section.Name       | % { $C = $C + 3 }
                $List.Section.Items.Keys | % { $C ++       }

                $C                       = $C + $( If ( $C % 2 -ne 0 ) { 5 } Else { 4 } ) # End Section
                
                $Return                  = 0..$C

                0..$C                    | % { $Return[$_] = [ PSCustomObject ]@{ ST = "" ; FG = "" ; BG = "" } }

                $Title                   = $List.Class.Items | % { If ( $_.Length -gt 83 ) { "$( $_.Substring( 0 , 78 ) )..." } Else { $_ } } | % { "[ $_ ]" }

                $Recurse                 = $Title | % { 92 - $_.Length | % { $_ ; $_ % 2 ; ( $_ - ( $_ % 2 ) ) / 2 } }

                $Output                  = $M1[$Recurse[2]] , $M1[$Recurse[1]] , $Title , $M1[$Recurse[2]] -join ''

                $Z                       = 0

                $Return[$Z]              | % { 

                    $_.ST                = "  ____    $( $M1[100] )      "
                    $_.FG                = 0
                    $_.BG                = 3
                }

                $Z ++

                $Return[$Z]              | % { 
                
                    $_.ST                = @( " /" ; $F ; "/$( $M0[98] )\" , "\___  " )
                    $_.FG                = 0 , 1 , 0 , 1 , 0
                    $_.BG                = @( 3 ) * 5
                }

                $Z ++

                $Return[$Z]              | % { 

                    $_.ST                = " \" , $F[1] , "/¯¯¯  " , $Output , "  ___/" , $F[0] , "\ "
                    $_.FG                = 0 , 1 , 1 , 2 , 1 , 1 , 0
                    $_.BG                = @( 3 ) * 7
                }

                $Z ++

                $Return[$Z]              | % { 
                
                    $_.ST                = @( " //¯¯\" , "\$( $M1[98] )/" ; $F ; "/ " )
                    $_.FG                = 0 , 1 , 0 , 1 , 0
                    $_.BG                = @( 3 ) * 5
                }

                $Z ++

                $Return[$Z]              | % { 

                    $_.ST                = " \\   $( $M0[100] )    ¯¯\(  "
                    $_.FG                = 0
                    $_.BG                = 3
                }

                $Z ++

                $Count                   = $( $List.ID.Items.Count - 1 | % { If ( $_ -gt 0 ) { 0..$_ } Else { 0 } } )

                ForEach ( $Y in $Count )
                { 
                    If ( $Count.Length -gt 1 )
                    {
                        $Index           = $List.ID.Items[$Y]
                        $Section         = $List.Section.Items[$Y]
                    }
                        
                    Else
                    {
                        $Index           = $List.ID.Items
                        $Section         = $List.Section.Items
                    }

                    $IDX                 = $( If ( $Index.Length -gt 93 ) { "$( $Index[ 0..93 ] -join '' ) ... " } Else { $Index } )

                    $Return[$Z]          | % {

                        $_.ST            = $L[ $Z % 2 ] , $M1[ 108 ] , $R[ $Z % 2 ]
                        $_.FG            = @( 0 ) * 3
                        $_.BG            = @( 3 ) * 3
                    }

                    $Z ++

                    $Return[$Z]          | % {

                        $_.ST            = $L[ $Z % 2 ] , $M3[  10 ] , $IDX , $M3[ ( 98 - $IDX.Length ) ] , $R[ $Z % 2 ]
                        $_.FG            = 0 , 1 , 2 , 1 , 0
                        $_.BG            = @( 3 ) * 5
                    }

                    $Z ++

                    $Return[$Z]          | % {

                        $_.ST            = $L[ $Z % 2 ] , $M0[ 108 ] , $R[ $Z % 2 ]
                        $_.FG            = @( 0 ) * 3
                        $_.BG            = @( 3 ) * 3
                    }

                    $Z ++
                        
                    $Keys                = @( $Section.Keys   )
                    $Values              = @( $Section.Values )

                    ForEach ( $k in 0..( $Keys.Count - 1 ) ) # Determines distance and overflow handling for all provided names and values
                    {   
                        $RV              = $Values[$K]

                        If ( $RV.ID.Length    -gt 20 ) { $ID = "$( $RV.ID[0..20] -join '' ) ..."                    }      
                        Else                           { $ID = "$( $M2[ ( 25 - $RV.ID.Length ) ] )$( $RV.ID )"      }

                        If ( $RV.Value.Length -gt 75 ) { $VA = "$( $RV.Value[ 0..75 ] -join '' ) ..."               } 
                        Else                           { $VA = "$( $RV.Value )$( $M2[ ( 80 - $RV.Value.Length ) ])" }

                        $Return[$Z]      | % {

                            $_.ST        = $L[ $Z % 2 ] , $ID , " : " , $VA , $R[ $Z % 2 ]
                            $_.FG        = 0 , 2 , 1 , 2 , 0 
                            $_.BG        = @( 3 ) * 5
                        }
                        
                        $Z ++
                    }
                }

                If ( $Z % 2 -ne 0 ) 
                { 
                    $Return[$Z]          | % {
                    
                        $_.ST            = " // " , $M2[108] , " \\ "
                        $_.FG            = @( 0 ) * 3
                        $_.BG            = @( 3 ) * 3 
                    }

                    $Z  ++ 
                }
                    
                $Return[$Z]              | % {

                    $_.ST                = @( " \\___" ; $M2[72] ; @( "____" , "    " ) * 4 ; "___// " )
                    $_.FG                = @( 0 ) * 11
                    $_.BG                = @( 3 ) * 11
                }

                $Z  ++

                $Return[$Z]              | % { 

                    $_.ST                = @( " /" , $F[0] , "\$( $M1[70] )/" ; $F * 4 ; $F[0] , "\ " )
                    $_.FG                = @( @( 0 , 1 ) *  6 ; 0 )
                    $_.BG                = @( 3 ) * 13
                }
                
                $Z  ++

                $Return[$Z]              | % { 

                    $_.ST                = @( " \" , $F[1] , "/$( $M0[70] )\" ; @( $F[ 1 , 0 ] ) * 4 ; $F[1] , "/ " )
                    $_.FG                = @( 0 ; @( 1 ) * 11 ; 0 )
                    $_.BG                = @( 3 ) * 13
                }

                $Z  ++

                If ( ! $Prompt ) 
                { 

                    $Return[$Z]          | % {
                        
                        $_.ST            = @( "  ¯¯¯\" , "\$( $M1[70] )/" ; $F * 4 ; "/¯¯¯  " )
                        $_.FG            = @( 0 ; @( 1 , 0 ) * 6 )
                        $_.BG            = @( 3 ) * 13
                    }

                    $Z  ++
                }

                If ( $Prompt )
                {
                    $P = $Prompt | % { 

                        If ( $_.Length -gt 63 ) { "$( $_.Substring( 0 , 59 ) )..." , " ]__/"    } 
                        Else                    { " $_ " , "]$( $M1[ ( 61 - $_.Length ) ] )__/" }
                    }

                    $Return[$Z]          | % { 

                        $_.ST            = @( "  ¯¯¯\" , "\__[ " ; $P ; $F * 4 ; "/¯¯¯  " )
                        $_.FG            = @( 0 , 1 , 2 ; @( 1 , 0 ) * 6 )
                        $_.BG            = @( 3 ) * 13
                    }

                    $Z ++
                }

                $Return[$Z] | % {

                    $_.ST = "      $( $M0[72] )$( "    ¯¯¯¯" * 4 )      "
                    $_.FG = 0
                    $_.BG = 3
                }
            }
        }

        End
        {
            ForEach ( $i in 0..( $Return.Count - 1 ) )
            {
                $Return[$I] | % {

                    If ( $_.ST.Count -lt 1 ) 
                    {
                        Write-Warning -Message "Value is null, or 0"    
                    }

                    If ( $_.ST.Count -eq 1 )
                    {
                        $Splat = @{ 

                            Object     =     $_.ST
                            Foreground = $GX[$_.FG]
                            Background = $GX[$_.BG]
                            NoNewLine  = $False
                        }

                        Write-Host @Splat
                    }

                    If ( $_.ST.Count -gt 1 )
                    {
                        ForEach ( $X in 0..( $_.ST.Count - 1 ) )
                        {
                            $Splat = @{ 
                                    
                                Object     =     $_.ST[$X]
                                Foreground = $GX[$_.FG[$X]]
                                Background = $GX[$_.BG[$X]]
                                NoNewLine  =        $True
                            }

                            If ( $X -eq $_.ST.Count - 1 )
                            {
                                $Splat.NoNewLine = $False
                            }

                            Write-Host @Splat
                        }
                    }
                }
            }

            If ( $Prompt )
            {
                Read-Host ( "¯" * 116 ) | % { If ( $_ -eq "" ) { $True } If ( $_ -ne "" ) { $False } }
            }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Convert-XAMLToWindow # Modified, originally by Dr. Tobias Weltner  _________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Param ( [ Parameter ( Mandatory ) ] [ String ] $XAML , [ String [] ] $NE = $Null , [ Switch ] $PassThru )

        @( "Framework" , "Core" | % { "Presentation$_" } ) + "WindowsBase" | % { Add-Type -AssemblyName $_ }
 
        $NR = [ XML.XMLReader ]::Create( [ IO.StringReader ] $XAML ) ; $OP = [ Windows.Markup.XAMLReader ]::Load( $NR )
        
        $NE | % { $OP | Add-Member -MemberType NoteProperty -Name $_ -Value $OP.FindName( $_ ) -Force }
 
        If ( $PassThru ) { $OP } Else { $Null = $GUI.Dispatcher.InvokeAsync( { $OP = $GUI.ShowDialog() ; SV -Name OP -Value $OP -Scope 1 } ).Wait() ; $OP }

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Show-WPFWindow # Modified, originally by Dr. Tobias Weltner ________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Param ( [ Parameter ( Mandatory ) ] [ Windows.Window ] $GUI )

        $OP = $Null ; $Null = $GUI.Dispatcher.InvokeAsync( { $OP = $GUI.ShowDialog() ; SV -Name OP -Value $OP -Scope 1 } ).Wait() ; $OP 
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Find-XAMLNamedElements # Returns named items in a XAML HereString __________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] [ OutputType ( "Array" ) ] Param (

            [ Parameter ( Mandatory = $True , Position = 0 , HelpMessage = "XAML Here String" ) ] [ String ] $XAML )

        $Xaml = $Xaml.Replace( '"' , "'" )
        
        $Array = $Xaml.Split( "`n" )

        $Collect = @( )

        0..( $Array.Count - 1 ) | ? { $Array[$_] -like "* Name = *" } | % {
    
            $Line = $Array[$_].Split(' ') | ? { $_.Length -ne 0 } 

            $Collect += $Line[( 0..( $Line.Count - 1 ) | ? { $Line[$_] -eq "Name" } ) + 2 ] 
        }

        $Return = 0..( $Collect.Count - 1 ) | % { 
        
            $Collect[$_].Replace( "'" , '' ) 
        }

        Return $Return                                                                #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
  Function Confirm-DomainName # Verifies that text entries are valid _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] [ OutputType ( "String" ) ] Param (

            [ Parameter ( Mandatory = $True , ParameterSetName = "0" ) ][ String ] $NetBIOS  ,
            [ Parameter ( Mandatory = $True , ParameterSetName = "1" ) ][ String ] $Domain   ,
            [ Parameter ( Mandatory = $True , ParameterSetName = "2" ) ][ String ] $SiteName )

        $C              = "abcdefghijklmnopqrstuvwxyz" , "0123456789" , ".-" , "``~!@#$%^&*()=+_[]{}\|;:'`",<>/? "
        $I              = $C -join ''

        $Alpha          = $I[ 0..25]
        $Numeric        = $I[26..35] + 0..9
        $Split          = $I[36..37]
        $Special        = $I[38..68] 
        $AN             = $I[ 0..35] + 0..9

        $Reserved       = @{ 
            
            Words       = @( "ANONYMOUS,AUTHENTICATED USER,BATCH,BUILTIN,DIALUP,DIGEST AUTH,INTERACTIVE,INTERNET,NT AUTHORITY,NT DOMAIN" ,
                             "NTLM AUTH,NULL,PROXY,REMOTE INTERACTIVE,RESTRICTED,SCHANNEL AUTH,SELF,SERVER,SERVICE,SYSTEM,TERMINAL SERVER"
                             "THIS ORGANIZATION,USERS,WORLD" ; "LOCAL" | % { $_ , "$_ SYSTEM"  } ; "NETWORK" | % { $_ , "$_ SERVICE" } ; 
                             "GROUP" , "OWNER" | % { $_ , "$_ SERVER" } | % { "CREATOR $_" } ) -join ',' | % { $_.Split( ',' ) } | Sort

            DNSHost     = "-GATEWAY" , "-GW" , "-TAC" <# RFC 952 #>

            SDDL        = "AN,AO,AU,BA,BG,BO,BU,CA,CD,CG,CO,DA,DC,DD,DG,DU,EA,ED,HI,IU,LA,LG,LS,LW,ME,MU,NO,NS,NU,PA,PO,PS,PU,RC,RD" +
                          "RE,RO,RS,RU,SA,SI,SO,SU,SY,WD" | % { $_.Split( ',' ) }
        }

        If ( $NetBIOS  ) 
        { 
            $X          = $NetBIOS

            $Y          = [ PSCustomObject ]@{ 
            
                Min     = 1
                Max     = 15
                Reserve = $Reserved.Words
                Allow   = $I[0..37]
                Deny    = $Special 
            } 
        }

        If ( $Domain ) 
        { 
            $X          = $Domain 
            
            $Y          = [ PSCustomObject ]@{ 
            
                Min     = 2
                Max     = 63
                Reserve = $Reserved.Words
                Allow   = $I[0..37]
                Deny    = $Special 
            } 
        }

        If ( $SiteName ) 
        { 
            $X          = $SiteName
            $Y          = [ PSCustomObject ]@{ 
            
                Min     = 1 
                Max     = 63
                Reserve = $Reserved.Words
                Allow   = $I[0..37]
                Deny    = $Special 
            } 
        }

        If ( $X.Length -lt $Y.Min )
        { 
            "Name is too short" 
        }

        ElseIf ( $X.Length -gt $Y.Max )
        { 
            "Name is too long"
        }

        ElseIf ( ( $X[0..$X[-1]] | ? { $_ -in $Y.Deny } ).Count -gt 0 )
        { 
            "Name has invalid characters"
        }

        Else { }

        If ( $NetBIOS )
        {
            
            
            If ( "." -in $X )
            { 
                "Period found in NetBIOS Domain Name, breaking" 
            }

            ElseIf ( $X -in $Y.Reserve )
            { 
                "Name is reserved" 
            }

            Else { $X }
        }
            
        If ( ( $X[0] -notin $AN ) -or ( $X[-1] -notin $AN ) -eq $True )  
        { 
            "First & Last Character must be Alpha-Numeric" 
        }

        If ( $Domain )
        {
            If ( ( $X.Length -eq 2 ) -and ( $X -in $Reserved.SDDL ) )
            { 
                "Name is reserved" 
            }

            ElseIf ( $X.Split('.').Count -lt 2 )
            {
                "Not a valid domain name, single label domain names are disabled"
            }

            ElseIf ( ( $X.Split('.')[-1].ToCharArray() | ? { $_ -in $Alpha } ).Count -eq 0 )
            {
                "Top Level Domain must contain a non-numeric."   
            }

            Else { $X }
        }
            
        If ( $SiteName )
        {
            $X
        }                                                                             #____    ____    ____    ____    ____    ____    ____    ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DSCFeatureList # Collects all server features that pertain to DSC _______//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( [ Parameter ( Position = 0 ) ] [ Switch ] $Underscore )
                        
        $Echo = @( "AD-Domain-Services" , "DHCP" , "DNS" , "GPMC" ; @( "" ; "-AdminCenter" , "-PowerShell" , "-Tools" | % { "-AD$_" } ; 
                   "" , "-Tools" | % { "-ADDS$_" } ; "-DHCP" , "-DNS-Server" , "-Role-Tools" ) | % { "RSAT$_" } ;
                   "" , "-AdminPack" , "-Deployment" , "-Transport"  | % { "WDS$_" } )

        If ( $Underscore ) 
        { 
            $Echo = $Echo.Replace( '-' , '_' ) 
        } 
        
        Return $Echo                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DSCFeatureState # Determines Installation Loadout _______________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( [ Parameter () ][ Switch ] $All )

        $Services = Get-DSCFeatureList ; $GWF = Get-WindowsFeature ; $Array = @( ) ; $Table = [ Ordered ]@{ Installed = @( ) ; Available = @( ) }

        ForEach ( $I in $Services ) { $X = $GWF | ? { $_.Name -eq $I } | % { 
            If ( $_.InstallState -ne "Installed" ) { $Array += "$I [_]" ; $Table.Available += "$I [_]" }
            If ( $_.InstallState -eq "Installed" ) { $Array += "$I [X]" ; $Table.Installed += "$I [X]" } } }

        Return $( If ( !$All ) { $Table } If ( $All ) { $Array } )                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DSCPromoTable # _________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position = 0 , ParameterSetName =      "All" ) ][ Switch ] $All        ,
            [ Parameter ( Position = 0 , ParameterSetName =  "Command" ) ][ Switch ] $Command    ,
            [ Parameter ( Position = 0 , ParameterSetName =  "Process" ) ][ Switch ] $Process    ,
            [ Parameter ( Position = 0 , ParameterSetName =     "Menu" ) ][ Switch ] $Menu       ,
            [ Parameter ( Position = 0 , ParameterSetName =     "Type" ) ][ Switch ] $DomainType ,
            [ Parameter ( Position = 0 , ParameterSetName =      "Top" ) ][ Switch ] $Mode        ,
            [ Parameter ( Position = 0 , ParameterSetName = "Services" ) ][ Switch ] $Services   ,
            [ Parameter ( Position = 0 , ParameterSetName =    "Roles" ) ][ Switch ] $Roles      ,
            [ Parameter ( Position = 0 , ParameterSetName =    "Paths" ) ][ Switch ] $Paths      ,
            [ Parameter ( Position = 0 , ParameterSetName =   "Domain" ) ][ Switch ] $Domain     )
        
        $Table = [ Ordered ]@{ 

            Command    = @( "Forest" ; "" , "" , "Controller" | % { "Domain$_" } ) | % { "Install-ADDS$_" }
            Process    = 0..3
            Menu       =     "Forest" ,       "Tree" ,       "Child" , "Clone"
            DomainType =          "-" , "TreeDomain" , "ChildDomain" ,     "-"
            Mode       = "ForestMode" , "DomainMode" , "ParentDomainName"
            Services   = Get-DSCFeatureList -Underscore
            Roles      = "InstallDNS" , "CreateDNSDelegation" , "NoGlobalCatalog" , "CriticalReplicationOnly"
            Paths      = "Database" ,  "Log" , "Sysvol" | % { "$_`Path" }
            Domain     = @( "Credential" ; "Domain" | % { $_ , "New$_" } | % { $_ , "$_`NetBIOS" } | % { "$_`Name" } ; "ReplicationSourceDC" , "SiteName" )
            Buttons    = "Start" , "Cancel" , "CredentialButton" 
        }

        $Table | % { Return $( If ( $All        ) { $_          } If ( $Command    ) { $_.Command    } If ( $Process    ) { $_.Process  }
                               If ( $Menu       ) { $_.Menu     } If ( $DomainType ) { $_.DomainType } If ( $Mode       ) { $_.Mode     }
                               If ( $Services   ) { $_.Services } If ( $Roles      ) { $_.Roles      } If ( $Paths      ) { $_.Paths    }
                               If ( $Domain     ) { $_.Domain   } ) }                #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DSCPromoSelection # ____________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] [ OutputType ( "PSCustomObject" ) ]  Param ( [ ValidateSet ( 0 , 1 , 2 , 3 ) ]
        
            [ Parameter ( Mandatory = $True , ValueFromPipeline = $True , Position = 0 ) ][            Int ] $Type = 0 ,
            [ Parameter ( Mandatory = $True , ValueFromPipeline = $True , Position = 1 ) ][ PSCustomObject ] $Control  ,
            [ Parameter ( Mandatory = $True , ValueFromPipeline = $True , Position = 2 ) ][      String [] ] $Services ,
            [ Parameter ( Mandatory = $True , ValueFromPipeline = $True , Position = 3 ) ][ Windows.Window ] $GUI      )

            $P                            = $Type
            $B                            = $False , $True
            $Code                         = $Control
            $Return                       = @( )
        # ______________________________________________________________________________ #
        # Command
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Code.Command                 = ( Get-DSCPromoTable    -Command )[$P]
        # ______________________________________________________________________________ #
        # Process
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Code.Process                 = ( Get-DSCPromoTable    -Process )[$P]
        # ______________________________________________________________________________ #
        # Menu
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        =   Get-DSCPromoTable       -Menu
            $Switch                       = @{ 0 = 1,0,0,0 ; 1 = 0,1,0,0 ; 2 = 0,0,1,0 ; 3 = 0,0,0,1 }

            $X                            = $Switch[$P]
                
                0..( $Names.Count - 1 )   | % {  
                    
                    $Y                    = $Names[$_]

                    If ( $X[$_] -eq 0 ) 
                    { 
                        $Code.$Y          = "-" 
                        $GUI.$Y           | % { $_.IsChecked  = $False }
                    }

                    If ( $X[$_] -eq 1 ) 
                    { 
                        $Code.$Y          = "Selected"
                        $GUI.$Y           | % { $_.IsChecked  = $True  }
                    }
                }
        # ______________________________________________________________________________ #
        # Domain Type
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Code.DomainType              = ( Get-DSCPromoTable -DomainType )[$P]
        # ______________________________________________________________________________ #
        # Mode
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Mode
            $Switch                       = @{ 0 = 1,1,0 ; 1 = 0,1,1 ; 2 = 0,1,1  ; 3 = 0,0,0 }
        
            $X                            = $Switch[$P]
            
                0..( $Names.Count - 1 )   | % { 

                    $Y                    = $Names[$_]

                    If ( $Y -eq $Names[2] ) 
                    { 
                        $GUI.$Y           | % { $_.Text = '' }
                    }

                    If ( $X[$_] -eq 0 )
                    { 
                        $Code.$Y          = '-' 
                        $GUI."$Y`Box"     | % { $_.Visibility = "Collapsed" }
                    }
                    
                    If ( $X[$_] -eq 1 )
                    { 
                        $Code.$Y          = '' 
                        $GUI."$Y`Box"     | % { $_.Visibility = "Visible"   }
                        $Return          += $Y
                    }
                }
        # ______________________________________________________________________________ #
        # Services
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Services
            $Switch                       = 0..16 | % { $Services[$_][-2] } | % { If ( $_ -eq "X" ) { 0 } Else { 1 } }
            
                0..( $Names.Count - 1 )   | % { 

                    $X , $Y               = $Switch[$_] , $Names[$_]

                    $GUI.$Y               | % { $_.IsEnabled = $False ; $_.IsChecked = $True }

                    If ( $X -eq 0 ) 
                    { 
                        $Code.$Y          = 'Installed' 
                    }

                    If ( $X -eq 1 ) 
                    { 
                        $Code.$Y          = 'Available'
                        $GUI.$Y           | % { $_.IsEnabled = $True }
                    }

                }
        # ______________________________________________________________________________ #
        # Roles
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Roles
            $Switch                       = @{ 0 = 1,1,0,0 ; 1 = 1,1,1,0 ; 2 = 1,1,1,0 ; 3 = 1,1,1,1 }
            $Default                      = @{ 0 = 1,0,0,0 ; 1 = 1,0,0,0 ; 2 = 1,1,0,0 ; 3 = 1,0,0,0 }
            
            $X                            = $Switch[$P]
            $Y                            = $Default[$P]

                ForEach ( $Z in 0..( $Names.Count - 1 ) )
                {
                    $Item                 = $Names[$Z]

                    If ( $X[$Z] -eq 0 ) 
                    { 
                        $Code.$Item       = '-'
                        $GUI.$Item        | % { $_.IsEnabled = $False ; $_.IsChecked = $False }
                    }

                    If ( $X[$Z] -eq 1 ) 
                    { 
                        $Code.$Item       = 1
                        $GUI.$Item        | % { $_.IsEnabled =  $True ; $_.IsChecked = $B[$Y][$Z] }
                        $Return          += $Item
                    }
                }
        # ______________________________________________________________________________ #
        # Paths
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Paths
            $Default                      = "NTDS" , "NTDS" , "SYSVOL" | % { "C:\Windows\$_" }
            
                0..( $Names.Count - 1 )   | % { 

                    $Y                    = $Names[$_]
                    $Code.$Y              = $Default[$_]
                    $GUI.$Y.Text          = $Default[$_]
                }
        # ______________________________________________________________________________ #
        # Domain
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            $Names                        = Get-DSCPromoTable -Domain
            $Switch                       = @{ 0 = 0,1,1,0,0,0,0 ; 1 = 1,0,0,1,1,0,1 ; 2 = 1,0,0,1,1,0,1 ; 3 = 1,1,0,0,0,1,1 }
            
            $X                            = $Switch[$P]

                0..( $Names.Count - 1 )   | % { 
                    
                    $Y                    = $Names[$_]
                    $GUI.$Y               | % { $_.Text = "" }

                    If ( $X[$_] -eq 0 )
                    { 
                        $Code.$Y          = '-'
                        $GUI."$Y`Box"     | % { $_.Visibility = "Collapsed" }
                    }

                    If ( $X[$_] -eq 1 ) 
                    { 
                        $Code.$Y          = ''
                        $GUI."$Y`Box"     | % { $_.Visibility =   "Visible" }
                        $Return          += $Y
                    }
                }
        # ______________________________________________________________________________ #
        # DSRM
        # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
            "Credential" | % {
                
                $GUI.$_                   | % { 
                
                    $_.IsEnabled          = $False
                    $_.Text               = "" 
                }
                
                If ( $P -ne 0 ) 
                {
                    $Code.$_              = ""
                }

                Else 
                { 
                    $Code.$_              = "N/A"
                }

                $Return                  += "SafeModeAdministratorPassword"
            
            }

            $Code.Profile                 = $Return 

            Return [ PSCustomObject ]@{ 
            
                Code                      = $Code
                Window                    = $GUI
            }                                                                        #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-DomainController # Launches Hybrid-DSCPromo _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        
        Write-Theme -Action "Searching [~]" "For Valid Domain Controllers"
        
        $Report                           = Get-NBTScan 
        $DomainController                 = $Report | ? { $_.ID -eq "<1C>" }
        $MasterBrowser                    = $Report | ? { $_.ID -eq "<1B>" }

        $ST                               = Get-DSCFeatureState -All

        Write-Theme -Action "Loading [~]" "Active Directory Configuration Utility"

        $P                                = 0
        $Promo                            = Get-XAML -HybridDSCPromo   
        $Named                            = Find-XAMLNamedElements -XAML $Promo 
        $GUI                              = Convert-XAMLToWindow   -XAML $Promo -NE $Named -PassThru
        $Code                             = [ PSCustomObject ]@{ 
        
                    Command     = "" ; Process     = "" ; Forest      = "" ; Tree        = "" ; Child       = "" ; Clone       = "" ; 
        
                    DomainType  = "" ; ForestMode  = "" ; DomainMode  = "" ; ParentDomainName               = "" ;
        
                    AD_Domain_Services             = "" ; DHCP        = "" ; DNS         = "" ; GPMC        = "" ; RSAT        = "" ; 
                    RSAT_AD_AdminCenter            = "" ; RSAT_AD_PowerShell             = "" ; RSAT_AD_Tools                  = "" ; 
                    RSAT_ADDS                      = "" ; RSAT_ADDS_Tools                = "" ; RSAT_DHCP                      = "" ; 
                    RSAT_DNS_Server                = "" ; RSAT_Role_Tools                = "" ; WDS                            = "" ; 
                    WDS_AdminPack                  = "" ; WDS_Deployment                 = "" ; WDS_Transport                  = "" ;
        
                    InstallDNS                     = "" ; CreateDNSDelegation            = "" ; 
                    NoGlobalCatalog                = "" ; CriticalReplicationOnly        = "" ;
        
                    DatabasePath                   = "" ; LogPath     = "" ; SysvolPath  = "" ;
        
                    Credential  = "" ; DomainName  = "" ; DomainNetBIOSName              = "" ; NewDomainName                  = "" ; 
                    NewDomainNetBIOSName           = "" ; SiteName                       = "" ; ReplicationSourceDC            = "" ; 
        
                    SafeModeAdministratorPassword  = "" ; Profile                        = "" }

        Get-DSCPromoSelection -Type $P -Control $Code -Services $ST -GUI $GUI | % { 
        
            $Code      = $_.Code
            $GUI       = $_.Window
            
            $GUI.Forest.IsChecked = $True

            "Tree" , "Child" , "Clone" | % { $GUI.$_.IsChecked = $False }
        }

        $GUI.Forest.Add_Click{ 

            Get-DSCPromoSelection -Type 0 -Control $Code -Services $ST -GUI $GUI | % { 
        
                $Code      = $_.Code
                $GUI       = $_.Window
            }

            $GUI.Forest.IsChecked = $True

            "Tree" , "Child" , "Clone" | % { $GUI.$_.IsChecked = $False }
        }

        $GUI.Tree.Add_Click{ 

            Get-DSCPromoSelection -Type 1 -Control $Code -Services $ST -GUI $GUI | % { 
        
                $Code      = $_.Code
                $GUI       = $_.Window
            }

            $GUI.Tree.IsChecked = $True

            "Forest" , "Child" , "Clone" | % { $GUI.$_.IsChecked = $False }
        }

        $GUI.Child.Add_Click{ 

            Get-DSCPromoSelection -Type 2 -Control $Code -Services $ST -GUI $GUI | % { 
        
                $Code      = $_.Code
                $GUI       = $_.Window
            }

            $GUI.Child.IsChecked = $True

            "Forest" , "Tree" , "Clone" | % { $GUI.$_.IsChecked = $False }
        }

        $GUI.Clone.Add_Click{ 

            Get-DSCPromoSelection -Type 3 -Control $Code -Services $ST -GUI $GUI | % { 
        
                $Code      = $_.Code
                $GUI       = $_.Window
            }

            $GUI.Clone.IsChecked = $True

            "Forest" , "Tree" , "Child" | % { $GUI.$_.IsChecked = $False }
        }

        $Service                          = Get-DSCPromoTable -Services

        0..( $Service.Count - 1 )         | % {

            IEX "`$GUI.`$( `$Service[$_] ) | ? { `$_.IsEnabled } | % { 
        
            `$_.Add_UnChecked({ `$Code.`$( `$Service[$_] ) = 0 })
              `$_.Add_Checked({ `$Code.`$( `$Service[$_] ) = 1 }) 
            }"
        }

        $GUI.CredentialButton.Add_Click({

            $Alternate           = 0

            If ( $Report -ne $Null )
            {
                $PDC                              = $Report | ? { $_.Service -eq "Domain Master Browser" }

                If ( $PDC.Count -gt 1 )
                {
                    $PDC                          = $PDC[0]
                }

                If ( $PDC -ne $Null )
                {
                    $DC                           = $PDC.Host.Split( '.' )[0]
                    $Domain                       = $PDC.Host.Replace( "$DC." , "" )
                    $NetBIOS                      = $PDC.Name
                }

                If ( $PDC -eq $Null )
                {
                    $BDC                          = $Report | ? { $_.Service -eq "Domain Controller" }

                    If ( $BDC.Count -gt 1 )
                    {
                        $BDC                      = $BDC[0]
                    }

                    If ( $BDC -ne $Null )
                    {
                        $DC                       = $BDC.Host.Split( '.' )[0]
                        $Domain                   = $BDC.Host.Replace( "$DC." , "" )
                        $NetBIOS                  = $BDC.Name
                    }
                }

                $Popup                            = Get-XAML -DCFound 
                $GUIX                             = Convert-XAMLToWindow -XAML $Popup -NE ( Find-XAMLNamedElements -XAML $Popup ) -PassThru

                $GUIX.Ok                          | % { $_.Add_Click({ $GUIX.DialogResult =  $True }) }
                $GUIX.Cancel                      | % { $_.Add_Click({ $GUIX.DialogResult = $False }) }
                $GUIX.DC                          | % { $_.Content = $DC      }
                $GUIX.Domain                      | % { $_.Content = $Domain  }
                $GUIX.NetBIOS                     | % { $_.Content = $NetBIOS }

                $Null                             = $GUIX.Ok.Focus()

                $PopupResult                      = Show-WPFWindow -GUI $GUIX

                If ( $PopupResult -eq $True )
                {
                    $DCCred                       = Invoke-Login -DC $DC -Domain $Domain
                    
                    If ( $DCCred -ne $Null )
                    {
                        $GUI.Credential           | % { $_.Text = $DCCred.UserName ; $_.IsEnabled = $False }

                        $Code.Credential          = $DCCred
                        
                        If ( ( $GUI.Forest.IsChecked ) -or ( $GUI.Child.IsChecked ) )
                        {
                            "ParentDomainName"    | % { 
                            
                                $GUI.$_.Text      = "$Domain"
                                $Code.$_          = "$Domain"
                            }

                            "DomainNetBIOSName"   | % {
                            
                                $GUI.$_.Text      = "$NetBIOS"
                                $Code.$_          = "$Domain"
                            }
                        }

                        If ( $GUI.Clone.IsChecked )
                        {
                            "DomainName"          | % {
                            
                                $GUI.$_.Text      = "$Domain"
                                $Code.$_          = "$Domain"
                            }

                            "ReplicationSourceDC" | % {
                            
                                $GUI.$_.Text      = "$DC.$Domain"
                                $Code.$_          = "$DC.$Domain"
                            }
                        }
                    }

                    If ( $DCCred -eq $Null )
                    {
                        Write-Theme -Action "Exception [!]" "Domain Credential not captured, attempting secondary login" 11 1 15
                        $Alternate = 1
                    }
                }

                Else
                {
                    Write-Theme -Action "Exception [!]" "Either the user cancelled or the dialog failed" 12 4 15
                    $Alternate            = 1
                }
            }

            If ( ( $Report -eq $Null ) -or ( $Alternate -eq 1 ) )
            {
                Write-Theme -Action "Not Detected [!]" "Found no network nodes, attempting manual configuration"

                If ( ( $GUI.Tree.IsChecked ) -or ( $GUI.Child.IsChecked ) )
                {
                    $Domain = $GUI.ParentDomainName.Text
                }
                
                If ( $GUI.Clone.IsChecked ) 
                { 
                    $Domain = $GUI.DomainName.Text 
                }

                If ( ( $Domain -eq "" ) -or ( $Domain -eq $Null ) )
                {
                    Show-Message "Error" "Domain Name is Null/Empty"
                    Break
                }

                $X = Confirm-DomainName -Domain $Domain
                
                If ( $X -ne $Domain )
                {
                    Show-Message "Error" "$X"
                    Break
                }
                
                Resolve-DNSName $Domain -Type A | % { Resolve-DNSName $_.IPAddress } | % { $DC = $_.NameHost.Replace( ".$Domain" , '' ) }

                If ( $DC -eq $Null )
                { 
                    Show-Message "Error" "Failed to detect the domain controller"
                    Return
                }

                $DCCred = Invoke-Login -DC $DC -Domain $Domain

                If ( $DCCred -ne $Null )
                {
                    IEX "Using Namespace System.DirectoryServices"

                    $AD                       = "LDAP://$( $DC )/CN=Partitions,CN=Configuration,DC=$( $Domain.Split( '.' ) -join ',DC=' )"
                        
                    $Searcher                 = [ DirectorySearcher ]::New() 

                    $Searcher                 | % {
                    
                        $_.SearchRoot         = [ DirectoryEntry ]::New( $AD , $DCCred.Username , $DCCred.GetNetworkCredential().Password )
                        $_.PageSize           = 1000
                        $_.PropertiesToLoad.Clear()
                    }

                    $EXE = $Searcher.FindAll()

                    0..( $EXE.Count - 1 )     | % { $EXE[$_].Properties } | ? { $_.netbiosname } | % { 
                        
                        $NetBIOS              = $_.netbiosname
                    }
                    
                    $GUI.Credential           | % { $_.Text = $DCCred.UserName ; $_.IsEnabled = $False }

                    $Code.Credential          = $DCCred

                    If ( ( $GUI.Forest.IsChecked ) -or ( $GUI.Child.IsChecked ) )
                    {
                        "ParentDomainName"    | % { 
                            
                            $GUI.$_.Text      = "$Domain"
                            $Code.$_          = "$Domain"
                        }

                        "DomainNetBIOSName"   | % {
                            
                            $GUI.$_.Text      = "$NetBIOS"
                            $Code.$_          = "$NetBIOS"
                        }
                    }

                    If ( $GUI.Clone.IsChecked )
                    {
                        "DomainName"          | % {
                        
                            $GUI.$_.Text      = "$Domain"
                            $Code.$_          = "$Domain"
                        }

                        "ReplicationSourceDC" | % {
                           
                            $GUI.$_.Text      = "$DC.$Domain"
                            $Code.$_          = "$DC.$Domain"
                        }
                    }
                }

                If ( $DCCred -eq $Null )
                {
                    Write-Theme -Action "Exception [!]" "Login Failed" 12 4 15 
                }
            }
        })

        $GUI.Cancel.Add_Click( { $GUI.DialogResult = $False } )

        $GUI.Start.Add_Click({

            If ( $GUI.Forest.IsChecked )
            {
                $GUI.DomainName.Text | % {

                    If ( $_ -eq "" )
                    {
                        Show-Message "Error" "Domain Name is missing"
                        Break
                    }

                    $X = Confirm-DomainName -Domain $_
                    
                    If ( $X -ne $_ )
                    {
                        Show-Message "Error" $X
                        Break
                    }

                    Else 
                    {
                        $Code.DomainName = $_
                    }
                }

                $GUI.DomainNetBIOSName.Text | % {

                    If ( $_ -eq "" )
                    {
                        Show-Message "Error" "Domain Name is missing"
                        Break
                    }

                    $X = Confirm-DomainName -NetBIOS $_
                    
                    If ( $X -ne $_ )
                    {
                        Show-Message "Error" $X
                        Break
                    }

                    Else 
                    {
                        $Code.DomainNetBIOSName = $_
                    }
                }
            }

            If ( ( $GUI.Tree.IsChecked ) -or ( $GUI.Child.IsChecked ) -or ( $GUI.Clone.IsChecked ) )
            {
                $GUI.Credential.Text       | % {
            
                    If ( $_ -eq "" )
                    { 
                        Show-Message "Error" "Credential Missing"
                        Break
                    }
                }

                $GUI.SiteName.Text | % { 
                
                    If ( $_ -eq "" )
                    {
                        Show-Message "Error" "Site Name missing"
                        Break
                    }

                    $X = Confirm-DomainName -SiteName $_
                
                    If ( $X -ne $_ )
                    {
                        Show-Message "Error" $X
                        Break
                    }

                    Else
                    {
                        $Code.SiteName = $_
                    }
                }
            }

            If ( ( $GUI.Tree.IsChecked ) -or ( $GUI.Child.IsChecked ) )
            {
                $GUI.ParentDomainName.Text | % { 

                    If ( $_ -eq "" ) 
                    { 
                        Show-Message "Error" "Parent Domain Name is missing"
                        Break
                    }
                
                    $X = Confirm-DomainName -Domain $_

                    If ( $X -ne $_ )
                    {
                        Show-Message "Error" $X
                        Break
                    } 

                    Else             
                    { 
                        $Code.ParentDomainName = $_ 
                    }
                }
            
                $GUI.NewDomainName.Text | % { 
                
                    If ( $_ -eq "" ) 
                    { 
                        Show-Message "Error" "New Domain Name is missing"
                        Break
                    }

                    If ( $_ -like "*$( $GUI.ParentDomainName.Text )*" )
                    {
                        If ( $GUI.Tree.IsChecked )
                        {
                            Show-Message "Error" "New Domain Name is too similar to Parent Domain"
                            Break
                        }
                    
                        If ( $GUI.Child.IsChecked )
                        {
                            Show-Message "Error" "Child Domain Name cannot contain Parent Domain"
                            Break
                        }
                    }
                        
                    If ( $GUI.Tree.IsChecked )
                    {
                        $X = Confirm-DomainName -Domain $_
                            
                        If ( $X -ne $_ )
                        {
                            Show-Message "Error" $X
                            Break
                        }

                        Else
                        {
                            $Code.NewDomainName = $_ 
                        }
                    }

                    If ( $GUI.Child.IsChecked )
                    {
                        $X = Confirm-DomainName -SiteName $_
                            
                        If ( $X -ne $_ )
                        {
                            Show-Message "Error" $X
                            Break
                        }

                        Else
                        {
                            $Code.NewDomainName = $_ 
                        }
                    }
                }

                $GUI.NewDomainNetBIOSName.Text | % { 
            
                    If ( $_ -eq "" ) 
                    { 
                        Show-Message "Error" "New NetBIOS Domain Name is missing"
                        Break
                    }

                    ElseIf ( ( $NetBIOS -ne $Null ) -and ( $_ -like "*$NetBIOS*" ) ) 
                    { 
                        Show-Message "Error" "New NetBIOS Domain Name is too similar to Parent"
                        Break
                    }

                    Else
                    {
                        $X = Confirm-DomainName -NetBIOS $_

                        If ( $X -ne $_ ) 
                        { 
                            Show-Message "Error" $X
                            Break
                        } 

                        Else             
                        { 
                            $Code.NewDomainNetBIOSName = $_ 
                        }
                    }
                }
            }

            If ( $GUI.Clone.IsChecked )
            {
                $GUI.DomainName.Text | % { 
                        
                    If ( $_ -eq "" )
                    {
                        Show-Message "Error" "Domain Name cannot be empty"
                        Break
                    }

                    $X = Confirm-DomainName -Domain $_
                        
                    If ( $X -ne $_ ) 
                    { 
                        Show-Message "Error" $X
                        Break
                    } 
                        
                    Else
                    { 
                        $Code.DomainName = $_ 
                    }
                }
            
                $GUI.ReplicationSourceDC.Text | % { 
            
                    If ( $_ -eq "" )
                    {
                        Show-Message "Error" "Source Domain Controller Missing"
                        Break
                    }

                    $X = Resolve-DNSName $_ -Type CName | % { $_.PrimaryServer }

                    If ( $X -ne $_ ) 
                    { 
                        Show-Message "Error" $X
                        Break
                    }

                    Else 
                    { 
                        $Code.ReplicationSourceDC  = $_ 
                    } 
                }
            }

            "Database" , "Log" , "Sysvol" | % { "$_`Path" } | % { $Code.$_ = $GUI.$_.Text }

            If ( $GUI.SafeModeAdministratorPassword.Password -eq "" )                          
            { 
                Show-Message "Error" "DSRM Key is empty"
                Break
            }

            If ( $GUI.SafeModeAdministratorPassword.Password.Length -lt 8 )
            { 
                Show-Message "Error" "Password is too short"
                Break
            }

            If ( $GUI.SafeModeAdministratorPassword.Password -notmatch $GUI.Confirm.Password )
            { 
                Show-Message "Error" "Invalid Confirmation"
                Break
            }
            
            $Code.SafeModeAdministratorPassword = $GUI.SafeModeAdministratorPassword.SecurePassword

            "ForestMode" , "DomainMode" | % { 
            
                $Code.$_ = $GUI.$_.SelectedIndex

                If ( $Code.$_ -eq 7 )
                {
                    $Code.$_ = 6
                } 
            }
                
            Get-DSCPromoTable -Roles | % {
            
                If ( $GUI.$_.IsEnabled ) 
                { 
                    $Code.$_ = $GUI.$_.IsChecked
                }
            }

            $GUI.DialogResult = $True
        })

        ( "Database" , "NTDS" ) , ( "Log" , "NTDS" ) , ( "Sysvol" , "SYSVOL" ) | % { 
        
            $GUI.$( $_[0] + "Path" ).Text = "C:\Windows\$( $_[1] )"
        }

        $Null = $GUI.SafeModeAdministratorPassword.Focus()

        $OP   = Show-WPFWindow -GUI $GUI

        If ( $OP -eq $True )
        {
            $DSCLoadout      = @( ) 
            
            Get-DSCPromoTable -Services | ? { $Code.$_ -eq "Available" -and $GUI.$_.IsChecked -eq $True } | % {
            
                $DSCLoadout += $_.Replace( '_' , '-' )
            }

            $Command         = $Code.Command

            $Provision       = [ Ordered ]@{ }

            $Code.Process    | ? { $_ -in 1..2 } | % {

                $Provision.Add( "DomainType" , ( Get-DSCPromoTable -DomainType )[$_] )
            }
            
            $Code.Profile    | % { 

                $Provision.Add( $_ , $Code.$_ )
            }

            "Database" , "Log" , "Sysvol" | % { "$_`Path" } | % { 

                $Provision.Add( $_ , $Code.$_ )
            }

            # Report/Confirmation Screen

             #_    ____________________________
             #\\__//¯¯[_______ Services ______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            If ( $DSCLoadOut.Count -ge 1 )
            {
                $Section     = 0..2
                $SubTable    = 0..2
                $Z           = 0

                $Section[$Z]  = "Service Configuration"

                $Names       = @( )
                $Values      = @( )
            
                ForEach ( $I in 0..( $DSCLoadOut.Count - 1 ) ) 
                { 
                    $Names  += "Service [$I]" 
                    $Values += $DSCloadout[$I]
                }
                
                $Subtable[$Z] = New-SubTable -Items $Names -Values $Values

                $Z ++
            }

             #_    ____________________________
             #\\__//¯¯[_______ Command _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            If ( $DSCLoadOut.Count -eq 0 )
            {
                $Section     = 0..1
                $SubTable    = 0..1
                $Z           = 0
            }

            $Section[$Z]  = "Domain Controller Promotion"
            $Subtable[$Z] = New-SubTable -Items "Command/Type" -Values $Command

            $Z ++

             #_    ____________________________
             #\\__//¯¯[______ Parameters _____]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $Section[$Z]  = "Parameters"
            $Names        = @( $Provision.Keys ) 
            $Values       = @( $Provision.Values )
            
            $Subtable[$Z] = New-SubTable -Items $Names -Values $Values

             #_    ____________________________
             #\\__//¯¯[_____ Confirmation ____]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            $Splat       = @{ 
                
                Title    = "Hybrid-DSC Promo Loadout"
                Depth    = $Section.Count
                ID       = ForEach ( $I in 0..( $Section.Count - 1 ) ) { "( $( $Section[$I] ) )" }
                Table    = ForEach ( $I in 0..( $Section.Count - 1 ) ) { $Subtable[$I] } 
            }
            
            $Table       = New-Table @Splat

            Write-Theme -Table $Table -Prompt "Press Enter to Continue, CTRL + C to Exit"

             #_    ____________________________
             #\\__//¯¯[__ Service Installer __]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            If ( $DSCLoadout.Count -gt 0 )
            {
                Write-Theme -Action "Installing [~]" "Loadout Services"

                $DSCLoadOut    | % {

                    $Splat     = @{ Name                   = $_
                                    IncludeAllSubFeature   = $True 
                                    IncludeManagementTools = $True }

                    Install-WindowsFeature @Splat
                }
            }

            IPMO ADDSDeployment -VB

             #_    ____________________________
             #\\__//¯¯[____ DCPromo Tester ___]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

            Write-Theme -Action "Testing [~]" "Promotion Parameters"

            $Promote = 0

            If ( $Command -eq "Install-ADDSForest" ) 
            { 
                $EXE = 0
                $MSG = "Test-ADDSForestInstallation"

                Test-ADDSForestInstallation @Provision
            }

            If ( $Command -eq "Install-ADDSDomain" )
            {
                $EXE = 1
                $MSG = "Test-ADDSDomainInstallation"

                Test-ADDSDomainInstallation @Provision
            }

            If ( $Command -eq "Install-ADDSDomainController" )
            {
                $EXE = 2
                $MSG = "Test-ADDSDomainControllerInstallation"

                Test-ADDSDomainControllerInstallation @Provision
            }

            If ( $? -eq $True )
            {
                Write-Theme -Action "Successful [+]" "$MSG Passed"
                $Promote = 1
            }
                
            If ( $? -eq $False )
            {
                Write-Theme -Action "Exception [!]" "$MSG Failed" 12 4 15
                Break
            }

            If ( $Promote -eq 1 )
            {
                Switch( $Host.UI.PromptForChoice( "Test Successful" , "Proceed with Domain Controller Promotion?" ,
                [ System.Management.Automation.Host.ChoiceDescription [] ]@( "&Yes" , "&No" ) , [ Int ] 1 ) )
                {
                    0   {   Write-Theme -Action "Selected [+]" "Promote to Domain Controller"

                            ( "NoRebootOnCompletion" , $False ) , ( "Force" , $True ) | % { $Provision.Add( $_[0] , $_[1] ) }

                            If ( $EXE -eq 0 )   { Install-ADDSForest @Provision }
                            If ( $EXE -eq 1 )   { Install-ADDSDomain @Provision }
                            If ( $EXE -eq 2 )   { Install-ADDSDomainController @Provision }

                            If ( $? -eq $True ) { Write-Theme -Action "Successful [+]" "Promotion Complete, Rebooting" }
                        }
                    
                    1   {   Write-Theme -Action "Selected [+]" "Do not promote to Domain Controller"   }
                }
            }
        }

        Else { Write-Theme -Action "[!] Exception" "Either the user cancelled, or the dialog failed" 12 4 15 }

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-NetworkInfo # Obtains Extensive Network Information ____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯     
        [ CmdLetBinding () ] Param (
            
            [ Parameter ( Position = 0 , ParameterSetName =    "LocalHost" ) ] [ Switch ] $LocalHost ,
            [ Parameter ( Position = 0 , ParameterSetName = "NetworkHosts" ) ] [ Switch ] $NetworkHosts )

        Get-NetRoute           | ? { $_.DestinationPrefix -eq "0.0.0.0/0" } | % { 
        
            $Interface         = $_.InterfaceIndex
            $Gateway           = $_.NextHop 
        }

        $Gateway               | ? { $_ -eq $Null } | % { 
        
            Write-Theme -Action "Exception [!]" "No gateway, set a valid gateway and try again. Aborting" 12 4 15
            Break 
        }
    
        Get-NetAdapter -InterfaceIndex $Interface | % { 
        
            $Mac               = $_.MacAddress.Replace('-','') 
        }

        Get-NetIPConfiguration | ? { $_.IPV4DefaultGateway } | % { 
        
            $DNS               = $_.NetProfile.Name | % { 
            
                If ( $_ -ne ( Confirm-DomainName -Domain $_ ) )
                {
                    Sync-DNSSuffix -Get | % { $_.Domain }
                }

                Else
                {
                    $_
                }
            }

            $IPV4              = $_.IPV4Address.IPAddress
        }

        $ARP = ARP -A          | ? { $_ -like "*$( $IPV4.Split('.')[0] )*" } | ? { $_ -notlike "*Int*" } | % { 
        
            ( $_[ 0..23]       | ? { $_ -ne " " } ) -join '' 
        }

        $Class                 = "N" , "A" , "B" ,"C" , "M" , "R" , "BR" ,"L"
        $Range                 = @( 0 ; @( 1 ) * 126 ; 7 ; @( 2 ) * 64 ; @( 3 ) * 32 ; @( 4 ) * 16 ; @( 5 ) * 15 ; 6 )

        $List                  = ForEach ( $I in 0..( $Arp.Count - 1 ) ) 
        { 
            If ( $Range[$Arp[$I].Split('.')[0]] -in 1..3 ) { $Arp[$I] }
        }

        $NWA                   = @( )
        $HL                    = @( )

        ForEach ( $I in 0..( $List.Count - 1 ) )
        {
            $NW                = ""
            $HA                = $Null
            $X                 = $List[$I].Split( '.' )
            $Y                 = $IPV4.Split( '.' )

            0..3               | % { 

                If ( $X[$_] -eq $Y[$_] ) 
                { 
                    If ( $_ -eq 0 )
                    { 
                        $NW    = $X[$_]
                    }

                    Else 
                    { 
                        $NW    = "$NW.$( $X[$_] )" 
                    }
                }

                Else 
                {
                    $HA        = $X[$_]

                    If ( $I -eq $List.Count - 1 ) 
                    { 
                        $CL    = $Y[$_]
                        $NWX   = $NW 
                    }
                }
            }

            If ( $NW -notin $NWA ) 
            { 
                $NWA          += $NW 
            }
            
            $HL               += $HA
        }

        If ( $NW -notin $NWA ) 
        { 
            $NWA              += $NWx 
        } 
        
        $HL                   += $CL
        $HostRange             = $HL | % { [ Int ]$_ } | Sort
            
        $List                 += $IPV4
            
        $Route                 = Get-NetRoute -AddressFamily IPv4 | ? { $_.DestinationPrefix -like "*$NW*" } | % { $_.DestinationPrefix }
        
        $Subnet , $CIDR        = $Route | ? { $_.Split( '/' )[0] -notin $List } | % { $_.Split( '/' ) }
            
        # Convert the information found from CIDR to Full format for autocorrective measures ( I still need to work on this for Class A/B )

        $Binary                = 0 , 1 , 2, 4 , 8 , 16 , 32 , 64 , 128

        $Div , $For            = $CIDR | % { $_ / 8 ; $_ % 8 }
        
        $NM                    = @( )

        $NM                    = @( 0..( $Div - 1 ) | % { ( $Binary[1..8] | Measure -Sum ).Sum } ; ( $Binary[0..$For] | Measure -Sum ).Sum ) -join '.'

        $NWIPC  = IPCONFIG     | ? { $_ -like "*Subnet Mask*" } | ? { $_ -like "*$NM*" } | % { $_.Split( ':' )[1].Replace( ' ' , '' ) }
                
        If ( $NWIPC -eq $NM )
        { 
            $Return            = [ PSCustomObject ]@{ 

                IPV4           = $IPV4
                Class          = "Class $( $Class[ ( $Range[ ( $NW.Split( "." )[0] )])] ) Address"
                Prefix         = $NW
                NetMask        = $NM
                CIDR           = $CIDR
                MAC            = $MAC
                DNS            = $DNS 
                Subnet         = "$NW.$( $HostRange[ 0] - 1 )"
                Start          = "$NW.$( $HostRange[ 0] )"
                End            = "$NW.$( $HostRange[-1] - 1 )"
                Echo           = "$NW.$( $HostRange[-1] )"
            }
        }

        If (    $LocalHost ) 
        { 
            Return $Return 
        }

        If ( $NetworkHosts )
        {
            0..( $HostRange.Count - 2 ) | % {
                
                Return [ PSCustomObject ]@{ 
                
                    Host       = "$NW.$( $HostRange[$_] )" 
                }

            }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Start-PingSweep  # Gets actual used network host addresses _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Write-Theme -Action "Scanning [~]" "Network Host Range"

        IEX "Using Namespace System.Net.NetworkInformation"

        Get-NetworkInfo -LocalHost      | % {

            $Range                      = ForEach ( $I in $_.Start , $_.End )
            {
                $I.Replace( $_.Prefix + '.' , "" )
            }

            $HostRange                  = ForEach ( $I in $Range[0]..$Range[1] )
            {
                 $_.Prefix + ".$I"
            }
        }

        $Stopwatch                      = [ System.Diagnostics.Stopwatch ]::StartNew()

        $Return                         = [ PSCustomObject ]@{ 
        
            Success                     = @( )
            Failure                     = @( ) 
        }

        $B                              = 97..119 + 97..105 | % { "0x$( "{0:x}" -f $_ )" }

        $O                              = New-Object PingOptions

        $Report                         = ForEach ( $I in $HostRange )
        {
            New-Object Ping             | % { $_.SendPingAsync( $I , 100 , $B , $O ) } 
        }

        $Stopwatch.Stop()

        $Report.Result                  | ? { $_.Status -eq "Success"   } | % { $Return.Success += $_.Address.ToString() }
            
        $HostRange                      | ? { $_ -notin $Return.Success } | % { $Return.Failure += $_ }

        Write-Theme -Action "Complete [+]" "$( $Stopwatch.Elapsed ) / Hosts Found : [$( $Return.Success.Count )]"

        Return $Return
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-NBTSCAN # Scans all discoverable NetBIOS Nodes _________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯     
        [ CmdLetBinding () ] Param ( 

            [ Parameter ( Position = 0 , HelpMessage = "Output the information to a table" )][ Switch ] $Table )

        $Return                         = @( )

        $IP                             = Start-PingSweep | ? { $_.Success -ne $Null } | % { $_.Success }

        $IPV4                           = Get-NetworkInfo -LocalHost | % { $_.IPV4 }

        $ID                             =  "00" , "01" , "01" , "03" , "06" , "1F" , "20" , "21" , "22" , "23" , "24" , "30" , "31" , "43" , "44" , 
                                           "45" , "46" , "4C" , "42" , "52" , "87" , "6A" , "BE" , "BF" , "03" , "00" , "1B" , "1C" , "1D" , "1E" , 
                                           "2B" , "2F" , "33" , "20" , "01" | % { "<$_>" }

        $Type                           = ( "UNIQUE" , "GROUP" )[ 0 , 0 , 1 + @( 0 ) * 22 + 1 , 0 , 1 , 0 , 1 , 0 , 1 , 1 , 1 , 1 ]

        $SVX                            = "Workstation" , "Messenger" , "Master Browser" , "Messenger" , "RAS Server" , "NetDDE" , "File Server" ,  
                                          "RAS Client" , "Interchange(MSMail Connector)" , "Store" , "Directory" , "Server" , "Client" , "Control" , 
                                          "SMS Administrators Remote Control Tool" , "Chat" , "Transfer" , "on Windows NT" , "mccaffee anti-virus" , 
                                          "on Windows NT" , "MTA" , "IMC" , "Network Monitor Agent" , "Network Monitor Application" , "Messenger" , 
                                          "Name" , "Master Browser" , "Controllers" , "Master Browser" , "Browser Service Elections" , "Server" , 
                                          "" , "" , "DCA IrmaLan Gateway Server" , "MS NetBIOS Browse"

        $Filter                         = 0,0,7,0,0,0,0,0,1,1,1,3,3,4,0,4,4,6,7,6,1,1,7,7,0,5,5,5,7,7,2,2,2,7,0

        $Item                           = @( "SVX Service" ; "Microsoft Exchange" , "Lotus Notes" , "Modem Sharing" , "SMS Clients Remote" , "Domain" , 
                                             "DEC TCPIP SVC" | % { "$_ SVX" } ; "SVX" )

        $Service                        = ForEach ( $I in 0..34 ) 
        { 
            $Item[ ( $Filter[$I] ) ].Replace( "SVX" ,"$( $SVX[$I] )" )  
        }

        $List                           = @( )
        
        ForEach ( $I in 0..34 ) 
        { 
            $List                      += [ PSCustomObject ]@{ 
            
                ID                      = $ID[$I]
                Type                    = $Type[$I]
                Service                 = $Service[$I] 
            } 
        }

        Write-Theme -Action "Initiating [~]" "NetBIOS Scanner"

        ForEach ( $I in ( 0..( $IP.Count - 1 ) ) ) 
        {
            Write-Theme -Function "Host # $( $IP[$I] )"

            $DNS = $( Resolve-DnsName -Name $IP[$I] -EA 0 | % { $_.Namehost | % { If ( $_ -ne $Null ) { $_ } Else { "*No Hostname*" } } } )

            $X                          = @( )

            If ( $IP[$I] -eq $IPV4 ) 
            { 
                NBTSTAT -n              | ? { $_ -like "*Registered*" } | % { 
                
                    If ( $_ -notin $X ) 
                    { 
                        $X             += $_ 
                    } 
                } 
            }

            If ( $IP[$I] -ne $IPV4 ) 
            { 
                NBTSTAT -A $IP[$I]      | ? { $_ -like "*Registered*" } | % { 
                
                    If ( $_ -notin $X ) 
                    { 
                        $X             += $_ 
                    } 
                } 
            }

            ForEach ( $y in 0..( $X.Count - 1 ) ) 
            { 
                If ( $X[$Y] -like "*__MSBROWSE__*" ) 
                { 
                    $X[$Y]              = "    MSBROWSE       <01>  GROUP       Registered " 
                } 
            }

            $X                          | % { 

                $Z                      = @( $_[0..18] , $_[19..23] , $_[24..32] | % { ( $_ -ne " " ) -join '' } )

                $List                   | ? { $Z[1] -eq $_.ID -and $Z[2] -eq $_.Type } | % { 
                
                    $SVC                = $_.Service 
                }

                $Return                += [ PSCustomObject ]@{ 
                
                    IP                  = $IP[$I]
                    Host                = $DNS
                    Name                = $Z[0]
                    ID                  = $Z[1]
                    Type                = $Z[2]
                    Service             = $SVC 
                }
            }
        }

        If ( !$Table ) 
        { 
            Return $Return 
        } 

        If ( $Table ) 
        { 
            Return $Return              | FT -AutoSize 
        }
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-NetworkHosts # Gets actual used network host addresses _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        
        Resolve-MacAddress | % { 

            $Code   = $_.Count
            $Index  = $_.Index
            $Vendor = $_.Vendor
        }

        Function Return-Vendor
        {
            [ CmdLetBinding () ] Param ( [ Parameter ( Position = 0 , Mandatory = $True ) ] [ String ] $MacAddress )

            $Item                       = ( $MacAddress[ 0..5 ] -join '' )

            $Count                      = 0

            $Item                       = $Item | % { [ Convert ]::ToInt64( $_ , 16 ) }

            ForEach ( $i in 1..( $Code.Count ) )
            {
                $Count                  = $Count + $Code[$I]
                
                If ( $Count -eq $Item ) 
                { 
                    Return $Vendor[ ( $Index[ $I + 1 ] ) ] 
                }
            }
        }

        Function Return-Class
        {
            [ CmdLetBinding () ] Param (

                [ Parameter ( Position = 0 , Mandatory = $True ) ] [ String ] $IPAddress )

            $Class                       = "N" , "A" , "B" ,"C" , "MC" , "R" , "BR" ,"L"
            $Range                       = @( 0 ; @( 1 ) * 126 ; 7 ; @( 2 ) * 64 ; @( 3 ) * 32 ; @( 4 ) * 16 ; @( 5 ) * 15 ; 6 )

            Return $( $Class[ ( $Range[ ( $IPAddress.Split('.')[ 0 ] ) ] ) ] | % {

                If ( $_ -in ( "A" , "B" , "C" ) ) { Return "Class $_" }
                If ( $_ -eq "MC" ) { "Multicast" }
                If ( $_ -eq "R"  ) { "Reserved"  }
                If ( $_ -eq "BR" ) { "Broadcast" }
                If ( $_ -eq "L"  ) { "Localhost" }
                If ( $_ -eq "N"  ) { "Invalid"   }
            })
        }

        $List                            = @( )

        ForEach ( $i in "dynamic" , "static" )
        { 
            $List                       += arp -a | ? { $_ -like "*$I*" }
        }

        $Parse                           = @( )

        Get-NetworkInfo -LocalHost       | % { 
        
            $Parse                      += [ PSCustomObject ]@{ 
            
                IPAddress                = $_.IPV4
                MacAddress               = $_.MAC
                LeaseType                = "localhost" 
            } 
        }

        ForEach ( $i in 0..( $List.Count - 1 ) )
        {
            $X , $Y , $Z                 = $List[$I] | % { 
            
                $_[0..23] , $_[24..40] , $_[41..55] | % { $_ -join ""  } 
            }

            $X , $Y , $Z                 = $X , $Y , $Z | % { $_.Replace( " " , '' ) } | % { $_.Replace( "-" , '' ) }

            $Parse                      += [ PSCustomObject ]@{ 
            
                IPAddress                = $X
                MacAddress               = $Y 
                LeaseType                = $Z
            }
        }

        $Reparse                         = @( )

        ForEach ( $i in 0..( $Parse.Count - 1 ) )
        {
            $Parse[$I]                   | % { 
            
                $X                       = $Parse[$I]
                $MACV                    = $( $X.MacAddress | % { 
            
                    If ( $_.StartsWith( "01005e" ) -or $_.StartsWith( "ffffff" ) )
                    { 
                        "-" 
                    }

                    Else 
                    { 
                        Return-Vendor -MacAddress ( $X.MacAddress ) 
                    } 
                })

                Return [ PSCustomObject ]@{ 

                    IPV4Address          = $_.IPAddress
                    IPV4Class            = Return-Class -IPAddress $_.IPAddress
                    MACAddress           = $_.MacAddress
                    MACVendor            = $MACV
                }
            }
       }                                                                             #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-TelemetryData # Accesses Internet API's to recover Settings ____________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
            Test-Connection 1.1.1.1 -Count 1 | ? { $_ -eq $Null } | % { 
    
                Write-Theme -Action "Exception [!]" "Not connected to the internet" 12 4 15
                Break
            }

            "SecurityProtocol"           | % { IEX "[ Net.ServicePointManager ]::$_ = [ Net.$_`Type ]::TLS12" }

            $X                           = IRM -URI "http://ipinfo.io/$( ( IWR -URI 'http://ifconfig.me/ip' | % { $_.Content } ) )"

            $Info                        = [ PSCustomObject ]@{

                ExternalIP               = $X.IP
                State                    = $X.Region
                Organization             = "Default"
                CommonName               = "Default"
                Location                 = $X.City
                Country                  = $X.Country
                ZipCode                  = $X.Postal
                TimeZone                 = "Default" 
                SiteLink                 = "Default-First-Site-Name" 
            }

            Write-Theme -Action "Collecting [+]" "Telemetry Data / Certificate Information"
        
            $Key                         = "tZqSUOHxpjLy9kyOLKspvyZmjciB0nWpxz6PMl3KQNQBNEnW5sCbTKkKBPalSOBk"

            $Y                           = IRM -URI "https://www.zipcodeapi.com/rest/$Key/info.json/$( $X.Postal )/degrees" -Method Get 

            $Info                        | % { 
            
                $_.Location              = $Y.City 
                $_.TimeZone              = $Y.TimeZone.TimeZone_Identifier
                $_.SiteLink              = "$( ( $Y.City.Split( ' ' ) | % { $_[0] } ) -join '' )-$( $X.Postal )" 
            }

            $MSG  = "Company" , "Domain" | % { "[ System.Windows.MessageBox ]::Show( 'You must enter a $_' , '$_ Error' )" }

            $GUI = Get-XAML -Certificate | % { Convert-XAMLtoWindow -Xaml $_ -NE ( Find-XAMLNamedElements $_ ) -PassThru }

            $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False })

            $GUI.Ok.Add_Click({

                If     ( $GUI.Company.Text -eq $Null )                 
                { 
                    IEX $MSG[0] 
                }

                ElseIf ( $GUI.Domain.Text  -eq $Null )
                { 
                    IEX $MSG[1] 
                }

                Else 
                { 
                    $GUI.DialogResult     = $True 
                }

            })

            $GUI.Domain                  | % { 
            
                $_.Text                  = Get-NetworkInfo -LocalHost | % { $_.DNS } | % { 
                
                    If ( $_ -ne $Null ) 
                    { 
                        $_ 
                    } 
                    
                    Else 
                    { 
                        "" 
                    } 
                } 
            }

            $Null                        = $GUI.Company.Focus()

            $OP                          = Show-WPFWindow -GUI $GUI
        
            If ( $OP -eq $True )
            { 
                Write-Theme -Action "Complete [+]" "Generating Certificate Information"

                $Info                    | % { 
                
                    $_.Organization      = $GUI.Company.Text 
                    $_.CommonName        = $GUI.Domain.Text 
                }

                Return $Info
            }

            Else 
            { 
                Write-Theme -Action "Cancelled [!]" "Abandoned Certificate Generation, using defaults" 11 12 15

                Return $Info
            }                                                                        #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-MacAddress # Obtains the MAC Address Resolution Lists ______________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        $X                               = Resolve-HybridDSC -Module

        $Return                          = [ PSCustomObject ]@{ 
        
            Count                        = ""
            Index                        = ""
            Vendor                       = "" 
        }
        
        ForEach ( $i in "Count" , "Index" , "Vendor" ) 
        {     
            $Archive                     = @{ 
            
                Path                     = "$x\Map\$I.zip"
                DestinationPath          = $X
                Force                    = $True 
            }

            Expand-Archive @Archive

            "$x\$I.txt"                  | % { 
            
                $Return.$I               = GC $_

                RI $_ 
            }
        }

        Return $Return                                                               #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Start-NetworkInfo # Collects all needed interface data _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName =     "Local" ) ] [ Switch ]     $Local ,
            [ Parameter ( ParameterSetName =       "Map" ) ] [ Switch ]       $Map ,
            [ Parameter ( ParameterSetName =   "NetBIOS" ) ] [ Switch ]   $NetBIOS , 
            [ Parameter ( ParameterSetName = "Telemetry" ) ] [ Switch ] $Telemetry ,
            [ Parameter ( ParameterSetName =       "All" ) ] [ Switch ]       $All )

        If ( $All )
        {
            $Section                     = "Network Adapter" , "Network Host IP/MAC" ,  "NetBIOS / Domain" , "Certificate / Location" | % { "$_ Information" }
            $Subtable                    = 0..3

            $Splat                       = @{ 
            
                Items                    = ""
                Values                   = "" 
            }

            <# Network Information #>

            $Network                     = Get-NetworkInfo -LocalHost

            If ( $Network -ne $Null )
            {
                $Splat.Items             = ( $Network | GM | ? MemberType -like *Note* | % { $_.Name } )[5,1,8,7,0,6,2,10,9,4,3]
                $Splat.Values            = $Splat.Items | % { $Network.$_ }

                $Subtable[0]             = New-SubTable @Splat
            }

            If ( $Network -eq $Null )
            {
                Write-Theme -Action "Exception [!]" "Network Adapter information not found" 12 4 15
                Break
            }

            <# Network Host Map #>

            $HostList                    = Get-NetworkHosts | ? { $_.IPV4Class -like "*Class*" }

            If ( $HostList -ne $Null )
            {
                $Splat.Items             = $HostList | % { $_.IPV4Address }
                $Splat.Values            = $HostList | % { $_.MACAddress  }
                 
                $Subtable[1]             = New-Subtable @Splat
            }

            If ( $HostList -eq $Null )
            {
                Write-Theme -Action "Exception [!]" "Network Adapter information not found" 12 4 15
                Break
            }

            <# NetBIOS / NBTScan #>
            
            $NBT                         = Get-NBTSCAN

            $Control                     = $NBT | % { 
            
                If ( ( $_.ID -like "*1C*" ).Count -gt 1 )
                {
                    $_                   | ? { ( $_.ID -like "*1C*" )[0] }
                }

                If ( ( $_.ID -like "*1C*" ).Count -eq 1 )
                {
                    $_                   | ? { $_.ID -like "*1C*" }
                }

                If ( ( $_.ID -like "*1C*" ).Count -eq 0 )
                {
                    $_                   | ? { $_.IP -eq $Network.IPV4 -and $_.ID -like "*00*" -and $_.Type -eq "GROUP" }
                }
            }

            If ( $Control -ne $Null )
            {
                $Splat.Items             = "IP" , "Host" , "Name" , "ID" , "Type" , "Service"
                $Splat.Values            = $Splat.Items | % { $Control.$_ }
                 
                $Subtable[2]             = New-Subtable @Splat
            }

            <# Telemetry Data #>

            $TD                          = Get-TelemetryData

            If ( $TD -ne $Null )
            {
                $Splat.Items             = ( $TD | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )[2,6,4,0,3,1,7,8,5]
                $Splat.Values            = $Splat.Items | % { $TD.$_ }

                $Subtable[3]             = New-Subtable @Splat
            }

            If ( $TD -eq $Null )
            {
                Write-Theme -Action "Exception [!]" "Certificate information not loaded" 12 4 15
                Break
            }

            <# Generate Table #>
            
            $Panel                       = @{ 
            
                Title                    = "Domain Controller Bootstrap"
                Depth                    = 4 
                ID                       = 0..3 | % { $Section[$_]  | % { "( $_ )" } }
                Table                    = 0..3 | % { $Subtable[$_] }  
            }
        
            $Table                       = New-Table @Panel

            <# Display Table #>

            Write-Theme -Table $Table -Prompt "Press Enter to Continue"

            [ PSCustomObject ]@{ 
        
                LocalHost                = $Network
                NetworkHost              = $HostList
                NetBIOS                  = $Control
                Certificate              = $TD
            }
        }

        If ( $Local ) 
        { 
            Get-NetworkInfo -LocalHost
        }

        If ( $Map  )
        {
            Get-NetworkHosts      | ? { $_.IPV4Class -like "*Class*" }
        }

        If ( $NetBIOS )
        {
            Get-NBTSCAN 
        }

        If ( $Telemetry )
        {
            $TD
        }
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-NetworkStatistics # Like if netstat by itself wasn't so lame ___________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        $OP                              = netstat -ant | ? { $_ -like "*TCP*" -or $_ -like "*UDP*" }

        $OP                              | ? { $_ -notmatch '\*' } | % { 
        
            $X                           = $_.Split( ' ' ) | ? { $_.Length -gt 0 }
            
            Return [ PSCustomObject ]@{ 
            
                Protocol                 = $X[0]
                Local                    = $X[1]
                Foreign                  = $X[2]
                LinkState                = $X[3]
                Stream                   = $X[4] 
            }
        }

        $OP                              | ? { $_    -match '\*' } | % { 
        
            $X                           = $_.Split( ' ' ) | ? { $_.Length -gt 0 }

            Return [ PSCustomObject ]@{ 
            
                Protocol                 = $X[0]
                Local                    = $X[1]
                Foreign                  = "*:*"
                LinkState                = "*:*" 
                Stream                   = "*:*" 
            }
        }
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-Server # This commandlet does stuff _____________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        $Info                            = Get-NetworkInfo -LocalHost
        $Report                          = Start-PingSweep
        $IPAddress                       = $Report.Failure | Select -First 1

        $Adapter                         = Get-NetRoute -AddressFamily IPV4 | ? { $_.DestinationPrefix -like "*$( $Info.IPV4 )/*" } | % { $_.InterfaceIndex }
        $Gateway                         = Get-NetRoute -AddressFamily IPv4 -InterfaceIndex $Adapter | ? { $_.DestinationPrefix -eq "0.0.0.0/0" } | % { $_.NextHop }
        
        $Splat                           = @{    
        
            InterfaceIndex               = $Adapter
            IPAddress                    = $IPAddress
            PrefixLength                 = $Info.CIDR
            DefaultGateway               = $Gateway
            ValidLifeTime                = [ TimeSpan ]::MaxValue
            PreferredLifeTime            = [ TimeSpan ]::MaxValue 
        }

        New-NetIpAddress @IPAddress
    
        $Splat                           = @{    
        
            InterfaceIndex               = $Adapter
            ServerAddresses              = "1.1.1.1" , "1.0.0.1" 
        }

        Set-DNSClientServerAddress @Splat
    
        0..10 | ? { ( Test-Connection -ComputerName "DSC$_" -Count 1 -EA 0 ) -eq $Null } | % { Rename-Computer "DSC$_" ; Restart-Computer }

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-PortScan # This will scan every port you tell it to _____________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( 
    
            [ ValidateNotNullOrEmpty () ] [ Parameter ( Position = 0 ) ][    Int ] $Port = 80 ,
            [ ValidateNotNullOrEmpty () ] [ Parameter ( Position = 1 ) ][ Switch ] $Return    )

        $Collection                     = Start-PingSweep
        $S                              = $Collection.Success
        $C                              = $S.Count
        $Report                         = 0..( $C - 1 )

        ForEach ( $A in 0..( $C - 1 ) )
        {
            Write-Progress -Activity "Scanning Network $( $S[$A] )" -PercentComplete ( ( $A / $C ) * 100 )

            If ( ( Test-Connection –BufferSize 32 –Count 1 –Quiet –ComputerName $S[$A] -EA 0 ) -ne $Null )
            {
                Try 
                { 
                    New-Object System.Net.Sockets.TcpClient -Args ( $S[$A] , $Port ) -EA 0 | % { 
                        
                        $Report[$A]     = [ PSCustomObject ]@{
                    
                            ID          = $A
                            IPAddress   = $S[$A]
                            Client      = $_.Client
                            Connected   = $_.Connected
                        } 
                    }
                }
                
                Catch 
                {
                    [ Void ]$_.Exception.Message
                    
                    $Report[$A]         = [ PSCustomObject ]@{ 
                    
                        ID              = $A
                        IPAddress       = $S[$A]
                        Connected       = "False" 
                    }
                }
            }
        }

        If ( $Return ) 
        { 
            Return $Report.Client       | FT -AutoSize 
        }
        
        Else 
        { 
            Return $Report 
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-XAML # XAML Glossary and Generation Engine _____________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ][ OutputType ( "String" ) ] Param ( 
        
            [ Parameter ( ParameterSetName =     "Certificate" ) ][ Switch ] $Certificate    ,
            [ Parameter ( ParameterSetName =           "Login" ) ][ Switch ] $Login          ,
            [ Parameter ( ParameterSetName =     "New Account" ) ][ Switch ] $NewAccount     ,
            [ Parameter ( ParameterSetName =  "HybridDSCPromo" ) ][ Switch ] $HybridDSCPromo ,
            [ Parameter ( ParameterSetName =         "DCFound" ) ][ Switch ] $DCFound        ,
            [ Parameter ( ParameterSetName =         "DSCRoot" ) ][ Switch ] $DSCRoot        ,
            [ Parameter ( ParameterSetName =    "ProvisionDSC" ) ][ Switch ] $ProvisionDSC   )

            $XML                        = @{ }
            $Schema                     = "http://schemas.microsoft.com/winfx/2006/xaml"
            $Author                     = "Secure Digits Plus LLC"

            $CS                         = GCIM Win32_OperatingSystem | % { $_.Caption }
            $B                          = $False , $True 
            $YZ                         = "[X]" , "[_]"

            $Glossary                   = 
            "   `$W = 'Width'             " , "   `$H = 'Height'            " , "  `$MA = 'Margin'          " , 
            "  `$MN = 'Menu'              " , " `$MNI = 'MenuItem'          " , "  `$HD = 'Header'          " , 
            "  `$GB = 'GroupBox'          " , " `$GBI = 'GroupBoxItem'      " , "  `$CB = 'ComboBox'        " , 
            " `$CBI = 'ComboBoxItem'      " , " `$CHK = 'CheckBox'          " , "  `$TB = 'TextBox'         " , 
            " `$TBL = 'TextBlock'         " , "   `$G = 'Grid'              " , "  `$RD = 'RowDefinition'   " , 
            "  `$CD = 'ColumnDefinition'  " , "  `$GC = 'Grid.Column'       " , " `$GCS = 'Grid.ColumnSpan' " , 
            "  `$GR = 'Grid.Row'          " , " `$GRS = 'Grid.RowSpan'      " , "  `$SI = 'SelectedIndex'   " , 
            "  `$LA = 'Label'             " , "  `$BU = 'Button'            " , "  `$CO = 'Content'         " , 
            "   `$Q = 'Name'              " , "  `$SE = 'Setter'            " , "  `$PR = 'Property'        " ,
            "  `$BG = 'Background'        " , "  `$RB = 'RadioButton'       " , "  `$TW = 'TextWrapping'    "
            
            $Glossary                   | % { IEX $_ }

            $GRD , $GCD                 = $RD , $CD | % { "$G.$_`s" }

            $Glossary                  += " `$GRD = '$GRD'" , " `$GCD = '$GCD'" 

            $HAL                        = "Left" ,   "Center" ,  "Right" | % { "HorizontalAlignment = '$_'" }
            
            $HCAL                       = $HAL | % { $_.Replace( 'lA' , 'lContentA' ) }

            $VAL                        =   "Top" ,   "Center" , "Bottom" | % { "VerticalAlignment = '$_'" }
            
            $VCAL                       =  $VAL | % { $_.Replace( 'lA' , 'lContentA' ) } 

            $SP                         = 0..14 | % { "    " * $_ }

            $VC , $VV                   = "Collapsed" , "Visible" | % { "Visibility = '$_'" }

            $CF ,  $OK ,  $CA           = "Confirm" , "Start" , "Cancel"
                    
            $PW , $PWB , $PWC           = "Password" | % { "$_" , "$_`Box" , "$_`Char" }

            $GFX                        = Resolve-HybridDSC -Graphics

            $Z                          = 0

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $Certificate ) # Certificate/Domain XAML                                [
        {#___________________________________________________________________________/

            $Title                      = "Certificate Info"       
                
             # ____   _________________________
             #//¯¯\\__[_______ Header ________] 
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 7 ; 10 , 9 ) | % { $SP[$_] }

                $Y      = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , "  Title = '$Author | Hybrid @ $Title'" ,  
                             "  $W = '350'" , " $H = '200'" , "Topmost = 'True' " , "   Icon = '$( $GFX.Icon )'" , "$( $HAL[1] )" , 
                             "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 3 , 9 , 9 , 9 , 6 , 4 , 5 , 6 , 6 , 5 , 5 , 6 , 7 , 7 , 6 , 6 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "<$GB" , " $HD = 'Company Information / Certificate Generation'" , "  $W = '330'" , " $H = '160'" , "  $( $VAL[0] ) >" , 
                             "<$G>" , "<$GRD>" ; "2" , "" | % { "<$RD $H = '$_*' />" } ; "</$GRD>" , "<$G $GR = '0' >" , "<$GCD>" ; 
                             "" , "2.5" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ; 0..1 | % { "<$RD $H = '*' />" } ; "</$GRD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[      User Input       ]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( @( 6 ) * 4 ) | % { $SP[$_] }

                $Y      = @( ( 0 , "Company" ) , ( 1 , "Domain" ) | % { 

                            "<$TBL $GR = '$( $_[0] )' $GC = '0' $MA = '10' TextAlignment = 'Right' >$( $_[1] ):</$TBL>" ,
                            "<$TB $Q = '$( $_[1] )' $GR = '$( $_[0] )' $GC = '1' $H = '24' $MA = '5' />" } )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[        Framing        ]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5 ; 5..7 ; 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "</$G>" , "<$G $GR = '1' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" )

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Controls ______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 6 , 6 ) | % { $SP[$_] }

                $Y      = @( ( 0 , "Ok" ) , ( 1 , "Cancel" ) | % { "<$BU $Q =  '$( $_[1] )' $CO = '$( $_[1] )' $GC = '$( $_[0] )' $MA = '10' />" } )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Header ________]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5..2 ) | % { $SP[$_] }

                $Y      = @( "</$G>" , "</$G>" , "</$GB>" , "</Window>" )

                $XML[5] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $Login -or $NewAccount ) # Login / New Account                          [
        {#___________________________________________________________________________/

            If ( $Login )
            { 
                $Title  = "AD Login"
                $Header = "Enter Directory Services Admin Account"
                $VX     = ""
            }
            
            If ( $NewAccount )
            {
                $Title  = "Account Designation"
                $Header = "Enter Username and Password"
                $VX     = $VC
            }

            $X          = @( 2 ; @( 13 ) * 7 ; 10 , 9 ) | % { $SP[$_] }

            $Y          = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , 
                             "  Title = '$Author | Hybrid @ $Title'" , "  $W = '480'" , " $H = '280'" , "Topmost = 'True' " , 
                             "   Icon = '$( $GFX.Icon )'" , "$( $HAL[1] )" , "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
                $X      = @( 3 , 9 , 9 , 9 , 6 , 4 , 5 , 6 , 6 , 5 , 5 , 6 , 7 , 7 , 6 , 6 , 7 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "<$GB" , " $HD = '$Header'" , "  $W = '450'" , " $H = '240' $MA = '5'" , "  $( $VAL[1] )>" ,
                             "<$G>" , "<$GRD>" ; "2" , "1.25" | % { "<$RD $H = '$_*' />" } ; "</$GRD>" , "<$G $GR = '0' >" ,
                             "<$GCD>" ; "" , "3" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" ; "<$GRD>" ;
                             0..2 | % { "<$RD $H = '*' />" } ; "</$GRD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_____ User Input ______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( @( 6 , 7 ) * 6 ) | % { $SP[$_] }

                $Y      = @( "<$TBL $GC = '0' $GR = '0' $MA = '10' TextAlignment = 'Right' >" , "Username:</$TBL>" ,
                             "<$TB $Q = 'Username' $GC = '1' $GR = '0' $H = '24' $MA = '5' >" , "</$TB>" ,
                             "<$TBL $GC = '0' $GR = '1' $MA = '10' TextAlignment = 'Right' >" , "Password:</$TBL>" ,
                             "<$PWB $Q = 'Password' $GC = '1' $GR = '1' $H = '24' $MA = '5' $PWC = '*' >" , "</$PWB>" ,
                             "<$TBL $GC = '0' $GR = '2' $MA = '10' TextAlignment = 'Right' >" , "Confirm:</$TBL>" ,
                             "<$PWB $Q =  'Confirm' $GC = '1' $GR = '2' $H = '24' $MA = '5' $PWC = '*' >" , "</$PWB>" )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5 ; 5..7 ; 7 , 6 , 6 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "</$G>" , "<$G $GR = '1' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" , "<$GRD>" ;
                             0..1 | % { "<$RD $H = '*'/>" } ; "</$GRD>" )

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Controls ______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 6 ; @( 6 , 7 ) * 3 ; 6..3 ) | % { $SP[$_] }

                $Y      = @( "<RadioButton $Q = 'Switch' $GR = '0' $GC = '0' $CO = 'Change' $($VAL[1]) $($HAL[1]) $VX/>" ,
                              "<$TB $Q = 'Port' $GR = '0' $GC = '1' $($VAL[1]) $($HAL[1]) $W = '120' IsEnabled = 'False' $VX>" ,
                              "389</TextBox>" , "<$BU $Q = 'Ok' $CO = 'Ok' $GC = '0' $GR = '1' $MA = '5' >" , "</$BU>" ,
                              "<$BU $Q = 'Cancel' $CO = 'Cancel' $GC = '1' $GR = '1' $MA = '5' >" , "</$BU>" , "</$G>" ,
                              "</$G>" , "</$GB>" , "</Window>" )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $HybridDSCPromo ) # Domain Controller Promotion Configuration           [
        {#___________________________________________________________________________/
             
             $Title     = "Desired State Controller Promotion"
             # ____   _________________________
             #//¯¯\\__[_______ Header ________]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 7 ; 10 , 9 ) | % { $SP[$_] }

                $Y      = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , 
                             "  Title = '$Author | Hybrid @ $Title'" , "  $W = '800'" , " $H = '800'" , "Topmost = 'True' " ,
                             "   Icon = '$( $GFX.Icon )'" , "$( $HAL[1] )" , "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Framing _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2..4 ; 4 , 3 ) | % { $SP[$_] } 

                $Y      = @( "<$G>" , "<$GRD>" ; '20' , '*' | % { "<$RD $H = '$_' />" } ; "</$GRD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[________ Menu _________]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $Menu   = 'Forest' , 'Tree' , 'Child' , 'Clone'

                $Action = "Domain" | % { "Forest" , "$_ Tree" , "$_ Child" , "$_`Controller" } | % { "Install-ADDS$_" }

                $X      = @( 3..5 ; 5 , 5 ; 5..3 ) | % { $SP[$_] }

                $Y      = @( "<$MN $GR = '0' $H = '20' >" , "<$MNI $HD = 'New' >" ;
                          0..3 | % { "<$MNI $Q = '$($Menu[$_])' $HD = '$($Action[$_])' IsCheckable = 'True' />" } ;
                          "</$MNI>" , "</$MN>" )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[______ Open Body ______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = 3 , 12 , 13 , 10 , 10 , 13 , 13 | % { $SP[$_] }

                $Y      = "<$GB" , "   $GR = '1'" , " $HD = '[ Hybrid-DSC Domain Service Configuration ]'" ,
                          "$( $HAL[1] )" , "  $( $VAL[1] )" , "  $W = '760'" , " $H = '740' >"

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Framing _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 4..7 ; 7 , 6 ; 6..8 ; 8 , 7 ) | % { $SP[$_] }

                $Y      = @( "<$G>" , "<$G $GR = '1' $MA = '10' >" , "<$GRD>" ; '' , '10' | % { "<$RD $H = '$_*' />" } ;
                          "</$GRD>" , "<$G $GR = '0' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_____ Domain Mode _____]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $LI     = @( ) ; $ED = @( "00" , "03" ; "08" , 12 | % { $_ , "$_ R2" } ; 16 , 19 )

                $R2     = $( If ( $CS -like "*R2*" ) { 1 } Else { 0 } )

                0..7    | % { $I  = $ED[$_] ; $J  = "False"
                        If ( $CS -like "*$I*" ) { If ( $R2 -eq 1 -and $_ -in    3 , 5 ) { $J = "True" }
                                                  If ( $R2 -eq 0 -and $_ -notin 3 , 5 ) { $J = "True" } }

                $LI    += "<$CBI $CO = 'Windows Server 20$I' IsSelected = '$J' />" }

                $LI[0]  = $LI[0].Replace( "2000" ,"2000 ( Default )" )

                0..1 | % {

                    $J  = ( "ForestMode" , "DomainMode" )[$_]

                    $X  = @( 7 , 8 ; @( 9 ) * 8 ; 8 , 7 ) | % { $SP[$_] }

                    $Y  = @( "<$GB $Q = '$J`Box' $HD = '$J' $GC = '$_' $MA = '5' $VC >" ,
                          "<$CB $Q = '$J' $H = '24' $SI = '0' >" ; @( $LI ) ; "</$CB>" , "</$GB>" )

                    $Z  = 0..11 | % { $X[$_] + $Y[$_] }

                    If ( $_ -eq 0 ) { $ForID = $Z } Else { $DomID = $Z } 
                }

                $ParID  = "ParentDomainName" | % {

                $X  = @( 6 , 7 , 6 ) | % { $SP[$_] } ;

                $Y  = "<$GB $Q = '$_`Box' $HD = '$($_.Replace('D',' D').Replace('N',' N'))' $GC = '0' $MA = '5' $VC >" ,
                      "<$TB $Q = '$_' Text = '&lt;Domain Name&gt;' $H = '20' $MA = '5' />" , "</$GB>"

                Return 0..2 | % { $X[$_] + $Y[$_] } }

                    $XML[5] = @( $ForID ; $DomID ; $ParID )

                    $X  = @( 6 , 6 , 7 , 8 , 8 , 7 , 7 , 8 , 8 , 7 ) | % { $SP[$_] }

                    $Y  = @( "</$G>" , "<$G $GR = '1' >" , "<$GCD>" ; '' , '2.5' | % { "<$CD $W = '$_*' />" } ;"</$GCD>" ,
                             "<$GRD>" ; '3.5' , '' | % { "<$RD $H = '$_*' />" } ; "</$GRD>" )

                    $XML[6] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[__ Services Selection _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $FT = Get-DSCFeatureList ; $FTL = Get-DSCFeatureList -Underscore

                    $SVC = 0..16 | % { "<$TBL $GC = '0' $GR = '$_' $MA = '5' TextAlignment = 'Right' >$( $FT[$_] ):</$TBL>" ,
                      "<$CHK $GC = '1' $GR = '$_' $MA = '5' $Q = '$( $FTL[$_] )' IsEnabled = 'True' IsChecked = 'False' />" }

                    $X  = @( 6..9 ; 9 , 8 , 8 ; @( 9 ) * 17 ; @( 8 ) * 35 ; 7 , 6 ) | % { $SP[$_] }

                    $Y  = @( "<$GB $HD = 'Service Options' $GR = '0' $GC = '0' $MA = '5' >" , "<$G $GR = '0' $GC = '0' >" ,
                             "<$GCD>" ; '5' , '' | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ;
                             0..16 | % { "<$RD $H =  '*' />" } ; "</$GRD>" ; @( $SVC ) ; "</$G>" , "</$GB>" )

                    $XML[7] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_ Domain Name Options _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $VA = '10 , 0 , 10 , 0' ; $BB = "BorderBrush = '{x:Null}'"

                    $VX = @( "Database" , "Sysvol" , "Log" | % { "$_`Path" } ; "Credential" ;
                          @( "Domain" | % { $_ , "New$_" } | % { $_ , "$_`NetBIOS" } ; "Site" ) | % { "$_`Name" } ;
                          "ReplicationSourceDC" )

                    $DomID  = ForEach ( $k in 0..9 )
                    {
                        $WX = $VX[$K]

                        If ( $K -eq 3 )
                        {
                            "<$GB $GR = '3' $HD = '$WX' Name = '$WX`Box' $VV $BB >" , "<$G>" , "<$GCD>" ;
                            "" , "3" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" ,
                            "<$BU $CO = '$WX' $Q = '$WX`Button' $GC = '0' />" ,
                            "<$TB $H = '20' $MA = '$VA' Name = '$WX' $GC = '1' />" , "</$G>" , "</$GB>"
                        }

                        Else
                        {
                            "<$GB $GR = '$K' $HD = '$WX`' $Q = '$WX`Box' $VV $BB >" ,
                            "<$TB $H = '20' $MA = '$VA' $Q = '$WX' />" , "</$GB>"
                        }
                    }

                    $X  = @( 6 , 7 ; @( 8 ) * 10 ; 7 ; @( 7 , 8 , 7 ) * 3 ; 7..10 ; 10 , 9 , 9 , 9 , 8 , 7 ; @( 7 , 8 , 7 ) * 6 ; 6 ) | % { $SP[$_] }

                    $Y  = @( "<$G $GR = '0' $GC = '1' $MA = '$VA' >" , "<$GRD>" ; 0..9 | % { "<$RD $H = '*' />" } ;
                             "</$GRD>" ; @( $DomID ) ; "</$G>" )

                    $XML[8] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[__ Role Designations __]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                   $RCN = "Install DNS" , "Create DNS Delegation" , "No Global Catalog" , "Critical Replication Only"
                   $RID = $RCN | % { $_.Replace( " " , "" ) }

                    $Roles = 0..3 | % { "<$TBL $GR = '$_' TextAlignment = 'Right' $MA = '5' IsEnabled = 'True' >$( $RCN[$_] ):</$TBL>" ,
                                        "<$CHK $Q = '$( $RID[$_] )' $GR = '$_' $GC = '1' $MA = '5' IsEnabled = 'True' IsChecked = 'False' />" }

                    $X  = @( 6..9 ; 9 , 9 , 9 , 8 , 8 , 9 , 9 ; @( 8 ) * 9 ; 7 , 6 ) | % { $SP[$_] }

                    $Y  = @( "<$GB $GR = '1' $HD = 'Roles' $MA = '5' >" , "<$G>" , "<$GRD>" ; 0..3 | % { "<$RD $H = '*' />" } ; 
                             "</$GRD>" , "<$GCD>" ; '5' , '' | % { "<$CD $W = '$_*' />" } ; "</$GCD>" ; @( $Roles ) ; "</$G>" , "</$GB>" ) 

                    $XML[9] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_ DSRM/Initialization _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $CF ,  $OK ,  $CA = "Confirm" , "Start" , "Cancel"
                    $PW , $PWB , $PWC = "Password" | % { "SafeModeAdministrator$_" , "$_`Box" , "$_`Char" }

                    $X  = @( 6..9 ; 9 , 8 , 8 , 9 , 9 , 8 , 8 , 9 , 8 , 8 , 9 , 8 , 8 ; 8..6 ) | % { $SP[$_] }

                    $Y  = @( "<$GB $GR = '1' $GC = '1' $HD = 'Initialization' $MA = '5' >" , "<$G>" , "<$GRD>" ;
                          0..1 | % { "<$RD $H = '*' />" } ; "</$GRD>" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ;
                          "</$GCD>" )

                    $C  = 0
                    $Y += $PW , $CF | % { "<$GB $GR = '0' $GC = '$C' $HD = '$_' >" , "<$PWB $Q = '$_' $H = '20' $MA = '5' $PWC = '*' />" , "</$GB>"
                        
                        [ Void ]$C ++ 
                    }

                    $C  = 0
                    $Y += $OK , $CA | % { "<$BU $Q = '$_' $GR = '1' $GC = '$C' $CO = '$_' $MA = '5' $W = '100' $H = '20' />"
                        [ Void ]$C ++ 
                    }

                    $Y += "</$G>" , "</$GB>"

                    $XML[10] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Framing _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
                    $X  = @( 5..0 ) | % { $SP[$_] }

                    $Y  = "</$G>" , "</$G>" , "</$G>" , "</$GB>" , "</$G>" , "</Window>"

                    $XML[11] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }

        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $DCFound ) # Domain Controller Found                                    [
        {#___________________________________________________________________________/

             # ____   _________________________
             #//¯¯\\__[________ Header _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 4 ; 10 , 13 , 13 , 9 ) | % { $SP[$_] }

                $Y      = "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , "  $W = '350'" ,
                          "  $H = '200'" , "$( $HAL[1] )" , "Topmost = 'True' " , "   Icon = '$( $GFX.Icon )'" ,
                          "  WindowStartupLocation = 'CenterScreen' >"

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 4 , 5 , 6 , 6 , 5 , 5 , 6 , 7 , 7 , 6 , 6 , 7 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "<$G>" , "<$GRD>" ; "3" , "" | % { "<$RD $H = '$_*' />" } ; "</$GRD>" , "<$G $GR = '0' >" ,
                          "<$GCD>" ; "" , "2" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ;
                          0..2 | % { "<$RD $H = '*' />" } ; "</$GRD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[      User Input       ]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = 0..2 | % { 6 , 7 , 6 } | % { $SP[$_] }

                $Y      = ( 0 , "Controller" , "DC" ) , ( 1 , "DNS" , "Domain" ) , ( 2 , "NetBIOS" , "NetBIOS" ) | % {
                        "<$TBL $GC = '0' $GR = '$($_[0])' $MA = '10' $($VAL[1]) $($HAL[2]) >" , "$($_[1]) Name:</$TBL>" ,
                        "<$LA $Q = '$($_[2])' $GC = '1' $GR = '$($_[0])' $($VAL[1]) $H = '24' $MA = '10' />" }

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5 , 5 , 6 , 7 , 7 , 6 ) | % { $SP[$_] }

                $Y      = @( "</$G>" , "<$G $GR = '1' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" )

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Controls ______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 6 ; 6..3 ) | % { $SP[$_] }

                $Y      = @( ( 0 , "Ok" ) , ( 1 , "Cancel" ) | % { "<$BU $Q = '$( $_[1] )' $CO = '$( $_[1] )' $GC = '$( $_[0] )' $GR = '1' $MA = '10' />" } ; 
                          "</$G>" , "</$G>" , "</Window>" )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] } 
            }
        
        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $DSCRoot ) # Desired State Controller Root Install                      [
        {#___________________________________________________________________________/

             $Title = "DSC Root Installation"

             # ____   _________________________
             #//¯¯\\__[_______ Header ________]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 7 ; 10 , 9 ) | % { $SP[$_] }

                $Y      = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , "  Title = '$Author | Hybrid @ $Title'" , 
                             "  $W = '640'" , " $H = '450'" , "Topmost = 'True' " , 
                             "   Icon = '$( $GFX.Icon )'" , "$( $HAL[1] )" ,  "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 , 4 , 5 , 4 , 4 ; @( 5 ) * 5 ; 4 , 4 ; @( 5 ) * 4 ; 4 ) | % { $SP[$_] }

                $Y      = @( "<$G>" , "<$G.Background>" , "<ImageBrush Stretch = 'UniformToFill' ImageSource = '$( $GFX.Background )' />" ,
                          "</$G.Background>" , "<$GRD>" ; 250 , "*" , "*" , 40 , 20 | % { "<$RD $H = '$_' />" } ; "</$GRD>" , "<$GCD>" ;
                          "" , 2 , 2 , "" | % { "<$CD $W = '$_*' />" } ; "</$GCD>" )

                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             #_    ____________________________
             #\\__//¯¯[_______ Framing _______]
             # ¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 4 , 4 , 5 , 4 , 4 , 6 , 5 , 4 , 4 , 4 , 3 , 2 ) | % { $SP[$_] }

                $Y      = @( "<Image $GR = '0' $GC`Span = '4' $( $HAL[1] ) $W = '640' $H = '250' Source = '$( $GFX.Banner )' />" ,
                       "<$TBL $GR = '1' $GC = '1' $GC`Span = '2' $( $HAL[1] ) Padding = '5' Foreground = '#00FF00' FontWeight = 'Bold' $( $VAL[1] )>" , 
                       "Hybrid - Desired State Controller - Dependency Installation Path" , "</$TBL>" , 
                       "<$TB $GR = '2' $GC = '1' $GC`Span = '2' $H = '22' TextWrapping = 'Wrap' $MA = '10' $( $HCAL[1] ) $Q = 'Install' >" ,
                       "<$TB.Effect>" , "<DropShadowEffect/>" , "</$TB.Effect>" , "</$TB>" ; 
                    
                       ( 1 , "Start" ) , ( 2 , "Cancel" ) | % { "<$BU $GR = '3' $GC = '$( $_[0] )' $Q = '$( $_[1] )' $CO = '$( $_[1] )' $MA = '10' />" } ; 
                    
                       "</$G>" , "</Window>" )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
            }


        #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\
        If ( $ProvisionDSC ) # Provision Desired State Controller Server             [
        {#___________________________________________________________________________/

            $Title = "DSC Deployment Share"

             # ____   _________________________
             #//¯¯\\__[_______ Header ________]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 2 ; @( 13 ) * 10 ; 12 , 10 , 9 ) | % { $SP[$_] }

                $Y      = @( "<Window" , "  xmlns = '$Schema/presentation'" , "xmlns:x = '$Schema'" , "  Title = '$Author | Hybrid @ $Title'" , 
                             "  $W = '640'" , " $H = '960'" , "Topmost = 'True' " , "   Icon = '$( $GFX.Icon )'" , " ResizeMode = 'NoResize'" , "$( $HAL[1] )" ,  
                             "  WindowStartupLocation = 'CenterScreen' >" )

                $XML[0] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[__ Window Resources ___]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 3..5 ; 5..8 ; 9..3 ) | % { $SP[$_] } 

                $Y      = @( "<Window.Resources>" , "<Style TargetType = 'Label' x:Key = 'RoundedBox' >" , "<$SE $PR = 'TextBlock.TextAlignment' Value = 'Center' />" , 
                             "<$SE $PR = 'Template' >" , "<$SE.Value>" , "<ControlTemplate TargetType = 'Label' >" , 
                             "<Border CornerRadius = '12' $BG = 'Blue' BorderBrush = 'Black' BorderThickness = '3' >" , 
                             "<ContentPresenter x:Name = 'contentPresenter' ContentTemplate = '{ TemplateBinding ContentTemplate }' $MA = '5' />" ,
                             "</Border>" , "</ControlTemplate>" , "</$SE.Value>" , "</$SE>" , "</Style>" , "</Window.Resources>" )
                
                $XML[1] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_____ Background ______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 3 , 4 , 5 , 5 , 5 , 4 , 4 , 5 , 4 , 4 , 5 ) | % { $SP[$_] } 
            
                $Y      = @( "<$G>" , "<$GRD>" ; 250 , '*' , 50 | % { "<$RD $H = '$_' />" } ; "</$GRD>" , "<$G.$BG>" , 
                             "<ImageBrush Stretch = 'UniformToFill' ImageSource = '$( $GFX.Background )' />" , "</$G.$BG>" , 
                             "<Image $GR = '0' Source = '$( $GFX.Banner )'/>" , 
                             "<TabControl $GR = '1' $BG = '{x:Null}' BorderBrush = '{x:Null}' Foreground = '{x:Null}' $( $HAL[1] )>" )

                $XML[2] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Staging _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5..7 ; 6 , 6 , 7 ; @( 8 ) * 6 ; 7 , 7 , 8 , 7 , 7 , 8 , 9 , 9 , 8 , 8 ; @( 9 ) * 5 ; 8 ; @( 8 , 9 , 9 , 10 , 9 , 8 , 8 ) * 5 ; 
                             7 , 7 , 8 , 9 , 9 , 8 ; @( 8 , 9 , 10 , 9 , 8 ) * 2 ; 7 ; 7 , 8 , 7 ) | % { $SP[$_] }

                $Y      = @( "<TabItem $HD = 'Stage Deployment Server' BorderBrush = '{x:Null}' $W = '280' >" , "<TabItem.Effect>" , "<DropShadowEffect/>" , 
                             "</TabItem.Effect>" , "<$G>" , "<$GRD>" ; 5 , 3 | % { 50 , "$_*" , "*" } | % { "<RowDefinition Height = '$_' />" } ; "</$GRD>" , 
                             "<$LA Style = '{ StaticResource RoundedBox }' $GR = '0' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#FFFFFF' FontSize = '14' >" , 
                             "MDT Base Share Settings" , "</$LA>" , "<$G $GR = '1' >" , "<$GCD>" ; 2 , 3 | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ; 
                             0..4 | % { "<$RD $H = '*' />" } ; "</$GRD>" ; 

                            ( 0 , "Drive Label" ,   "Drive" ) , ( 1 ,    "Directory Path" ,   "Directory" ) , ( 2 , "Samba Share" , "Samba" ) , 
                            ( 3 ,    "PS Drive" , "DSDrive" ) , ( 4 , "Drive Description" , "Description" ) | % {
                                
                                "<$TBL $GR = '$( $_[0] )' $GC = '0' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#00FF00' >" , "$( $_[1] )" , "<$TBL.Effect>" , 
                                "<DropShadowEffect   ShadowDepth = '1'  Color = '#336633' />" , "</$TBL.Effect>" , "</$TBL>" , 
                                "<$TB $GR = '$( $_[0] )' $GC = '1' $H = '24' $MA = '20,0,20,0' $Q = '$( $_[2] )' />" } ; 

                            "</$G>" , "<$G $GR = '2' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" ;

                            ( 0 , "Legacy MDT" , "Legacy" ) , ( 1 , "PSD-Remaster" , "Remaster" ) | % { 
                    
                                "<$RB $GC = '$( $_[0] )' $MA =  '5' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#00FF00' $CO = '$( $_[1] )' $Q = '$( $_[2] )' >" , 
                                "<$RB.Effect>" , "<DropShadowEffect ShadowDepth = '1' Color = '#336633' />" , "</$RB.Effect>" , "</$RB>" } ;
                            
                            "</$G>" , "<$LA Style = '{ StaticResource RoundedBox }' $GR = '3' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#FFFFFF' FontSize = '14' >" , 
                            "BITS / IIS Configuration" , "</$LA>" )

                $XML[3] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[__ BITS / IIS Setup ___]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 7 , 8 , 9 , 9 , 8 , 8 , 9 , 9 , 9 , 8 ; @( 8 , 9 , 9 , 10 , 9 , 8 , 8 ) * 3 ; 7 , 7 , 8 , 9  , 9 , 8 ; @( 8 , 9 , 10 , 9 , 8 ) * 2 ; 
                             7 , 6 , 5 ) | % { $SP[$_] }

                $Y      = @( "<$G $GR = '4' >" , "<$GCD>" ; 2 , 3 | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ; 0..2 | % { "<$RD $H = '*' />" } ; "</$GRD>" ;

                            ( 0 , "BITS / IIS Name" , "IIS_Name" ) , ( 1 , "IIS App Pool" , "IIS_AppPool" ) , ( 2 , "Virtual Host / Proxy" , "IIS_Proxy" ) | % {
                           
                                "<$TBL $GR = '$( $_[0] )' $GC = '0' $MA =  '5' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#00FF00' >" , "$( $_[1] )" , "<$TBL.Effect>" , 
                                "<DropShadowEffect ShadowDepth = '1' Color = '#336633' />" , "</$TBL.Effect>" , "</$TBL>" , 
                                "<$TB $GR = '$( $_[0] )' $GC = '1' $H = '24' $MA = '20,0,20,0' $Q = '$( $_[2] )' />" } ;
                            
                            "</$G>" , "<$G $GR = '5' >" , "<$GCD>" ; 0..1 | % { "<$CD $W = '*' />" } ; "</$GCD>" ;

                            ( 0 , "IIS_Install" , "Install / Configure IIS" ) , ( 1 , "IIS_Skip" , "Skip IIS Setup" ) | % { 

                                "<$RB $GC = '$( $_[0] )' $MA = '5' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#00FF00' $Q = '$( $_[1] )' Content = '$( $_[2] )' >" , 
                                "<$RB.Effect>" , "<DropShadowEffect   ShadowDepth = '1'  Color = '#336633' />" , "</$RB.Effect>" , "</$RB>" } ;

                            "</$G>" , "</$G>" , "</TabItem>" )

                $XML[4] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[____ Company Info _____]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 5 , 6 , 7 , 6 , 6 , 7 ; @( 8 ) * 6 ; 7 , 7 , 8 , 7 , 7 , 8 , 9 , 9 , 8 , 8 ; @( 9 ) * 4 ; 8 ; @( 8 , 9 , 9 , 10 , 9 , 8 , 8 ) * 4 ; 
                             7 , 7 , 8 , 7 ) | % { $SP[$_] }
                
                $Y      = @( "<TabItem $HD = 'Image Info' $( $HAL[1] ) $W = '280' BorderBrush = '{x:Null}' >" , "<TabItem.Effect>" , "<DropShadowEffect/>" , 
                             "</TabItem.Effect>" , "<$G>" , "<$GRD>" ; 4 , 2 , 4 | % { 50 , "$_*" } | % { "<$RD $H = '$_' />" } ; "</$GRD>" ; 
                             "<$LA Style = '{ StaticResource RoundedBox }' $GR = '0' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#FFFFFF' FontSize = '14' >" , 
                             "Company Information" , "</$LA>" , "<$G $GR = '1' >" , "<$GCD>" ; 2 , 3 | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ; 
                             0..3 | % { "<$RD $H = '*' />" } ; "</$GRD>" ;
                            
                            ( 0 , "Company Name" , "Company" ) , ( 1 , "Support Website" , "WWW" ) , ( 2 , "Support Phone" , "Phone" ) , 
                            ( 3 , "Support Hours" , "Hours" ) | % {

                                "<$TBL $GR = '$( $_[0] )' $GC = '0' $MA = '5' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#00FF00' >" , "$( $_[1] )" , "<$TBL.Effect>" , 
                                "<DropShadowEffect ShadowDepth = '1' Color = '#336633' />" , "</$TBL.Effect>" , "</$TBL>" ; 
                                "<$TB $GR = '$( $_[0] )' $GC = '1' $H = '24' $MA = '20,0,20,0' $Q = '$( $_[2] )' $TW = 'WrapWithOverflow' />" }
    
                            "</$G>" , "<$LA Style = '{ StaticResource RoundedBox }' $GR = '2' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#FFFFFF' FontSize = '14' >" , 
                            "Custom Graphics" , "</$LA>" )

                $XML[5] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[___ Custom Graphics ___]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 7 , 8 , 9 , 9 , 8 , 8 , 9 , 9 , 8 ; @( 8 , 9 , 9 , 10 , 9 , 8 , 8 ) * 2 ; 7 , 7 , 8 , 7 ) | % { $SP[$_] }

                $Y      = @( "<$G $GR = '3' >" , "<$GCD>" ; 2 , 3 | % { "<$CD $W = '$_*' />" } ; "</$GCD>" , "<$GRD>" ; 0..1 | % { "<$RD $H = '*' />" } ; "</$GRD>" ;

                            ( 0 , "Logo [120x120] BMP" , "Logo" ) , ( 1 , "Background" , "Background" ) | % {
                                
                                "<$TBL $GR = '$( $_[0] )' $GC = '0' $MA = '5' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#00FF00' >" , "$( $_[1] )" , "<$TBL.Effect>" , 
                                "<DropShadowEffect ShadowDepth = '1' Color = '#336633' />" , "</$TBL.Effect>" , "</$TBL>" , 
                                "<$TB $GR = '$( $_[0] )' $GC = '1' $H = '24' $MA = '20,0,20,0' $Q = '$( $_[2] )' $TW = 'WrapWithOverflow' />" } ; 
                            
                            "</$G>" , "<$LA Style = '{ StaticResource RoundedBox }' $GR = '4' $( $VAL[1] ) $( $HAL[1] ) Foreground = '#FFFFFF' FontSize = '14' >" , 
                            "Network &amp; Target Credentials" , "</$LA>" )

                $XML[6] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_ Network Credentials _]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 7 , 8 , 9 , 9 , 8 , 8 ; @( 9 ) * 4 ; 8 ; @( 8,9,9,10,9,8,8 ) * 4 ; 7..4 ) | % { $SP[$_] }

                $Y      = @( "<$G $GR = '5' >" , "<$GCD>" ; 2 , 3 | % { "<$CD $W = '$_*' />" } ; "</$GCD>" ; "<$GRD>" ; 0..3 | % { "<$RD $H = '*' />" } ; "</$GRD>" ;

                            ( 0 , "Branch Name" , "Branch" ) , ( 1 , "NetBIOS Domain" , "NetBIOS" ) , ( 2 , "Administrator Account" , "LMCred_User" ) , 
                            ( 3 , "Administrator Password" , "LMCred_Pass" ) | % { 

                                If ( $_ -eq 3 ) { $TBX = $PWB ; $QX = "$PWC = '*'" } Else { $TBX = $TB ; $QX = "" }

                                "<$TBL $GR = '$( $_[0] )' $GC = '0' Margin =  '5' VerticalAlignment = 'Center' HorizontalAlignment = 'Center' Foreground = '#00FF00' >" , 
                                "$( $_[1] )" , "<$TBL.Effect>" , "<DropShadowEffect ShadowDepth = '1' Color = '#336633' />" , "</$TBL.Effect>" , "</$TBL>" , 
                                "<$TBX $GR = '$( $_[0] )' $GC = '1' $H = '24' $MA = '20,0,20,0' $Q = '$( $_[2] )' $QX />" } ; 
                            
                            "</$G>" , "</$G>" , "</TabItem>" , "</TabControl>" )

                $XML[7] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
             # ____   _________________________
             #//¯¯\\__[_______ Framing _______]
             #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $X      = @( 4 , 5 ; @( 6 ) * 4 ; 5 , 5 ; 5..2 ) | % { $SP[$_] }

                $Y      = @( "<$G $GR = '2' >" , "<$GCD>" ; "" , 2 , 2 , "" | % { "<$CD $W = '*' />" } ; "</$GCD>" ; 
                
                            ( 1 , "Start" ) , ( 2 , "Cancel" ) | % { 
                            
                                "<$BU $GC = '$( $_[0] )' $Q = '$( $_[1] )' $CO = '$( $_[1] )' $MA = '10' />" } ; 
                                
                            "</$G>" , "</$G>" , "</Window>" )

                $XML[8] = 0..( $X.Count - 1 ) | % { $X[$_] + $Y[$_] }
        }
        
        $Item   = ForEach ( $i in 0..( $XML.Count - 1 ) ) { 0..( $XML[$I].Count - 1 ) | % { $XML[$I][$_] } } 
        $Return = ""

        0..( $Item.Count - 1 ) | % { $Return += "$( $Item[$_] )`n" } ; 

        If ( $Certificate    ) { Write-Theme -Action "Loaded [+]" "Certificate Panel" }
        If ( $Login          ) { Write-Theme -Action "Loaded [+]" "Login Panel" }
        If ( $NewAccount     ) { Write-Theme -Action "Loaded [+]" "New Account Panel" }
        If ( $HybridDSCPromo ) { Write-Theme -Action "Loaded [+]" "Hybrid-DSC Promo Panel" }
        If ( $DSCRoot        ) { Write-Theme -Action "Loaded [+]" "Desired State Controller Root Install" }
        If ( $DCFound        ) { Write-Theme -Action "Loaded [+]" "Domain Controller Found" }
        If ( $ProvisionDSC   ) { Write-Theme -Action "Loaded [+]" "Provision Desired State Controller Server" }
        
        Return $Return                                                           
                                                                                      #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                              __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\____________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Show-Message # Returns a messagebox ________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position  = 0 )                    ] [ String ] $Title   ,
            [ Parameter ( Mandatory = $True , Position = 1 ) ] [ String ] $Message )

        [ System.Windows.MessageBox ]::Show( $Message , $Title )                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Invoke-Login # Allows entry / use of an AD service account _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ] [ String ] $DC      ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ] [ String ] $Domain  ,
            [ Parameter ( Position = 2 , ValueFromPipeline = $True ) ]                     [ String ] $NetBIOS )

        IEX "Using Namespace System.DirectoryServices"

        $MSG          = ( 0 , "Username" ) , ( 1 , "Password" ) , ( 2 , "Confirmation" ) , ( 3 , "Authentication" ) | % {
            
            $w , $X   = $_[0..1]

            If ( $W -lt 2 ) 
            { 
                "Show-Message '$X Failure' 'You must enter a $X' " 
            }
            
            If ( $W -eq 2 ) 
            { 
                "Show-Message 'Password Failure' '$_ must match the $X'" 
            }
            
            If ( $W -eq 3 ) 
            { 
                "Show-Message '$X Failure' 'Submitted information is invalid/incorrect'" 
            }
        }

        $GUIX         = Get-XAML -Login | % { Convert-XAMLtoWindow -Xaml $_ -NE ( Find-XAMLNamedElements -XAML $_ ) -PassThru }

        $GUIX.Switch.Add_Click(  { $GUIX.Port.IsEnabled    =  $True } )
        $GUIX.Cancel.Add_Click(  { $GUIX.DialogResult      = $False } )
        $GUIX.Ok.Add_Click({ 
        
            $Port     = $GUIX.Port | % { 
            
                If ( $_.IsEnabled ) 
                { 
                    $_.Text 
                } 
                
                Else 
                { 
                    389 
                } 
            }

            $DomX     = $Domain.Split( '.' ) -join ',DC='

            $DX       = [ DirectoryEntry ]::New( "LDAP://$DC`:$Port/DC=$DomX" , $GUIX.Username.Text , $GUIX.Password.Password )

            If ( $GUIX.Username | ? { $_.Text     -eq $Null } )             
            { 
                IEX $MSG[0] 
            }

            ElseIf ( $GUIX.Password | ? { $_.Password -eq $Null } )
            { 
                IEX $MSG[1] 
            }
            
            ElseIf ( $GUIX.Confirm  | ? { $_.Password -eq $Null } )
            { 
                IEX $MSG[2] 
            }
            
            ElseIf ( $GUIX.Password.Password -notmatch $GUIX.Confirm.Password ) 
            { 
                IEX $MSG[2] 
            }
                ElseIf ( $DX.Name -eq $Null )                                       { IEX $MSG[3] }
                Else   { $GUIX.DialogResult = $True }
        })

        $Null = $GUIX.Username.Focus()

        $OPX  = Show-WPFWindow -GUI $GUIX

        If ( $OPX -eq $True )
        {
            Write-Theme -Action "Login [+]" "Successful"
            Return [ PSCredential ]::New( $GUIX.Username.Text , $GUIX.Password.SecurePassword )
        }

        Else
        {
            Write-Theme -Action "Login [!]" "Aborted" 12 4 15
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Export-INI # Originally based on Outfile-INI by Oliver Lipkau _____________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Mandatory , ValueFromPipeline ) ][ ValidateScript ({

                Test-Path $_ -PathType Container        })][      String ] $Path ,
            #\________________________________________________________________
            [ Parameter ( Mandatory , ValueFromPipeline ) ][ ValidateScript ({
            #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $_.Split( '.' )[-1] -ne ".ini"          })][      String ] $Name ,
            #\________________________________________________________________
            [ Parameter ( Mandatory , ValueFromPipeline ) ][ ValidateScript ({
            #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                $_ -ne $Null                            })][   Hashtable ] $Content ,
            #\________________________________________________________________
            [ Parameter ( ) ]                              [ ValidateScript ({
            
                $_ -in @( 'Unicode' ; 7 , 8 , 32 | % { "UTF$_" } ; 'ASCII' , 'BigEndianUnicode' , 'Default' , 'OEM' )
                
                                                        })][      String ] $Encoding = "Unicode" ,
            #\________________________________________________________________
            [ Parameter ( ) ]                              [      Switch ] $Force                ,
            [ Parameter ( ) ]                              [      Switch ] $Append               ,
            [ Parameter ( ) ]                              [      Switch ] $UTF8NoBOM            )

        Begin
        {
            "$Path\$Name"                                      | % { 

                If ( Test-Path $_ )
                {
                    If ( ! ( $Force -or $Append ) ) 
                    {
                        Write-Theme -Action "Exception [!]" "File exists, must use 'Force' or 'Append' to modify" 12 4 15
                        Break
                    }

                    If ( $Append )
                    {
                        $Output                                = GC $_

                        Write-Theme -Action "Imported [+]" "$_" 11 11 15
                    }

                    If ( $Force )
                    {
                        $Output                                = @( )

                        Write-Theme -Action "Force Replaced [+]" "$_" 11 11 15
                    }
                }

                Else
                {
                    $Outout                                    = @( )
                }
            }
        }

        Process
        {
            $Table                                             | % { 
        
                $_.GetEnumerator()                             | % { 
            
                    If ( $_.Value.GetType().Name -eq "Hashtable" )
                    {
                        "[$( $_.Name )]"                       | % {
                    
                            Write-Theme -Action "New Section [~]" "$_" 11 11 15

                            $Output                           += $_
                        }

                        $Table.$( $_.Name ).GetEnumerator()    | % { 

                            $_.Name , $_.Value -join '='       | % { 

                                Write-Theme -Action "Item [+]" "$_" 11 11 15
                            
                                $Output                       += $_
                            }
                        }

                        Write-Theme -Action "End Section [+]" "$_" 11 11 15

                        $Output                               += ""
                    }

                    Else
                    {
                        $_.Name , $_.Value -join '='           | % { 

                            Write-Theme -Action "Single Key [+]" "$_" 11 11 15

                            $Output                           += $_
                        }
                    }
                }

                $Output                                       += ""
            }
        }

        End
        {
            "$Path\$Name"                                      | % { 
        
                $Splat                                         = @{

                    Path                                       = $_
                    Value                                      = $Output
                    Encoding                                   = $Encoding
                }

                SC @Splat
        
                GI $_

                If ( $UTF8NoBOM )
                {
                    [ System.IO.File ]::WriteAllLines( $_ , ( GC $_ ) , ( New-Object System.Text.UTF8Encoding $False ) )
                }
            }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Add-ACL # Changes permissions of application pool/VHost ____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
       [ CmdletBinding () ] Param ( [ String ] $Path , [ FileSystemAccessRule ] $ACL ) 

            Get-ACL -Path $Path | % { $_.AddAccessRule( $ACL )
            Set-ACL -Path $Path -ACLObject $_ }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function New-ACLObject # Generates an ACL and edits its permissions ________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdletBinding () ] Param ( [ String ] $SAM , 

            [ FileSystemRights  ] $Rights              , 
            [ AccessControlType ] $Access    = 'Allow' , 
            [ InheritanceFlags  ] $Inherit   =  'None' , 
            [ PropagationFlags  ] $Propagate =  'None' )

            IEX "Using Namespace System.Security.AccessControl"

            Return [ FileSystemAccessRule ]::New( $SAM , $Rights , $Inherit , $Propagate , $Access ) 

                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-UninstallList # Collects installed applications from the registry__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Return GP ( "" ,"\WOW6432Node" | % { 
        
            "HKLM:\SOFTWARE$_\Microsoft\Windows\CurrentVersion\Uninstall\*" 
        
        })[@{ x86 = 0 ; AMD64 = 0..1 }[$Env:Processor_Architecture]]

                                                                                  #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Install-DSCRoot # Provisioned installation of Hybrid-DSC __________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        
        $GUI = Get-XAML -DSCRoot | % { Convert-XAMLToWindow -XAML $_ -NE ( Find-XAMLNamedElements -Xaml $_ ) -PassThru }

        $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False })

        $GUI.Start.Add_Click({ 

            If ( $GUI.Install.Text -eq "" ) 
            { 
                "Installation Location" | % { 
                
                    Show-Message -Title "$_ Missing" -Message "You must enter a $_" 
                } 
            }   
            
            Else
            { 
                $GUI.DialogResult = $True 
            }
        })

        $OP                       = Show-WPFWindow -GUI $GUI

        $Null                     = $GUI.Install.Focus()

        If ( $OP -eq $True )
        {
            $Root                 = @{ 
            
                Base              = $GUI.Install.Text
                Registry          = "HKLM:\SOFTWARE\Policies"
                Vendor            = "Secure Digits Plus LLC" 
                Date              = Get-Date 
            }
            
            If ( ! ( Test-Path $Root.Base ) )
            {
                NI $Root.Base -ItemType Directory

                Write-Theme -Action "Created [+]" "Installation Directory"
            }

            If ( Test-Path $Root.Base )
            {
                Write-Theme -Action "Detected [+]" "Installation Directory"
            }

            Start $Root.Base

            Sleep -M 100
            
            $Base = "$( $Root.Registry )\$($Root.Vendor )" 
            
            $Base | % { If ( Test-Path $_ ) { RI $_ } }

            Write-Theme -Action "Creating [~]" "Registry Entry for Installation Path"

            NI -Path $Root.Registry -Name $Root.Vendor 

            $Set = @{ Path  = $Base
                      Name  = "Hybrid-DSC"
                      Value = $Root.Base      }

            SP @Set
                
            Write-Theme -Action "Created [+]" "$( $Set.Name )"

            $Set = @{ Path  = $Base
                      Name  = "Installation Date"
                      Value = $Root.Date      }    
            
            SP @Set

            Write-Theme -Action "Created [+]" "$( $Set.Name )"

            Write-Theme -Action "Installing [~]" "Hybrid-DSC Root Structure"

            "Hybrid" , "Libraries" , "Scripts" , "Templates" , "Install" | % { 
            
                "$( $Root.Base )\$_" | % { If ( ( Test-Path $_ ) -ne $True ) { NI $_ -ItemType Directory } Else { GI $_ } }
            }

            $ENV:PSModulePath.Split( ';' ) | ? { GCI $_ -Recurse "*Hybrid-DSC*" } | % { "$_\Hybrid-DSC" } | % { 

                ForEach ( $I in "Graphics" , "Map" , "Control" )
                {
                    "$_\$I.zip" | % { Expand-Archive -Path $_ -DestinationPath "$( $Root.Base )\Hybrid" }
                }
            }

            $Registry     = Resolve-UninstallList

            $Base         = "$( $Root.Base )\Tools" | % { If ( ( Test-Path $_ ) -ne $True ) { NI $_ -ItemType Directory } Else { GI $_ } } | % { $_.FullName }

            $MDTFile      = "MicrosoftDeploymentToolkit_x$( If ( $env:PROCESSOR_ARCHITECTURE -eq "x86" ) { 86 } Else { 64 } ).msi"

            $Pull         = [ Ordered ]@{ }

            # [ Windows ADK ] - The Awesome Deployment Kit. That's what ADK means. Really.

            $Pull.Add( 0 , @(                                                    "Deployment Kit - Windows 10" ,
                                                                                                "10.1.17763.1" ,
                                                                                                      "WinADK" ,
                                                                       "Windows Assessment and Deployment Kit" ,
                                                                                                "$Base\WinADK" ,
                                                                                              "winadk1903.exe" ,
                                                             "https://go.microsoft.com/fwlink/?linkid=2086042" ,
                                                    "/quiet /norestart /log $env:temp\win_adk.log /features +" ) ) # ~ 2m

            # [ Windows PE ] - The Pain-in-the-ass Environment...

            $Pull.Add( 1 , @(                                                                "Preinstallation" ,
                                                                                                "10.1.17763.1" ,
                                                                                                       "WinPE" ,
                                                                     "Windows ADK Preinstallation Environment" ,
                                                                                                 "$Base\WinPE" ,
                                                                                               "winpe1903.exe" ,
                                                             "https://go.microsoft.com/fwlink/?linkid=2087112" ,
                                                    "/quiet /norestart /log $env:temp\win_adk.log /features +" ) ) # ~ 10m

            # Microsoft Deployment Toolkit

            $Pull.Add( 2 , @(                                                                "Deployment Tool" ,
                                                                                               "6.3.8450.0000" ,
                                                                                                         "MDT" ,
                                                                                "Microsoft Deployment Toolkit" ,
                                                                                                   "$Base\MDT" ,
                                                                                                    "$MDTFile" ,
                 "https://download.microsoft.com/download/3/3/9/339BE62D-B4B8-4956-B58D-73C4685FC492/$MDTFile" ,
                                                                                           "/quiet /norestart" ) ) # ~  4s
            $ETA = "2m" , "10m" , "4s" | % { "Estimated Time [~] $_" }
        
            Write-Theme -Action "Querying [~]" "Registry for installed applications"

            0..2      | % {

                $X    = $Pull[$_]

                $T    = $ETA[$_]
            
                $Item = $Registry | ? { $_.DisplayName -like "*$( $X[0] )*" }

                If ( ( $Item -ne $Null ) -and ( $Item.DisplayVersion -ge $X[1] ) )
                {
                    Write-Theme -Action "Confirmed [+]" "$( $X[3] ) meets minimum requirements"
                }

                ElseIf ( ( $Item -eq $Null ) -or ( $Item.DisplayVersion -lt $X[1] ) )
                {
                    Write-Theme -Action "Collecting [~]" "$( $X[3] )"
                
                    If ( ! ( Test-Path $X[4] ) )
                    {
                        NI $X[4] -ItemType Directory
                    
                        Write-Theme -Action "Created [+]" "$( $X[4] )"
                    }

                    IPMO BitsTransfer
                
                    [ Net.ServicePointManager ]::SecurityProtocol = [ Net.SecurityProtocolType ]::Tls12

                    $BITS = @{  Source           = $X[6]
                                Destination      = "$( $X[4] )\$( $X[5])"
                                Description      = $X[3] }

                    Start-BitsTransfer @BITS

                    $SAPS = @{  FilePath         = $X[5]
                                Args             = $X[7] 
                                WorkingDirectory = $X[4]
                                Passthru         = $True }

                    Write-Theme -Action "Installing [+]" "$( $X[3] )"
                    
                    Write-Theme -Function "ETA $T"

                    $Time = [ System.Diagnostics.Stopwatch ]::StartNew()

                    SAPS @SAPS | % { 
                    
                        For ( $j = 0 ; $j -le 100 ; $j = ( $j + 1 ) % 100 ) 
                        {
                            $Progress = @{  Activity        = "[ Installing ] $( $X[3] )"
                                            PercentComplete = "$J"
                                            Status          = "$J% Complete" }

                            Write-Progress @Progress
                
                            Sleep -M 250 

                            If ( $_.HasExited ) 
                            { 
                                Write-Progress -Activity "[ Installed ]" -Completed
                                Return 
                            }
                        }
                    }

                    $Time.Stop()

                    Write-Theme -Action "Installed [+]" "$( $X[3] )"

                    Write-Theme -Function "$( $Time.Elapsed )"

                }
            }

            Write-Theme -Action "Verified [+]" "PSD/MDT Dependencies"

            IPMO BitsTransfer
             
            [ Net.ServicePointManager ]::SecurityProtocol = [ Net.SecurityProtocolType ]::Tls12
                    
            $BITS = @{ Source      = "https://github.com/FriendsOfMDT/PSD/archive/master.zip"
                       Destination = "$( $Root.Base )\Tools\PSD_Master.zip" 
                       Description = "PowerShell Deployment" }
            
            Start-BitsTransfer @BITS
        }

        Else
        {
            Write-Theme -Action "Exception [!]" "The exited or the dialogue failed" 12 4 15
        }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Import-MDTModule # Loads the module for MDT _______________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
       
        GP "HKLM:\Software\Microsoft\Deployment 4" | % { GCI $_.Install_Dir "*Toolkit.psd1" -Recurse } | % { IPMO $_.FullName -VB }
        Write-Theme -Action "Module [+]" "Microsoft Deployment Toolkit"
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Install-HybridDSC # Provisions/Installs a Legacy or PSD Deployment Share __//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( [ Parameter ( ) ][ Switch ] $Test )

        Import-MDTModule
        
        $CS   = gcim Win32_ComputerSystem

        $Code = [ PSCustomObject ]@{ 
        
        # MDT Drive Info
        Drive       = "" ; Directory   = "" ; Samba       = "" ; DSDrive     = "" ; 
        Description = "" ; 

        # MDT Installation Type Switch
        Legacy      = "" ; Remaster    = "" ; 

        # IIS Info
        IIS_Name    = "" ; IIS_AppPool = "" ; IIS_Proxy   = "" ; 
            
        # IIS Installation Type Switch
        IIS_Install = "" ; IIS_Skip    = "" ;

        # Deployment Share Information
        Company     = "" ; WWW         = "" ; Phone       = "" ; Hours       = "" ; 
        Logo        = "" ; Background  = "" ; Branch      = "" ; NetBIOS     = "" ; 

        # Target Machine Information
        LMCred_User = "" ; LMCred_Pass = "" }

        $MSG  = @( "File System/Drive" ,       "Root Directory" ,    "Network Share Name" ,      "PSDrive Name" , 
                   "Share Description" ,   "BITS-DSC Site Name" , "Application Pool Name" , "Virtual Host Name" , 
                        "Company Name" ;    "Website" , "Phone" , "Hours" | % { "Support $_" } ;         "Logo" ;
                          "Background" ;               "Branch" ;          "NetBIOS Name" ; 
                "Target/LM Admin User" ; "Target/LM Admin Pass" ) | % { "Show-Message -Title '$_ Missing' -Message 'You must enter a $_'" }

        $GUI = Get-XAML -ProvisionDSC              | % { 
            Convert-XAMLtoWindow -Xaml $_ -NE ( Find-XAMLNamedElements -XAML $_ ) -PassThru 
        }

        $GUI.Legacy.Add_Click({
            "Remaster"                   | % { $GUI.$_.IsChecked = $False ; $Code.$_ =        "-" }
            "Legacy"                     | % { $GUI.$_.IsChecked =  $True ; $Code.$_ = "Selected" }
        })

        $GUI.Remaster.Add_Click({
            "Remaster"                   | % { $GUI.$_.IsChecked =  $True ; $Code.$_ = "Selected" }
            "Legacy"                     | % { $GUI.$_.IsChecked = $False ; $Code.$_ =        "-" }
        })

        $GUI.IIS_Install.Add_Click({ 
            "IIS_Install"                | % { $GUI.$_.IsChecked =  $True ; $Code.$_ = "Selected" }
            "IIS_Skip"                   | % { $GUI.$_.IsChecked = $False ; $Code.$_ =        "-" }
            "Name" , "AppPool" , "Proxy" | % { "IIS_$_" } | % { $GUI.$_.IsEnabled =  $True ; $GUI.$_.Text = "" ; $Code.$_ = "" }
        })

        $GUI.IIS_Skip.Add_Click({
            "IIS_Install"                | % { $GUI.$_.IsChecked = $False ; $Code.$_ =        "-" }
            "IIS_Skip"                   | % { $GUI.$_.IsChecked =  $True ; $Code.$_ = "Selected" }
            "Name" , "AppPool" , "Proxy" | % { "IIS_$_" } | % { $GUI.$_.IsEnabled = $False ; $GUI.$_.Text = "" ; $Code.$_ = "" }
        })

        $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False })

        $GUI.Start.Add_Click({

            $Stage = 0

                If ( $GUI.Drive           | % { $_.Text           -eq "" } ) { IEX $MSG[ 0] }
            ElseIf ( $GUI.Directory       | % { $_.Text           -eq "" } ) { IEX $MSG[ 1] }
            ElseIf ( $GUI.Samba           | % { $_.Text           -eq "" } ) { IEX $MSG[ 2] }
            ElseIf ( $GUI.DSDrive         | % { $_.Text           -eq "" } ) { IEX $MSG[ 3] }
            ElseIf ( $GUI.Description     | % { $_.Text           -eq "" } ) { IEX $MSG[ 4] }
            ElseIf ( $GUI.IIS_Install     | % { $_.IsChecked } )
            {
                    If ( $GUI.IIS_Name    | % { $_.Text           -eq "" } ) { IEX $MSG[ 5] }
                ElseIf ( $GUI.IIS_AppPool | % { $_.Text           -eq "" } ) { IEX $MSG[ 6] }
                ElseIf ( $GUI.IIS_Proxy   | % { $_.Text           -eq "" } ) { IEX $MSG[ 7] }
            }
            ElseIf ( $GUI.Company         | % { $_.Text           -eq "" } ) { IEX $MSG[ 8] }
            ElseIf ( $GUI.WWW             | % { $_.Text           -eq "" } ) { IEX $MSG[ 9] }
            ElseIf ( $GUI.Phone           | % { $_.Text           -eq "" } ) { IEX $MSG[10] }
            ElseIf ( $GUI.Hours           | % { $_.Text           -eq "" } ) { IEX $MSG[11] }
            ElseIf ( $GUI.Logo            | % { $_.Text           -eq "" } ) { IEX $MSG[12] }
            ElseIf ( $GUI.Background      | % { $_.Text           -eq "" } ) { IEX $MSG[13] }
            ElseIf ( $GUI.Branch          | % { $_.Text           -eq "" } ) { IEX $MSG[14] }
            ElseIf ( $GUI.NetBIOS         | % { $_.Text           -eq "" } ) { IEX $MSG[15] }
            ElseIf ( $GUI.LMCred_User     | % { $_.Text           -eq "" } ) { IEX $MSG[16] }
            ElseIf ( $GUI.LMCred_Pass     | % { $_.Password       -eq "" } ) { IEX $MSG[17] }

            $CHK    = 0..7
            $CHK[0] = $GUI.Drive.Text.Replace( '\' , '' )
            $CHK[1] = Get-ACL $CHK[0] | % { $_.Access } | ? { $_.IdentityReference -match $Env:Username } | % { $_.FileSystemRights }
            $CHK[2] = $GUI.Directory.Text.Replace( $CHK[0] , '' ).Replace( '\' , '' ).Replace( '/' , '' )
            $CHK[3] = $CHK[0,2] -join '\'
            $CHK[4] = $GUI.Samba.Text.Replace( '$' , '' )
            $CHK[5] = $GUI.DSDrive.Text.Replace( ':' , '' )
            $CHK[6] = $GUI.Logo.Text
            $CHK[7] = $GUI.Background.Text

            $MSG = @( "Invalid Drive" , "Insufficient priviledges over specified folder" ; "Directory" , "Share" | % { "$_ already exists, cannot proceed" } ;
            "name" , "path" | % { "MDT-PersistentDrive with that $_ already exists" } ; "not found" , "is not in bitmap form" | % { "Logo $_" } ; 
            "width" , "height" | % { "Logo $_ exceeds 120px" } ; "found" , "in an acceptable format" | % { "Background not $_" } ) | % { "Show-Message -Message '$_'" }

            If ( ! ( Test-Path $CHK[0] ) )                                                                         { IEX $MSG[ 0] }
            ElseIf ( ( "268435456" , "FullControl" , "Modify, Synchronize" | ? { $_ -in $CHK[1] } ).Count -eq 0 )  { IEX $MSG[ 1] }
            ElseIf ( Test-Path $CHK[3] )                                                                           { IEX $MSG[ 2] }
            ElseIf ( GSMBS | ? { $_.Name -like "*$( $CHK[4] )*" } )                                                { IEX $MSG[ 3] }
            ElseIf ( Get-MDTPersistentDrive | ? { $_.Name -eq $CHK[5] } )                                          { IEX $MSG[ 4] }
            ElseIf ( Get-MDTPersistentDrive | ? { $_.Path -eq $CHK[3] } )                                          { IEX $MSG[ 5] }
            ElseIf ( ! ( Test-Path $CHK[6] ) )                                                                     { IEX $MSG[ 6] }
            ElseIf ( $CHK[6].Split( '.' )[-1] -ne "bmp" )                                                          { IEX $MSG[ 7] }
            ElseIf ( [ System.Drawing.Bitmap ]::FromFile( $CHK[6] ).Width  -gt 120 )                               { IEX $MSG[ 8] }
            ElseIf ( [ System.Drawing.Bitmap ]::FromFile( $CHK[6] ).Height -gt 120 )                               { IEX $MSG[ 9] }
            ElseIf ( ! ( Test-Path $CHK[7] ) )                                                                     { IEX $MSG[10] }
            ElseIf ( !$CHK[7].Split( '.' )[-1] -in "BMP,GIF,JPG,PNG,TIF,DIB,JFIF,JPE,JPEG,WDP".Split( ',' ) )      { IEX $MSG[11] }

            If ( $GUI.Legacy.IsChecked )
            {
                $Code.Legacy      =    "Selected" 
                $Code.Remaster    =           "-"
            }

            If ( $GUI.Remaster.IsChecked )
            {
                $Code.Legacy      =           "-" 
                $Code.Remaster    =    "Selected"
            }

            If ( $GUI.IIS_Install.IsChecked )
            {
                $Code.IIS_Install =    "Selected" 
                $Code.IIS_Skip    =           "-"
                $Code.IIS_Name    = $GUI.IIS_Name.Text
                $Code.IIS_AppPool = $GUI.IIS_AppPool.Text
                $Code.IIS_Proxy   = $GUI.IIS_Proxy.Text
            }

            If ( $GUI.IIS_Skip.IsChecked )
            {
                $Code.IIS_Install =           "-"
                $Code.IIS_Skip    =    "Selected" 
                $Code.IIS_Name    =           "-"
                $Code.IIS_AppPool =           "-" 
                $Code.IIS_Proxy   =           "-"
            }

                $Code.Drive       = $CHK[0]
                $Code.Directory   = $CHK[3]
                $Code.Samba       = "$( $CHK[4] )$"
                $Code.DSDrive     = "$( $CHK[5] ):"
                $Code.Description = $GUI.Description.Text
                $Code.Company     = $GUI.Company.Text
                $Code.WWW         = $GUI.WWW.Text
                $Code.Phone       = $GUI.Phone.Text
                $Code.Hours       = $GUI.Hours.Text
                $Code.Logo        = $GUI.Logo.Text
                $Code.Background  = $GUI.Background.Text
                $Code.Branch      = $GUI.Branch.Text
                $Code.NetBIOS     = $GUI.NetBIOS.Text
                $Code.LMCred_User = $GUI.LMCred_User.Text
                $Code.LMCred_Pass = $GUI.LMCred_Pass.Password

                $GUI.DialogResult = $True
        })


        Resolve-HybridDSC -Domain | % { 
        
            $GUI.NetBIOS.Text = $_.NetBIOS
            $GUI.Branch.Text  = $_.Branch 
        }

        $GUI.Legacy      | % { $_.IsChecked = $True }
        $GUI.IIS_Install | % { $_.IsChecked = $True }

        If ( $Test )
        {
            $GFX = Resolve-HybridDSC -Graphics
            
            $GUI | % {
            
                $_.Drive       | % { $_.Text     = "C:\"                              }
                $_.Directory   | % { $_.Text     = "Test1"                            }
                $_.Samba       | % { $_.Text     = "Samba$"                           }
                $_.DSDrive     | % { $_.Text     = "PSDrive:"                         }
                $_.Description | % { $_.Text     = "Info"                             }
                $_.Company     | % { $_.Text     = "Secure Digits Plus LLC"           }
                $_.IIS_Name    | % { $_.Text     = "SiteName"                         }
                $_.IIS_AppPool | % { $_.Text     = "MDT_AppPool"                      }
                $_.IIS_Proxy   | % { $_.Text     = "Hybrid"                           }
                $_.WWW         | % { $_.Text     = "https://www.securedigitsplus.com" }
                $_.Phone       | % { $_.Text     = "(518) 406-8569"                   }
                $_.Hours       | % { $_.Text     = "24h/d; 7d/w; 365.25d/y;"          }
                $_.Logo        | % { $_.Text     = $GFX.Logo                          }
                $_.Background  | % { $_.Text     = $GFX.Brand                         }
                $_.LMCred_User | % { $_.Text     = "Administrator"                    }
                $_.LMCred_Pass | % { $_.Password = "password"                         }
            }
        }

        $OP = Show-WPFWindow -GUI $GUI

        If ( $OP -eq $True ) 
        {   
            If ( Test-Path $Code.Directory )
            {
                Write-Theme -Action "Exception [!]" "Directory must not exist, breaking"
                
                Read-Host "Press Enter to Return"
                
                Break
            }

            Else
            {
                NI -Path $Code.Directory -ItemType Directory

                If ( $? -eq $True )
                {
                    Write-Theme -Action "Successful [+]" "Directory Created"
                }

                Else
                {
                    Write-Theme -Action "Exception [!]" "Directory Creation Failed" 12 4 15
                    Read-Host "Press Enter to Exit"
                    Break
                }
            }
            
            # Create the Samba Share

            $NSMBS = @{ Name        = $Code.Samba 
                        Path        = $Code.Directory 
                        FullAccess  = "Administrators" 
                        Description = $Code.Description }
    
            NSMBS @NSMBS

            If ( $? -eq $True )
            {
                Write-Theme -Action "Successful [+]" "Samba Share Created"
            }

            Else
            {
                Write-Theme -Action "Exception [!]" "Samba Share Creation Failed" 12 4 15
                Read-Host "Press Enter to Exit"
                Break
            }

            # Create the PSDrive/MDTPersistent Drive
            
            $NDR = @{   Name        = $Code.DSDrive.Replace( ':' , '' )
                        PSProvider  = "MDTProvider"
                        Root        = $Code.Directory
                        Description = $Code.Description
                        NetworkPath = "\\$ENV:ComputerName\$( $Code.Samba )"
                        Verbose     = $True }

            NDR @NDR | Add-MDTPersistentDrive -VB

            # Scaffold Hybrid-DSC Deployment Share Root Settings, Copy Designated/Default Background & Logo
            
            $Code | % { 

                $DSC = "$( $_.Directory )\$( $_.Company )"

                NI $DSC -ItemType Directory 

                ( 0 , "Resources" ) , ( 1 , "Tools" ) , ( 2 , "Images" ) , ( 3 , "Profiles" ) , ( 4 , "Certificates" ) , ( 5 , "Applications" ) | % { 

                    NI "$DSC\($( $_[0] ))$( $_[1] )" -ItemType Directory
                }

                $RES = ( gci $DSC *0* ).FullName

                $_.Background , $_.Logo | % { CP $_ $RES }

                $_.Background = "$RES\$( $_.Background.Split('\')[-1] )"
                
                $_.Logo       = "$RES\$( $_.Logo.Split('\')[-1] )"
            }

            If ( $? -eq $True )
            {
                Write-Theme -Action "Successful [+]" "PSDrive/MDTPersistent Drive Created"
            }

            Else
            {
                Write-Theme -Action "Exception [!]" "PSDrive/MDTPersistent Drive Creation Failed" 12 4 15

                Read-Host "Press Enter to Exit"
                
                Break
            }
    
            # Plant Tree For Deployment Share Root Settings

            $Root = Resolve-HybridDSC -Root | % { $_.Root }

            $Tree = "Hybrid-DSC\$( $Code.Company )\$( $Code.DSDrive.Replace( ':' , '' ) )"

            $Rec  = $Tree.Split( '\' )

            $Path = $Root

            ForEach ( $i in 0..2 ) 
            {
                "$Path\$( $Rec[$I] )" | % {

                    If ( ! ( Test-Path $_ ) )
                    {
                        NI $Path -Name $Rec[$I]
                    }

                    $Path = $_
                }
            }

            # Place Deployment Share Root Settings in the registry
            $Names  = $Code  | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name }
            $Values = $Names | % { $Code.$_ } 
            
            0..( $Names.Count - 1 ) | % { SP -Path $Path -Name $Names[$_] -Value $Values[$_] -Force }

            SP -Path $Path -Name "Server" -Value $ENV:ComputerName

            $Share = Resolve-HybridDSC -Share 
            
            $Share | % { SC -Path "$( $_.Directory )\DSC.txt" -Value ( $_ | ConvertTo-JSON ) -Force }

            If ( $Code.Remaster -eq "Selected" )
            {
                Write-Theme -Action "Creating" "[+] PowerShell [ Deployment / Development ] Share"
                    
                $Source   = Resolve-HybridDSC -Root | % { $_.Tree }
                $Remaster = GCI $Source "*PSD*" -Recurse | % { $_.FullName }

                If ( $Remaster -eq $Null )
                {
                    Write-Theme -Action "Exception [!]" "The Remastered package was not detected" 12 4 15
                    Break
                }

                $Manifest = [ PSCustomObject ]@{ 

                        Scripts   = "Scripts"
                        Templates = "Templates"
                        Modules   = "Tools\Modules"
                        Folders   = "Gather" , "DeploymentShare" , "Utility" , "Wizard" | % { "PSD$_" }
                        XSD       = "Groups" , "Medias" , "OperatingSystems" , "Packages" , "SelectionProfiles" , "TaskSequences" , 
                                    "Applications" , "Drivers" , "LinkedDeploymentShares" | % { "$_.xsd" }
                        PSSnapIn  = @( "dll" , "dll.config" , "dll-help.xml" , "Format.ps1xml" , "Types.ps1xml" | % { 
                                       "PSSnapIn.$_" } ; "Core.dll" , "Core.dll.config" , "ConfigManager.dll" )
                        Paths     = @( "Logs" , "Logs\Dyn" ; "Sources" , "Packages" | % { "Driver$_" } )
                }
                
                Expand-Archive $Remaster -DestinationPath "$Source\Tools"

                $Items = "Scripts" , "Templates" | % { gci "$Source\Tools\PSD-Master\$_" | % { $_.FullName } }
                
                0..( $Items.Count - 1 ) | % { 
                
                    $X = $Items[$_]
                    $Y = "$( $Code.Directory )\$( If ( $X -like "*Scripts*" ) { "Scripts" } If ( $X -like "*Templates*" ) { "Templates" } )"
                    MI $X $Y
                }
                
                RI "$Source\Tools\PSD-master" -Recurse -Force

                $M = $Manifest
                $W = $Code.Directory
                $X = $W , $M.Modules -join '\'

                $M.Folders | % { "$X\$_" } | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory -Verbose }

                GCI "$W\Scripts" *.psm1* -Recurse | % { CP $_.FullName "$W\Tools\Modules\$( $_.BaseName )\$( $_.Name )" -Verbose }

                $Snap  = "$W\Tools\Modules\Microsoft.BDD.PSSnapin" 
                
                $Snap  | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory -VB }

                $MDTDir = GP "HKLM:\Software\Microsoft\Deployment 4" | % { $_.Install_Dir }
                
                $M.PSSnapIn | % { GCI "$MDTDir\Bin" *$_* -Recurse } | % { CP $_.FullName "$Snap\$( $_.Name )" -Verbose }

                GCI $MDTDir *Gather.xml* -Recurse | % { CP $_.FullName "$W\Tools\Modules\PSDGather" -Verbose }

                $M.XSD      | % { GCI $MDTDir *$_* -Recurse } | % { CP $_.FullName "$W\Templates" -Verbose }
                
                $M.Paths    | % { "$W\$_" } | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory -Verbose }

            }

            Write-Theme -Action "Reducing [~]" "Permissions Hardening on $( $Code.Samba )"

            "Users" , "Administrators" , "SYSTEM" | % { ICACLS $Code.Directory /Grant "$_`:(OI)(CI)(RX)" }

            $Code.Samba | % { 
                
                GRSMBA -Name $_ -AccountName "EVERYONE" -AccessRight Change -Force
                RKSMBA -Name $_ -AccountName "CREATOR OWNER" -Force 
            }

            $Control = @{ Path        = GCI ( Resolve-HybridDSC -Root | % { $_.Tree } ) "*Control*" -Recurse | % { $_.FullName }
                          Destination = $Share | % { gci $_.Directory "*(2)Images*" -Recurse } | % { $_.FullName }
                          Recurse     = $True 
                          Force       = $True }

            CP @Control

            If ( $Code.Legacy -eq "Selected" )
            {
                Write-Theme -Action "Complete [+]" "Legacy MDT Installed"
            }
            
            If ( $Code.Remaster )
            {
                Write-Theme -Action "Complete [+]" "Hybrid-DSC/PSD Installed"
            }
                  
            If ( $Code.IIS_Install -eq "Selected" )
            {
                # ____   _________________________
                #//¯¯\\__[__ Table Definition ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Site         = [ PSCustomObject ]@{ 

                        Name      = $Code.IIS_Name
                        Pool      = $Code.IIS_AppPool
                        Host      = $Code.IIS_Proxy

                        System    = $ENV:SystemDrive
                        System32  = "$ENV:SystemRoot\System32"
                        Server    = $ENV:ComputerName

                        AppHost   = "Machine/Webroot/AppHost"
                        WebServer = "system.webServer"
                        SecAuth   = "security/authentication"
                        AutoStart = "ServerAutoStart"
                        Static    = "StaticContent"

                        Date      = ( Get-Date -UFormat "%m-%d-%Y" )
                        Log       = "$Home\Desktop\ACL"

                        Root      = ""
                        Site      = ""
                        URL       = ""
                    }

                    $Site | % { 
            
                        $_.Root = "$( $_.System )\inetpub\$( $_.Name )"
                        $_.Site = "IIS:\Sites\$( $_.Name )\$( $_.Host )"
                        $_.URL  = "$( $_.Name ).$env:USERDNSDOMAIN"

                    }

                    $Site.Root | % { $_ , "$_\AppData" | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory } }
                # ____   _________________________
                #//¯¯\\__[__ Get Web Services ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Web          = @( "Web-Server" , "DSC-Service" , "FS-SMBBW" , "ManagementOData" , "WindowsPowerShellWebAccess" , "WebDAV-Redirector" ; 
                    "BITS"        | % { "$_" , "$_-IIS-Ext" , "RSAT-$_-Server" } ;
                    "Net"         | % { "$_-Framework-45-ASP$_" , "$_-WCF-HTTP-Activation45" } ;
                    <# Web #>       @( "App-Dev" , "AppInit" , "Asp-Net45" , "Basic-Auth" , "Common-Http" , "Custom-Logging" , "DAV-Publishing" , "Default-Doc" ,
                    "Digest-Auth" , "Dir-Browsing" , "Filtering" , "Health" ; "HTTP" | % {  "$_-Errors" , "$_-Logging" , "$_-Redirect" , "$_-Tracing" } ;
                    "Includes" ; "ISAPI" | % { "$_-Ext" ; "$_-Filter" } ; "Log-Libraries" , "Metabase" , "Mgmt-Console" , "Net-Ext45" , "Performance" ,
                    "Request-Monitor" , "Security" , "Stat-Compression" , "Static-Content" , "Url-Auth" , "WebServer" , "Windows-Auth" ) | % { "Web-$_" } ;
            
                    "WAS"         | % { "$_" , "$_-Process-Model" , "$_-Config-APIs" } )

                    Write-Theme -Action "Checking [~]" "IIS / Windows Features"

                    Get-WindowsFeature | ? { $_.Name -in $Web -and $_.InstallState -ne "Installed" } | % {

                        Write-Theme -Action "Installing [~]" "Installing $( $_.Name )"
    
                        Install-WindowsFeature -Name $_.Name -IncludeAllSubFeature -IncludeManagementTools
        
                    }
                # ____   _________________________
                #//¯¯\\__[__ Set Web Services ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    IPMO WebAdministration
        
                    Write-Theme -Action "Loaded [~]" "WebAdministration Module"

                    Get-Website | ? { $_.Name -eq "Default Web Site" } | Stop-Website | SP "IIS:\Sites\$( $_.Name )" ServerAutoStart False

                    Write-Theme -Action "Stopped [+]" "Default Web Site"

                    "MRxDAV" , "WebClient" | % { Get-Service -Name $_ } | % { 
        
                        If ( $_.Status -ne "Running" ) 
                        {
                            $Service = @{ StartupType = "Automatic"
                                          Status      =   "Running"
                                          Name        =    $_.Name }
                
                            Set-Service @Service

                            Write-Theme -Action "Started [+]" "$( $_.Name ) Active"
                        }
            
                        Else 
                        {
                            Write-Theme -Action "Running [+]" "$( $_.Name ) was already Active"
                        }
                    }
                # ____   _________________________
                #//¯¯\\__[__ Generate AppPool ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    If ( ( Get-IISAppPool -Name $Site.Pool ) -ne $Null )
                    { 
                        Write-Theme -Action "Removing [!]" "Prior Application Pool"
            
                        Remove-WebAppPool -Name $Site.Pool
                    }

                    New-WebAppPool -Name $Site.Pool -Force

                    Write-Theme -Action "Configuring" "[~] Application Pool Settings"

                    ( "Enable32BitAppOnWin64" , "True" ) , ( "ManagedRuntimeVersion" , "v4.0" ) , ( "ManagedPipelineMode" , "Integrated" ) | % { 
            
                        SP -Path "IIS:\AppPools\$( $Site.Pool )" -Name $_[0] -Value $_[1]
                    }

                    Restart-WebAppPool -Name $Site.Pool
                # ____   _________________________
                #//¯¯\\__[__ Generate Website ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    If ( ( Get-WebSite -Name $Site.Name ) -ne $Null )
                    { 
                        Write-Theme -Action "Removing [!]" "Prior Website"

                        Remove-Website -Name $Site.Name
                    }
            
                    $Splat = @{ Name             = $Site.Name
                                ApplicationPool  = $Site.Pool
                                PhysicalPath     = $Site.Root 
                                Force            = $True }

                    New-Website @Splat

                    Write-Theme -Action "Generated [+]" "IIS Web Site $( $Site.Name )"

                    Start-Website -Name $Site.Name

                    Write-Theme -Action "Started [+]" "IIS Web Site $( $Site.Name )"
                # ____   _________________________
                #//¯¯\\__[___ Set Web Binding ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Binding [+]" "IIS Web Site $( $Site.Name )"

                    $Splat = @{ Name             = $Site.Name
                                HostHeader       = ""
                                PropertyName     = "HostHeader"
                                Value            = $Site.URL }

                    Set-WebBinding @Splat

                    Write-Theme -Action "Configured [+]" $Site.URL

                    $Splat = @{ Site             = $Site.Name
                                Name             = $Site.Host
                                PhysicalPath     = $Code.Directory
                                Force            = $True }

                    New-WebVirtualDirectory @Splat
                
                    Write-Theme -Action "Complete [+]" "http://$( $Site.URL )"
                # ____   _________________________
                #//¯¯\\__[__ WebDAV Authoring ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Configuring [~]" "WebDAV Authoring"
            
                    $Splat = @{ PSPath           = $_.AppHost
                                Location         = $_.Name
                                Filter           = "$( $_.WebServer )/webdav/authoring"
                                Name             = "Enabled"
                                Value            = "True" }

                    Set-WebConfigurationProperty @Splat

                    Write-Theme -Action "Complete [~]" "WebDAV Authoring"
                # ____   _________________________
                #//¯¯\\__[____ WebDAV Rules _____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Generating [~]" "WebDAV Authoring Rules"
            
                    $Config = $Site | % { 
            
                        "Set Config '$( $_.Name )/$( $_.Host )'" , 
                        "/Section:$( $_.WebServer )/webdav/authoringRules" , 
                        "/+[Users='*',Path='*',Access='Read,Source']" , 
                        "/Commit:AppHost" -join ' ' 
                    }

                    $Splat = @{ FilePath         = GCI "$( $Site.System32 )\inetsrv" "*appcmd.exe" | % { $_.FullName }
                                ArgumentList     = $Config
                                NoNewWindow      = $True
                                PassThru         = $True }
                    
                    SAPS @Splat | Out-Null
                
                    Write-Theme -Action "Generating [~]" "WebDAV Authoring Rules"
                # ____   _________________________
                #//¯¯\\__[____ Add Mime Type ____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Splat = @{ PSPath = $Site.Site
                                Filter = "$( $Site.WebServer )\$( $Site.Static )"
                                Name   = "." }

                    Get-WebConfigurationProperty @Splat | % { $_.Collection } | ? { !$_.fileExtension -eq ".*" } | % {

                        $Splat.Add( "Value" , @{ fileExtension = '.*' ; mimeType = 'Text/Plain' } )

                        Add-WebConfigurationProperty @Splat
                
                        Write-Theme -Action "Configured [+]" "[ fileExtension: '.*' ] / [ mimeType: 'Text/Plain' ]"
                    }
                # ____   _________________________
                #//¯¯\\__[__ Directory Browse ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Enabling [+]" "Directory Browsing"

                    $Splat     = @{ Filter = "/$( $Site.WebServer )/DirectoryBrowse"
                                    Name   = "Enabled"
                                    PSPath = $Site.Site
                                    Value  = $True }

                    Set-WebConfigurationProperty @Splat
                # ____   _________________________
                #//¯¯\\__[____ Security/Auth ____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $PSPath    = 0..8 | % { "MACHINE/WEBROOT/APPHOST" }
                    $Location  = ( $Site | % { "$( $_.Name )\" ; "$( $_.Name )\$( $_.Host )" } )[1,1,0,1,0,1,0,1,0]
                    $Filter    = @( "anonymous" , "windows" | % { "security/authentication/$_`Authentication" } ; "Rules" , "/properties" | % { "webdav/authoring$_" } ; 
                                    "fileExtentions" , "verbs" | % { "security/requestFiltering/$_" } )[0,1,2,3,3,4,4,5,5] | % { "system.webServer/$_" }
                    $Name      = (  "enabled" , "defaultMimeType" , "allowInfinitePropfindDepth" , "applyToWebDAV" )[0,0,1,2,2,3,3,3,3]
                    $Value     = (  "False" , "True" , "Text/XML" )[0,1,2,1,1,0,0,0,0]

                    ForEach ( $i in 0..8 )
                    { 
                        $Splat = @{ PSPath   = $PSPath[$i]
                                    Location = $Location[$i]
                                    Filter   = $Filter[$i]
                                    Name     = $Name[$i]
                                    Value    = $Value[$i] }
                    
                        $Names    = "Location" , "Filter" , "Name" , "Value"
                        $Values   = $Names | % { $Splat.$_ }
                        $Section  = "Setting WebConfiguration #$( $I + 1 )"

                        $Subtable = New-SubTable -Items $Names -Values $Values

                        $Panel    = @{ Title = "WebConfiguration"
                                       Depth = 1
                                       ID    = $Section  | % { "( $_ )" }
                                       Table = $Subtable | % { $_ } }
        
                        $Table    =    New-Table @Panel

                        Write-Theme -Table $Table

                        Set-WebConfigurationProperty @Splat

                    }
                # ____   _________________________
                #//¯¯\\__[___ Hidden Segments ___] # Disabled for now, recurring error "disk changes" ( This is a security issue )
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

                        # Write-Theme -Action "Restarting [~]" "IIS Service" 11 12 15
                    
                        # IISRESET /Stop

                        # Write-Theme -Action "Configuring [~]" "Security Request Filtering for WebDAV" 11 12 15

                        # $SP   = "system.webServer/security/requestFiltering" ; 
                        # $HS   = "hiddenSegments"
                        # $ATWD = "applytoWebDAV"
                    
                        # ( Get-IISConfigSection | ? { $_.SectionPath -like "*$SP*" } | Get-IISConfigElement -ChildElementName $HS ) | % { 
                    
                        #   Set-IISConfigAttributeValue -ConfigElement $_ -AttributeName "applytoWebDAV" -AttributeValue $False 
                    
                        # }

                        # IISRESET /Start
                # ____   _________________________
                #//¯¯\\__[_____ File System _____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Access Control [~]" "Configuring SAM / Access Control Permissions"

                    'IIS_IUSRS', 'IUSR', "IIS APPPOOL\$( $Site.Pool )" | % { 

                        $Splat = @{ SAM     = $_
                                    Rights  = 'ReadAndExecute'
                                    Inherit = 'ContainerInherit' , 'ObjectInherit' }

                        New-ACLObject @Splat | % { Add-ACL -Path $Site.Root -ACL $_ }

                    }

                    'IIS_IUSRS', "IIS APPPOOL\$( $Site.Pool )"         | % {

                        $Splat = @{ SAM     = $_
                                    Rights  = 'Modify'
                                    Inherit = 'ContainerInherit' , 'ObjectInherit' }

                        New-AclObject @Splat | % { Add-Acl -Path "$( $Site.Root )\AppData" -ACL $_ }
                    }
                # ____   _________________________
                #//¯¯\\__[__ Strictly TLS 1.2 ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Configuring [~]" "SCHANNEL [ SSL 2.0 - 3.0 ] & [ TLS 1.0 - 1.2 ]"

                    $SSLTLS    = "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols"

                    $Types     = "Client" , "Server"

                    $Protocols = @( 2..3 | % { "SSL $_.0" } ; 0..2 | % { "TLS 1.$_" } )

                    $Protocols | % { If ( ! ( Test-Path "$SSLTLS\$_" ) ) { NI -Path $SSLTLS -Name "$_" } }

                    $List      = GCI $SSLTLS | % { $_.PSPath } 
                
                    $List      | % { If ( $_.PSChildName -eq $Null ) { NI -Path $_ -Name "Server" ; NI -Path $_ -Name "Client" } }

                    GCI $List  | % { 
                
                        $V = $( If ( $_ -like "*TLS 1.2*" ) { 1 } Else { 0 } )
                    
                        SP -Path $_.PSPath -Name "DisabledByDefault" -Value 0
                        SP -Path $_.PSPath -Name           "Enabled" -Value $V
                    }
                # ____   _________________________
                #//¯¯\\__[___ .Net FW TLS 1.2 ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Configuring [~]" ".Net Framework [ v2.0.50727 ] & [ v4.0.30319 ]"

                    ForEach ( $i in "" , "\WOW6432NODE" | % { "HKLM:\SOFTWARE$_\Microsoft\.NETFramework" } ) 
                    { 
                        "v2.0.50727" , "v4.0.30319" | % { 

                            If ( ( Test-Path $i ) -ne $True ) { NI -Path $i -Name "$_" }
                        
                            SP -Path $i -Name "SystemDefaultTlsVersions" -Type DWORD -Value 1
                        }
                    }
                # ____   _________________________
                #//¯¯\\__[_ Website / DNS Setup _]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Pausing [~]" "Website to modify DNS record"

                    Stop-Website $Site.Name

                    $Resolve = Resolve-HybridDSC -Domain

                    $Splat = @{ ZoneName = $Resolve.Branch
                                RRType   = "CNAME" }
                    
                    Get-DNSServerResourceRecord @Splat | ? { $_.HostName -eq $Site.Name } | % {

                        $Splat.Add(  "Name" , $_.HostName )
                        $Splat.Add( "Force" , $True )

                        Remove-DNSServerResourceRecord @Splat
                    }

                    $Splat = @{ HostNameAlias = Resolve-DnsName 127.0.0.1 | % { $_.NameHost }
                                Name          = $Site.Name
                                ZoneName      = $Resolve.Branch }

                    Add-DNSServerResourceRecordCName @Splat

                    Write-Theme -Action "Resuming [+]" "Website $( $Site.Name )"
                    Start-Website $Site.Name

                    Write-Theme -Action "Complete [+]" "Your Web Server should now be available to the internet"
                    Start "http://$( $Site.URL )"

                    Write-Theme -Action "Recommendation" "[!] You may want to configure SSL Certificates manually"
            } 

            If ( $Code.IIS_Skip -eq "Selected" )
            {
                Write-Theme -Action "Bypass [~]" "MDT/IIS Server Setup"
            }
        }

        Else
        {
            Write-Theme -Action "Exception [!]" "Either the user cancelled, or the dialog failed" 12 4 15
        }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-HybridDSC # Populates Tools and Items for subfolders ___________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯       
        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName =     "Images" ) ] [ Switch ] $Images     ,
            [ Parameter ( ParameterSetName = "Slipstream" ) ] [ Switch ] $Slipstream )

        $DS      = Resolve-HybridDSC -Share | % { GCI ( $_.Directory , $_.Company -join '\' ) } | % { $_.FullName }

        $Tag     = @( "DC2016" ; "E" , "H" , "P" | % { "10$_`64" , "10$_`86" } )

        If ( $Images )
        {
                # ____   _________________________
                #//¯¯\\__[___ Images Scaffold ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Collecting [~]" "Windows Client/Server Images"

                    $WimImages  = $DS | ? { $_ -like "*Images*" }

                    0..6 | % { $X = $Tag[$_] ; "$WimImages\($_)$X" | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory ; NI "$_\_" -ItemType Directory } } 
            
                    Write-Theme -Action "Forward Image [+]" "Scaffold Generated"
                # ____   _________________________
                #//¯¯\\__[____ ISO Scaffold _____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    ForEach ( $i in @( "1607" ; 64 , 32 | % { "1909_x$_" } ) ) { "$WimImages\ISO\$I" | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory } } 
                    
                    Write-Theme -Action "Windows Media [+]" "Scaffold Generated"
                # ____   _________________________
                #//¯¯\\__[___ Clean Source ISO __] [ Server 2016 Eval / 1909 x86 / x64 ]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Initializing [+]" "Retrieving Images Directly from Microsoft"

                    [ Net.ServicePointManager ]::SecurityProtocol = [ Net.SecurityProtocolType ]::TLS12

                    IPMO BitsTransfer 

                    $ISO    = ( GCI "$WimImages\ISO" | % { $_.FullName } )[0,2,1]

                    $Client = 64 , 32 | % { "https://software-download.microsoft.com/db/Win10_1909_English_x$_.iso?t=b56fde02-8f2e-4c09-9a2d-e93a99596203" }

                    $Splat  = 0..2
                # ____   _________________________
                #//¯¯\\__[_____ Server 2016 _____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Splat[0]  = @{    Source = "https://software-download.microsoft.com/download/pr/Windows_Server_2016_Datacenter_EVAL_en-us_14393_refresh.ISO"
                                  Destination = "$( $ISO[0] )\1607.ISO"    
                                  Description = "Windows Server ( 1607.ISO ) [ Evaluation Copy ]" }
                # ____   _________________________
                #//¯¯\\__[___ Client x64 1909 ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Splat[1]  = @{    Source = "$( $Client[0] )&e=1574831548&h=0898529f30d00f99cd6fdd9b889a43f7"
                                  Destination = "$( $ISO[1] )\1909x64.iso" 
                                  Description = "Windows Client ( 1909_x64.ISO )" }
                # ____   _________________________
                #//¯¯\\__[___ Client x32 1909 ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Splat[2]  = @{    Source = "$( $Client[1] )&e=1574831549&h=f44e9f4e43ccd7bc7fdd3ee618073bfa"
                                  Destination = "$( $ISO[2] )\1909x32.iso"
                                  Description = "Windows Client ( 1909_x32.ISO )" }
                # ____   _________________________
                #//¯¯\\__[___ Clean Source ISO __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    0..2 | % { $X = $Splat[$_] ; If ( ! ( Test-Path $X.Destination ) ) { Write-Theme -Action "Downloading [+]" $X.Description ; Start-BitsTransfer @X } }
                # ____   _________________________
                #//¯¯\\__[___ Clean Source ISO __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Processing [+]" "ISO -> WIM File Conversion"
                    
                    $Dest   = ( GCI $WimImages | % { $_.FullName } )[0..6]
                    
                    $DN     = ( @( "Server 2016 Datacenter x64" ; "Education" , "Home" , "Pro" | % { "10 $_" } | % { "$_ x64" , "$_ x86" } ) | % { "Windows $_" } )
                    
                    $IP     = ( GCI $ISO *.iso* | % { $_.FullName } )[ 0 , 1 , 2 , 1 , 2 , 1 , 2 ]
                    
                    $SI     = 4 , 4 , 4 , 1 , 1 , 6 , 6
                    
                    $SIP    = "$( 67..90 | % { [ Char ]$_ } | ? { $_ -notin ( Get-Volume | % { $_.DriveLetter } | Sort ) } | Select -First 1 ):\Sources\Install.WIM"

                    $DIP    = 0..6 | % { "$( $Dest[$_] )\$( $Tag[$_] ).wim" }

                    0..6 | % {

                        Write-Theme -Action "Extracting [~]" $DN[$_]

                        Mount-DiskImage -ImagePath $IP[$_]

                        $Splat = @{ SourceIndex          = $SI[$_]
                                    SourceImagePath      = $SIP
                                    DestinationImagePath = $DIP[$_]
                                    DestinationName      = $DN[$_] }
                        
                        Export-WindowsImage @Splat

                        Dismount-DiskImage -ImagePath $IP[$_]
                    }
                    
                    $List = 0..6 | % { Get-WindowsImage -ImagePath $DIP[$_] -Index 1 } | % { 
                        
                        [ PSCustomObject ]@{ 
                            
                            ImageName        = $_.ImageName
                            Architecture     = $_.Architecture | % { If ( $_ -eq 0 ) { "x86" } If ( $_ -eq 9 ) { "x64" } }
                            Version          = $_.Version
                            InstallationType = $_.InstallationType
                            CreatedTime      = $_.CreatedTime
                            ModifiedTime     = $_.ModifiedTime 
                        }
                    }

                    $Subtable = @( )

                    $FX       = @( "ImageName" , "Architecture" , "Version" , "InstallationType" ; "Created" , "Modified" | % { "$_`Time" } )

                    ForEach ( $i in 0..6 )
                    {
                        $Splat = @{ Items  = $FX
                                    Values = $FX | % { "$( $List[$I].$_ )" } }
                        
                        $Subtable    += New-SubTable @Splat
                    }

                    $Panel = @{ Title = "Clean Windows Image ( WIM ) Storage List"
                                Depth = 7
                                ID    = 0..6 | % { "( [ Image # $_ ] )" }
                                Table = 0..6 | % { $Subtable[$_]   } }

                    $Table = New-Table @Panel

                    Write-Theme -Table $Table

                    Return $List
        }

        If ( $Slipstream )
        {
                # ____   _________________________
                #//¯¯\\__[___ Updates Scaffold __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Updates = "$( $DS[2] )\Updates" | % { If ( ! ( Test-Path $_ ) ) { NI $_ -ItemType Directory } Else { GI $_ } } | % { $_.FullName }

                    ForEach ( $i in "Server" , "Client" )
                    { 
                        "$Updates\$I" | ? { ! ( Test-Path $_ ) } | % { 
                        
                            NI $_ -ItemType Directory 

                            Write-Theme -Action "Created [+]" "( $I ) Update Directory"
                        }

                        ForEach ( $j in 86 , 64 )
                        {
                            "$Updates\$I\x$J" | ? { ! ( Test-Path $_ ) } | % { 
                            
                                NI $_ -ItemType Directory 
                            
                                Write-Theme -Action "Created [+]" "( $I\x$J ) Update Directory"
                            }
                        }
                    }

                    Write-Theme -Action "Windows Update [+]" "Scaffold Generated"

                    $Path = GCI $DS[2] *.wim* -Recurse | % { $_.FullName }

                    $List = $Path | % { Get-WindowsImage -ImagePath $_ -Index 1 }
                    
                    $Type = [ PSCustomObject ]@{ Server = @{ x64 = @( ) ; x86 = @( ) } ; Client  = @{ x64 = @( ) ; x86 = @( ) } }

                    0..( $List.Count - 1 ) | % {

                        $X = $List[$_]

                            $X.InstallationType | % { $InstallType = $( If ( $_ -eq "Server" ) { "Server" } If ( $_ -eq "Client" ) { "Client" } ) }
                            $X.Architecture     | % { $InstallArch = $( If ( $_ -eq        9 ) {    "x64" } If ( $_ -eq        0 ) {    "x86" } ) }

                        $Type.$InstallType.$InstallArch += [ PSCustomObject ]@{ 
                        
                            WIMFile     = $Path[$_]
                            MountDir    = $Path[$_] | % { $_.Replace( $_.Split('\')[-1] , "_" ) }
                            PackagePath = "$Updates\$InstallType\$InstallArch"
                            Name        = $List[$_].ImageName
                            Version     = $List[$_].Version
                        }
                    }

                    $Process = $Type | % { $_.Server , $_.Client | % { $_.x64 , $_.x86 } }

                    ForEach ( $I in 0..( $Process.Count - 1 ) )
                    {
                        $Process[$I] | % { 
                        
                            If ( ( $_ -ne $Null ) -and ( ( GCI $_.PackagePath *.msu* ) -ne $Null ) ) 
                            {
                                Write-Theme -Action "Detected [+]" "Update Image Catalog"

                                $Splat = @{ ImagePath = $_.WimFile 
                                            Index     = 1
                                            Path      = $_.MountDir }

                                Write-Theme -Action "Mounting [~]" "$( $_.Name )"

                                Mount-WindowsImage @Splat

                                $Splat = @{ PackagePath = $_.PackagePath
                                            LogPath     = "AddPackage.log" 
                                            IgnoreCheck = $True }
                            
                                Write-Theme -Action "Processing [~]" "Update Packages"
                                    
                                Add-WindowsPackage @Splat

                                Write-Theme -Action "Cleaning [~]" "Component Store Cleanup"

                                DISM /Image:$( $_.MountPath ) /Cleanup-Image /StartComponentCleanup /ResetBase
                            
                                Write-Theme -Action "Dismounting [~]" "$( $_.Name )"

                                DISM /Unmount-WIM /MountDir:$( $_.MountDir ) /Commit

                                Write-Theme -Action "Complete [+]" "$( $_.Name )"
                            }
                        }
                    }
                
                    Write-Theme -Action "Updated [+]" "Imaging Catalog"
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____   
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Update-Branding # Updates the branding ( TEH WEI KING ) ___________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯       
        [ CmdLetBinding () ] Param (

            [ Parameter ( Mandatory = $True ) ] [ String ] $Logo ,
            [ Parameter ( Mandatory = $True ) ] [ String ] $Background ,
            [ Parameter ( Mandatory = $True ) ] [ String ] $Network    )

        $SD , $SR , $SYS , $PGD = @( $env:SystemDrive ; $env:SystemRoot | % { $_ , "$_\System32" } ; $env:ProgramData )

        If ( $Network )
        {
            $Root = Resolve-HybridDSC -DeploymentServer
        }
    
        Else 
        {
            $Root = Resolve-HybridDSC -Share
        }
    
        # Build Registry Tree
        $Registry  = [ PSCustomObject ]@{ 

            Hive   = "CU" , "LM" , "LM" , "LM"  | % { "HK$_`:\Software" }
            Link   = "" , "" , "" , "Policies\" | % { "$_`Microsoft\Windows" }
            Mark   = @( "Policies\System" , "OEMInformation" , "Authentication\LogonUI\Background" | % { "CurrentVersion\$_" } ; "Personalization" )
    
        }

        # Registry Links

        $REX       = 0..3 | % { "$( $Registry.Hive[$_] )\$( $Registry.Link[$_] )\$( $Registry.Mark[$_] )" }
    
        # File Links

        $FEX       = @( @( "" ; "" , "\Backgrounds" | % { "\OOBE\Info$_" } ) | % { "$SYS$_" } ; 
                        @( "Screen" , "Wallpaper\Windows" | % { "$SR\Web\$_" } ; "$PGD\Microsoft\User Account Pictures" ) )
    
        # New Items

        $FEX[2]   | ? { ! ( Test-Path $_ ) } | % { # OEM Background Folder
    
            NI $_ -ItemType Directory
            Write-Theme -Action "Created [+]" "OEM Background Directory"

        }

        $REX[3,1] | ? { ! ( Test-Path $_ ) } | % { #
    
            $X = $_.Split( '\' )[-1]
            NI $_ -Name $X
            Write-Theme -Action "Created [+]" "Registry Key / $X"
    
        }

        # Copy Items 

        $FEX[0,1,5] | % { CP $Root.Logo       $_ -VB } # Logo
        $FEX[2..4]  | % { CP $Root.Background $_ -VB } # Background

        $Properties = [ PSCustomObject ]@{

            Path    = $REX[0,0,1,1,1,1,1,3,2]

            Name    = @( "" , "Style" | % { "Wallpaper$_" } ; "Logo" , "Manufacturer" ; "Phone" , "Hours" , "URL" | % { "Support$_" } ; 
                         "LockScreenImage" , "OEMBackground" )

            Value   = $Root | % { "$( $FEX[4] )\$( $_.Background )" , 2 , "$SYS\$( $_.Logo )" , $_.Company , $_.Phone , $_.Hours , $_.WWW , 
                      "$( $FEX[3] )\$( $_.Background )" , 1 }
    
        }

        # Set Properties
        0..8        | % { SP $PEX[$_] -Name $NEX[$_] -Value $VEX[$_] -VB }          #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-LocalMachine # Turns local machine information into an object _____//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        $Local = @( $Env:ComputerName , $Env:Processor_Architecture , "$Env:SystemDrive\" ; $Env:SystemRoot | % { "$_" , "$_\System32" } ; 
        $Env:ProgramData , $Env:ProgramFiles )
        
        Return [ PSCustomObject ]@{ 
            
            ComputerName  = $Local[0]
            Architecture  = $Local[1]
            SystemDrive   = $Local[2]
            SystemRoot    = $Local[3]
            System32      = $Local[4]
            ProgramData   = $Local[5]
            ProgramFiles  = $Local[6]
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Unlock-Script # Allows for elevation ( Not Finished ) _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ ValidateScript ({ Test-Path $_ })] 

            [ Parameter ( Mandatory ) ] [ String ] $FilePath     ,
            [ Parameter ( Mandatory ) ] [ String ] $ArgumentList )

        
        $CS = GCIM Win32_OperatingSystem

        "Security.Principal.Windows" | % { IEX "( [ $_`Principal ] [ $_`Identity ]::GetCurrent() ).IsInRole( 'Administrator' )" }

        !$? | % { 
        
            GCIM Win32_OperatingSystem | % { 
        
                If ( [ Int ]$_.BuildNumber -gt 6000 )
                {
                    Set-ExecutionPolicy ByPass -Scope Process -Force
                }

                Else
                {
                    Read-Host "[!] Access Failed. Press Enter to Exit"
                    Break
                }
            }
        }

        $? | % { 
            
            $Process                          = New-Object System.Diagnostics.Process
            $Process                          | % { 

                $_.StartInfo                  = New-Object System.Diagnostics.ProcessStartInfo( $FilePath , $ArgumentList )
                $_.StartInfo                  | % { 
    
                    $_.RedirectStandardOutput = $True
                    $_.UseShellExecute        = $False
                    $_.WindowStyle            = [ System.Diagnostics.ProcessWindowStyle ]::Hidden
                }
    
                $_.Start()                    | Out-Null
                $_.BeginOutputReadLine()
                $_.WaitForExit()
                $exitCode                     = $_.ExitCode
                $_.Dispose()
            }
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Export-BridgeScript # Exports the bridge script ___________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Resolve-HybridDSC -Domain | % { 
    
            $NetBIOS    = $_.NetBIOS
            $DNS        = $_.Branch
            $Domain     = $_.Domain 
        }

        $Root = Resolve-HybridDSC -Share 
        
        $Root | % {

            $Company    = $_.Company 
            $Server     = $_.Server
            $Drive      = $_.DSDrive.Replace( ":" , "" )
            $DeployRoot = "\\$Server\$( $_.Samba )"
            $HybridRoot = "$DeployRoot\$( $_.Company )"
        }

        If ( $Domain )
        {
            Write-Theme -Action "Detected [+]" "Domain Environment, loading ADDS Login"

            $DCCred = Invoke-Login -DC ( $Root.Server ) -Domain $DNS
        }

        If ( ! $Domain )
        {
            Write-Theme -Action "Detected [+]" "Workgroup Environment, loading Local User Login"
            
            Do
            {
                Add-Type -AssemblyName System.DirectoryServices.AccountManagement

                $DCCred = Get-Credential
        
                $X      = $DCCred | % { Get-LocalUser -Name $_.UserName -EA 0 }
        
                $Y      = [ System.DirectoryServices.AccountManagement.PrincipalContext ]::New( "Machine" , $ENV:ComputerName ) | % { 
        
                    $_.ValidateCredentials( $DCCred.UserName , $DCCred.GetNetworkCredential().Password ) | ? { $True }
                
                }

                If ( ( $X -eq $Null ) -or ( $X.Enabled -ne $True ) -or ( $Y -eq $False ) )
                {
                    Switch( $Host.UI.PromptForChoice( "Invalid Credential" , "Attempt login again?" , 
                    [ System.Management.Automation.Host.ChoiceDescription [] ]@( "&Yes" , "&No" ) , [ Int ] 0 ) )
                    {
                        0 { $DCCred = $Null } 1 { $Exit = 1 }
                    }
                }
        
                Else
                {
                    Return $DCCred
                }
            }

            Until ( ( $DCCred -ne $Null ) -or ( $Exit -eq 1 ) )
        }

        $RootVar         = [ PSCustomObject ]@{

            Company      = $Company
            NetworkShare = $DeployRoot
            DSDrive      = $Drive
            Description  = $Root.Description
            Server       = $Server
            DomainUser   = $DCCred.UserName
            DomainPass   = $DCCred.GetNetworkCredential().Password
            Website      = $Root.WWW
            Phone        = $Root.Phone
            Hours        = $Root.Hours
            Logo         = GCI $HybridRoot "*$( $Root.Logo.Split('\')[-1] )*" -Recurse | % { $_.FullName }
            Background   = GCI $HybridRoot "*$( $Root.Background.Split('\')[-1] )*" -Recurse | % { $_.FullName }
            Certificate  = ""
            Domain       = $DNS
            LocalUser    = $Root.LMCred_User
            LocalPass    = $Root.LMCred_Pass
            Proxy        = $Root.IIS_Proxy
            NetBIOS      = $NetBIOS
            Directory    = $Root.Directory
        }

        SC "$DeployRoot\root.txt" -Value ( $RootVar | ConvertTo-JSON )
        SC "$Env:AppData\root.txt" -Value ( $RootVar | ConvertTo-JSON )

        <# Variables #> # $DeployRoot\root.txt
        <#    Script #> # $DeployRoot\Scripts\Initialize-Hybrid.ps1
        <#     Timer #> # $DeployRoot\Scripts\New-RunScheduledTask.ps1

        $Return = @"
       
        `$DeployRoot   = "$( $Rootvar.NetworkShare )"
        `$Root         = '$( GC "$DeployRoot\root.txt" )' | ConvertFrom-JSON
        `$Company      = "$( $Root.Company )"
        `$Timer , `$Hybrid = "New-RunScheduledTask" , "Initialize-Hybrid" | % {

            "`$DeployRoot\Scripts\`$_.ps1"
        }
        
        CP "`$DeployRoot\root.txt" "`$Env:AppData\root.txt"

        SAPS PowerShell -Verb RunAs -ArgumentList "-File `$Timer -Args -Path `$Hybrid"
"@

        SC "$DeployRoot\Scripts\Import-BridgeScript.ps1" $Return -Force -VB         #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Update-HybridDSC # Recycles *all* Deployment Share Content ________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        Write-Theme -Action "Provision Root [~]" "MDT Imaging/Task Sequence Recycler"

                # ____   _________________________
                #//¯¯\\__[___ Provisional Root __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Root                  = Resolve-HybridDSC -Share

                    $Section               = 0..2
                    $SubTable              = 0..2

                    $Root                  | % { 

                        $Provision         = [ PSCustomObject ]@{ 
            
                            Name           = $_.Company
                            Controller     = $_.Server
                            PSDrive        = $_.DSDrive.Replace( ':' , '' )
                            SMBShare       = $_.Samba
                            NetworkPath    = "\\$( $_.Server )\$( $_.Samba )"
                            HybridRoot     = "\\$( $_.Server )\$( $_.Samba )\$( $_.Company )"
                        }
                    }

                    $Section[0]            = "Desired State Controller @ Source"

                    $Names                 = ( $Provision | GM | ? MemberType -EQ NoteProperty | % { $_.Name } )[2,0,4,5,3,1]
                    $Values                = $Names | % { $Provision.$_ }

                    $Subtable[0]           = New-Subtable -Items $Names -Values $Values
                # ____   _________________________
                #//¯¯\\__[___ Local Variables ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Local                 = Resolve-LocalMachine

                    $Section[1]            = "Current Machine @ Variables"
                    $Names                 = ( $Local | GM | ? MemberType -EQ NoteProperty | % { $_.Name } )[1,0,5,6,4,2,3]
                    $Values                = $Names | % { $Local.$_ }

                    $Subtable[1]           = New-Subtable -Items $Names -Values $Values
                # ____   _________________________
                #//¯¯\\__[___ Bridge Variables __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Target                = [ PScustomObject ]@{ 
            
                        Path               = "$ENV:SystemDrive\$( $Root.Company )"
                    }

                    $Tree                  = "Resources" , "Tools" , "Images" , "Profiles" , "Certificates" , "Applications"

                    0..( $Tree.Count - 1 ) | % { 
            
                        $Splat             = @{ MemberType = "NoteProperty"
                                                Name       = $Tree[$_]
                                                Value      = "$( $Target.Path )\($_)$( $Tree[$_] )" 
                        }
                
                        $Target            | Add-Member @Splat 
                    }

                    $Section[2]            = "Provision Index @ Bridge Control"

                    $Names                 = ( $Target | GM | ? MemberType -EQ NoteProperty | % { $_.Name } )[3,5,6,2,4,1,0]
                    $Values                = $Names | % { $Target.$_ }

                    $Subtable[2]           = New-Subtable -Items $Names -Values $Values
                # ____   _________________________
                #//¯¯\\__[____ Display Panel ____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Panel                 = @{ Title = "Provisional Root Index"
                                                Depth = 3
                                                ID    = $Section | % { "( $_ )" }
                                                Table = $Subtable }

                    $Table                 = New-Table @Panel

                    Write-Theme -Table $Table -Prompt "Press Enter to Continue, or CTRL+C to Exit"
                # ____   _________________________
                #//¯¯\\__[__ Get Deploy/Share  __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Loading [+]" "MDT Drive Content"

                    Import-MDTModule

                    $X = GDR -PSProvider MDTProvider

                    If ( $X -ne $Null )
                    {
                        $X = $X | ? { $_.Name -like "*$( $Root.DSDrive.Split(':')[0] )*" -and $_.Root -eq $Root.Directory }
                    }
                    
                    If ( $X -eq $Null )
                    {
                        $X = Get-MDTPersistentDrive
                        
                        If ( $X -eq $Null )
                        {
                            $Root | % { 

                                $Splat = @{ Name        = $_.DSDrive.Split(':')[0]
                                            PSProvider  = "MDTProvider"
                                            Root        = $_.Directory
                                            Description = $_.Description
                                            NetworkPath = $Provision.NetworkPath }
                            }

                            NDR @Splat -VB | Add-MDTPersistentDrive
                        }

                        If ( $X -ne $Null )
                        {
                            GSMBS | ? { $_.Path -eq $X.Path } | % {
                            
                                $Splat = @{ Name        = $X.Name
                                            PSProvider  = "MDTProvider"
                                            Root        = $_.Path
                                            Description = $X.Description 
                                            NetworkPath = "\\$ENV:ComputerName\$( $_.Path )" }
                            }
                            
                            NDR @Splat -VB
                        }
                    }
                # ____   _________________________
                #//¯¯\\__[_ Shape Variable Tree _]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $DeployRoot = Resolve-HybridDSC -Share | % { gci $_.Directory } | % { $_.FullName }
                    
                    $HybridRoot = $DeployRoot | ? { $_ -like "*$( $Root.Company )*" } | % { gci $_ } | % { $_.FullName }

                    $Tag        = @( "DC2016" ; "E" , "H" , "P" | % { "10$_`64" , "10$_`86" } )

                    $Names      = @( 'ImageName' , 'Architecture' , 'Version' , 'InstallationType' ; 'Created' , 'Modified' | % { "$_`Time" } )
                # ____   _________________________
                #//¯¯\\__[__ Get Stored Images __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Catalog    = @{ 
                    
                        Hybrid  = @{ Title  = "Hybrid-DSC Client/Server Windows Image Recycler Panel"
                                     Images = $HybridRoot | ? { $_ -like           "*Images*" } | % { gci $_ *.wim* -Recurse } | % { $_.FullName } }

                        Deploy  = @{ Title  = "MDT Boot Image Client/Server Windows Image Panel"
                                     Images = $DeployRoot | ? { $_ -like "*Operating System*" } | % { gci $_ *.wim* -Recurse } | % { $_.FullName } }
                    }

                    $Catalog    | % { $_.Deploy , $_.Hybrid } | % { 

                        $Title  = $_.Title 
                        $Images = $_.Images
                        
                        If ( $Images -eq $Null )
                        {
                            Write-Theme -Action "Not Detected [!]" "$Title"
                        }

                        Else
                        {                    
                            If ( $Images.Count -eq 1 )
                            {
                                Write-Theme -Action "Detected [+]" "( 1 ) Image, obtaining details"
                        
                                $Count      = 0

                                $List       = Get-WindowsImage -ImagePath $Images -Index 1
                            }

                            If ( $Images.Count -gt 1 ) 
                            { 
                                Write-Theme -Action "Detected [+]" "( $( $Images.Count ) ) Images, obtaining details"
                        
                                $Count      = 0..( $Images.Count - 1 )

                                $List       = $Count | % { Get-WindowsImage -ImagePath $Images[$_] -Index 1 }
                            }

                            $Store = $List  | % { 
                        
                                [ PSCustomObject ]@{ 
                            
                                        ImageName        = $_.ImageName
                                        Architecture     = @( "x86" ; 1..8 | % { "" } ; "x64" )[ $_.Architecture ]
                                        Version          = $_.Version
                                        InstallationType = $_.InstallationType
                                        CreatedTime      = $_.CreatedTime
                                        ModifiedTime     = $_.ModifiedTime 
                                }
                            }
                    
                            $Panel = @{ Title = $Title ; Depth = "" ; ID = "" ; Table = "" }

                            If ( $Images.Count -eq 1 )
                            {
                                $Values      = $Names | % { "$( $Store.$_ )" }
                      
                                $Section     = $Store.ImageName

                                $Subtable    = New-SubTable -Items $Names -Values $Values

                                $Panel       | % { 

                                    $_.Depth = 1
                                    $_.ID    = "( $( $Section ) )"
                                    $_.Table = $Subtable 
                                }
                            }

                            If ( $Images.Count -gt 1 )
                            {
                                $Count        = 0..( $Store.Count - 1 )

                                $Section      = $Count | % { $_ }
                                $Subtable     = $Count | % { $_ }

                                ForEach ( $I in $Count )
                                { 
                                    $X            = $Store[$I] 

                                    $Values       = $Names | % { "$( $X.$_ )" }
                      
                                    $Section[$I]  = $X.ImageName
                            
                                    $Subtable[$I] = New-SubTable -Items $Names -Values $Values
                                }

                                $Panel        | % { 
                                        
                                    $_.Depth  = $Store.Count
                                    $_.ID     = $Count | % { "( $( $Section[$_] ) )" }
                                    $_.Table  = $Count | % { $Subtable[$_] }
                                }
                            }

                            $Table = New-Table @Panel

                            Write-Theme -Table $Table

                            Read-Host "$( "¯" * 116 )`nCarefully review these details. `nPress Enter to Continue"
                        }
                    }
                # ____   _________________________
                #//¯¯\\__[____ Recycle DISM _____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $DeployRoot  | ? { $_ -like "*Operating Systems*" } | % { GCI $_ } | ? { $_ -ne $Null } | % { RI $_.FullName -Recurse -Force -VB }
    
                    $Output      = $HybridRoot | ? { $_ -like "*Images*" } 
                    
                    $Output      | % { gci $_ *.wim* } | ? { ! $Null } | % { RI $_.FullName -VB }
                    
                    $Destination = "$Output\$( Get-Date -UFormat "%m%d%Y" )"

                    $Names       = @( "ImagePath" , "Index" | % { "Source$_" } ; "ImagePath" , "Name" | % { "Destination$_" } )

                    ForEach ( $I in 0..( $Store.Count - 1 ) )
                    {
                        $Splat = @{ 

                                SourceImagePath      = $Catalog.Hybrid.Images[$I]
                                SourceIndex          = 1
                                DestinationImagePath = "$Destination.x$( $Store.InstallationType[$I] )_$( $Store.Version[$I] ).wim"
                                DestinationName      = $Store.ImageName[$I]
                                Verbose              = $True
                        }

                        $Values = $Names | % { $Splat.$_ }

                        New-SubTable -Items $Names -Values $Values | % { 

                            New-Table -Title "DISM -> MDT" -Depth 1 -ID "( $( $Tag[$I] ) )" -Table $_ | % {

                                Write-Theme -Table $_
                            }
                        }

                        Export-WindowsImage @Splat
                    }
                # ____   _________________________
                #//¯¯\\__[__ Clear MDT Content __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $MDTOS  = $DeployRoot | ? { $_ -like "*Operating Systems*" } 
                    
                    $MDTOS  | % { GCI $_ } | ? { ! $Null } | % { RI $_.FullName -VB -Recurse -Force }
                    
                    $Paths  = "Operating Systems" , "Task Sequences" | % { "$( $Root.DSDrive )\$_" } 
                    
                    ForEach ( $i in $Paths )
                    {
                        GCI $I | % { 
                        
                            Write-Theme -Action "Relinquishing [+]" "$I\$( $_.Name )" 12 4 15
                            RI "$I\$( $_.Name )" -Recurse -Force }
                    }
                # ____   _________________________
                #//¯¯\\__[____ Recycle MDT ______]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Output | % { GCI $_ *.wim* } | % { 

                        $File = $_.FullName
                    
                        $Parent , $Child = $_.BaseName.Split( '_' )

                        $Parent = $Parent.Split( 'x' )[-1]

                        "Operating Systems" , "Task Sequences" | % { 

                            $Splat = @{ Path     = "$( $Root.DSDrive )\$_"
                                        Enable   = "True"
                                        Name     = "$Parent"
                                        Comments = "$( Get-Date -UFormat "%m%d%Y" )"
                                        ItemType = "Folder" }
                            
                            Write-Theme -Action "Generating [+]" "$( $Splat.Path )\$Parent"
                            
                            New-Item @Splat | Out-Null

                            $Splat | % { 
                            
                                $_.Path = "$( $_.Path )\$Parent"
                                $_.Name = "$Child"
                            }

                            Write-Theme -Action "Generating [+]" "$( $Splat.Path )\$Child"

                            New-Item @Splat | Out-Null
                        }

                        $Splat = @{ Path              = "$( $Root.DSDrive )\Operating Systems\$Parent\$Child" 
                                    SourceFile        = $File
                                    DestinationFolder = $Child
                                    Move              = $True   }
                        
                        Write-Theme -Action "Importing [+]" "Operating System Image File" 11 11 15

                        Import-MDTOperatingSystem @Splat | Out-Null
                    }
                # ____   _________________________
                #//¯¯\\__[____ Task Sequences ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Control = gci $Output "*Control*" | % { $_.FullName }

                    $TMPL    = $( If ( $Root.Remaster -eq "-" ) { "MDT" } If ( $Root.Legacy -eq "-" ) { "PSD" } ) 

                    ForEach ( $I in "Server" , "Client" )
                    {
                        $TS , $OS = "Task Sequences" , "Operating Systems" | % { "$( $Root.DSDrive )\$_\$I" }

                        $Build = GCI $OS | % { $_.Name }

                        $List = @( )
                        $GUID = @( )

                        $Swap = GCI "$OS\$Build" 
                        
                        $Swap | % { $List += $_.Name ; $GUID += $_.GUID }

                        ForEach ( $J in 0..( $List.Count - 1 ) )
                        {
                            $HEX = "$Control\$TMPL$I`Mod.xml"

                            $TEX = GC $HEX

                            0..( $TEX.Count - 1 ) | % {

                                If ( $TEX[$_] -like "*OSGUID*" )
                                { 
                                    $TEX[$_] = ( $TEX[$_] | % { $_.Split( '{' )[0] , $GUID[$J] , $_.Split( '}' )[1] } ) -join ''
                                }
                            }

                            SC $HEX -Value $TEX

                            $List[$J] | % { 

                                If ( $_ -like "*Server*" )
                                {
                                    $Name = "DC2016"
                                }

                                If ( $_ -notlike "*Server*" )
                                {
                                    $Arch = $( If ( $_ -like "*x64*" ) { "64" } If ( $_ -like "*x86*" ) { "86" } )
                                    
                                    $Name = "10$( If ( $_ -like "*Educ*" ) { "E" } If ( $_ -like "*Home*" ) { "H" } If ( $_ -like "*Pro*" ) { "P" } )$Arch"
                                }
                            }

                            $Splat = @{ Path                = "$TS\$Build"
                                        Name                = "$Name"
                                        Template            = "$HEX"
                                        Comments            = "Secure Digits Plus LLC [ Fighting Entropy ]"
                                        ID                  = "$Name"
                                        Version             = "1.0"
                                        OperatingSystemPath = "$OS\$Build\$( $List[$J] )"
                                        FullName            = $Root.LMCred_User
                                        OrgName             = $Root.Company
                                        HomePage            = $Root.WWW
                                        AdminPassword       = $Root.LMCred_Pass }

                            Write-Theme -Action "Importing [+]" "Task Sequence $Name"

                            Import-MDTTaskSequence @Splat | Out-Null

                        }
                    }

                    Write-Theme -Action "Imported [+]" "Task Sequences"
                # ____   _________________________
                #//¯¯\\__[____ Share Settings ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Names  = @( "Comments" , "MonitorHost" ; 64 , 86 | % { "Boot.x$_" } | % { "$_.GenerateLiteTouchISO" ; "$_.LiteTouch" | % { 
                                 "$_`WIMDescription" , "$_`ISOName" } ; "$_.BackgroundFile" } )

                    $Values = @( "Secure Digits Plus LLC : Fighting Entropy ($( [ Char ]960 ))" , 
                                 $Root.Server ; 64 , 86 | % { "True" ; "$( $Root.Company ) (x$_)" | % { "$_" , "$_.iso" } ; $Root.Background } )

                    ForEach ( $i in 0..9 )
                    {
                        SP $Root.DSDrive -Name $Names[$I] -Value $Values[$I]
                        Write-Host ( "_" * 116 )
                        Write-Theme -Function "$( $Names[$I] )" 11 11 15
                        Write-Theme -Action "Configured [+]" "$( $Values[$I] )" 11 11 15
                        Write-Host ( "¯" * 116 )
                    }
                # ____   _________________________
                #//¯¯\\__[__ Enable Monitoring __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Resetting [~]" "MDT Monitor Service"
                    
                    ( Disable-MDTMonitorService -EA 0 )
                
                    $Splat = @{ 
                    
                        EventPort = 9800
                        DataPort  = 9801 
                    }

                    Enable-MDTMonitorService @Splat

                    $DeployRoot | % { 
                    
                        $CTRL   = $_ | ? { $_ -like "*Control*" }
                        $Script = $_ | ? { $_ -like "*Scripts*" }
                    }

                # ____   _________________________
                #//¯¯\\__[____ Bridge Script ____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Login [~]" "Provide a valid Deployment Credential"

                    Export-BridgeScript
                # ____   _________________________
                #//¯¯\\__[____ Bootstrap INI ____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $BootStrap                 = @{ 
                    
                        Settings               = @{ 
                        
                            Priority           = "Default" 
                        } 
                        
                        Default                = @{ 
                        
                            DeployRoot         = $Provision.NetworkPath
                            UserID             = $DCCred.Username
                            UserPassword       = $DCCred.GetNetworkCredential().Password
                            UserDomain         = $Root.Branch 
                            SkipBDDWelcome     = "YES" 
                        } 
                    }

                    $Splat                     = @{ 
                    
                        Path                   = $CTRL
                        Name                   = "Bootstrap.ini"
                        Value                  = $Bootstrap
                        Encoding               = "UTF8"
                        UTF8NoBom              = $True 
                        Force                  = $True 
                    }

                    Export-Ini @Splat
                # ____   _________________________
                #//¯¯\\__[_ CustomSettings INI __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $CustomSettings            = @{ 
                    
                        Settings               = @{ 
                        
                            Priority           = "Default" 
                            Properties         = "MyCustomProperty" 
                        } 
                        
                        Default                = @{

                            _SMSTSOrgName      = "$( $Root.Company )" 
                            OSInstall          = "Y" 
                            SkipCapture        = "NO" 
                            SkipAdminPassword  = "YES" 
                            SkipProductKey     = "YES" 
                            SkipComputerBackup = "NO" 
                            SkipBitLocker      = "YES" 
                            KeyboardLocale     = "en-US" 
                            TimeZoneName       = "$( ( Get-TimeZone ).ID )" 
                            EventService       = "http://$( $Root.Server ):9800" 
                        } 
                    }

                    $Splat                     | % { 
                    
                        $_.Name                = "CustomSettings.ini"
                        $_.Value               = $CustomSettings 
                    }

                    Export-Ini @Splat
                # ____   _________________________
                #//¯¯\\__[_____ PXE Graphics ____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    "computer.png" , "header-image.png" | % { 
                    
                        CP "$Control\$_" "$Script\$_" -Force 

                        Write-Theme -Action "Copied [+]" "PXE Graphic ( $_ )" 11 11 15
                    }
                # ____   _________________________
                #//¯¯\\__[___ MDT Boot Images ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Updating [~]" "Deployment Share"

                    Update-MDTDeploymentShare -Path $Root.DSDrive -Force -VB
                # ____   _________________________
                #//¯¯\\__[___ WDS Boot Images ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $OEM , $LT = $Provision.Name.Replace( ' ' , '_' ) , "LiteTouchPE"

                    $Boot      = $Root.Directory | % { GCI $_ *Boot* } | % { $_.FullName }

                    $Boot      | % { GCI $_ *$OEM* } | % { RI $_.FullName -VB }

                    $Boot      | % { GCI $_  *$LT* } | % { RNI $_.FullName -NewName $_.FullName.Replace( $LT , $OEM ) -VB }

                    $WDSImages = $Boot | % { GCI $_ *.wim* } 
                    
                    ForEach ( $I in 0..1 )
                    {
                        $Path  = ( $WDSImages | % { $_.FullName })[$I]
                        $Arch  = ( 64 , 86 )[$I]
                        $Name  = ( $WDSImages | % { Get-WindowsImage -ImagePath $_.FullName } | % { $_.ImageName })[$I]
                                              
                        Get-WDSBootImage -Architecture "X$Arch" -ImageName $Name -EA 0 | ? { ! $Null } | % {

                            Write-Theme -Action "Found [~]" "$Name"
                            
                            Remove-WDSBootImage -Architecture "x$Arch" -ImageName $Name

                            Write-Theme -Action "Removed [+]" "$Name"
                        }

                        Write-Theme -Action "Importing [~]" "$Name"

                        Import-WDSBootImage -Path $Path -NewDescription $Name -SkipVerify
                    
                    }

                    Write-Theme -Action "Complete [+]" "WDS Boot Images Recyled"
                # ____   _________________________
                #//¯¯\\__[_ Restart WDS Service _]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    Write-Theme -Action "Restarting [~]" "WDS Service"

                    Restart-Service -Name WDSServer

                    If ( $? -eq $True ) 
                    { 
                        Write-Theme -Foot
                        Write-Theme -Action "Successful [+]" "Hybrid-DSC Fully Recycled"
                    }

                    Else
                    { 
                        Write-Theme -Action "Exception [!]" "The WDS Service has experienced an issue" 12 4 15
                    } 
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-CurrentServices # Retrieves/Displays Current Services _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        # Based on MadBomb122/Black Viper's Service Configurations in 'Use-ViperBombServices'

        [ CmdLetBinding () ] Param (

            [ Parameter ( ParameterSetName = "Theme" ) ] [ Switch ] $Display )

        $Return                  = GCIM Win32_Service | % { [ PSCustomObject ]@{ 
            
                Status           = $_.State
                StartType        = $_.StartMode
                Name             = $_.Name 
                DisplayName      = $_.DisplayName
                PathName         = $_.PathName
                Description      = $_.Description
            }
        }

        If ( $Display )
        {
            $Range               = 0..( $Return.Count - 1 )
            $Section             = 0..( $Return.Count - 1 )
            $Subtable            = 0..( $Return.Count - 1 )
    
            $Names               = @( "Status" , "StartType" ; @( "" , "Display" , "Path" | % { "$_`Name" } ) )

            ForEach ( $i in 0..( $Return.Count - 1 ) )
            {
                $X               = $Return[$I]
        
                $Section[$I]     = "( $( $X.DisplayName ) )"
        
                $Splat           = @{ 

                    Items        = 0..4 | % {       $Names[$_] }
                    Values       = 0..4 | % { $X.$( $Names[$_] )    }

                }

                $SubTable[$I]    = New-SubTable @Splat
            }

            $Table               = New-Table -Depth $Range.Count -Title "Current Services" -ID $Section -Table $SubTable
    
            Write-Theme -Table $Table -Prompt "Press Enter to Continue"
        }

        Return $Return   
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Sync-DNSSuffix # Modified / Jeff Hicks @ github.com/jdhitsolutions _________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param ( 
        
            # Not supporting multiple or network based computers yet.
            # Based on registry modification, was still very critical to implement domain membership sync

            [ Parameter ( Position = 0 , ParameterSetName = "Get" ) ] [ Switch ] $Get    ,
            [ Parameter ( Position = 0 , ParameterSetName = "Set" ) ] [ Switch ] $Set    ,
            [ Parameter ( Position = 1 , ParameterSetName = "Set" ) ] [ Switch ] $Domain )

            Begin 
            {
                $Query = "HKLM:\System\CurrentControlSet\Services\TCPIP\Parameters"
                $CS    = GCIM Win32_ComputerSystem
            }

            Process
            {
                If ( $Get )
                {
                    GP $Query | % { 

                        Return [ PSCustomObject ]@{

                            Computername      = $_.hostname
                            Domain            = $_.Domain
                            'NV Domain'       = $_.'NV Domain'
                            SynchronizeSuffix = $_.SyncDomainWithMembership -as [ Bool ]
                        }
                    }
                }

                If ( $Set )
                {
                    If ( ! ( $CS.PartOfDomain ) )
                    {
                        "Domain" | % { $_ , "NV $_" } | % { 
                        
                            SP -Path $Query -Name $_ -Value $Domain
                        }

                        SP -Path $Query -Name SyncDomainWithMembership -Value 1
                    }

                    If ( $CS.PartOfDomain )
                    {
                        [ System.Windows.Forms.MessageBox ]::Show( "System is part of a domain" , "Exception" )
                    }
                }
            }                                                                        #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
     Function Register-PDCTimeSource # What Free Actually Means _________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
     {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True ) ] [ String [] ] $Servers        ,
            [ Parameter ( Position = 1 ) ]                     [    Int    ] $Phase   = 3600 )

        $Time = "HKLM:\SYSTEM\CurrentControlSet\Services\W32Time"

        ( "Parameters"              , "Type"                  ,    "NTP" ) ,
        ( "Config"                  , "AnnounceFlags"         ,        5 ) ,
        ( "TimeProviders\NTPServer" , "Enabled"               ,        1 ) ,
        ( "Parameters"              , "NTPServer"             , $Servers ) ,
        ( "Config"                  , "MaxPosPhaseCorrection" ,     3600 ) | % {

            $Splat    = @{ 
            
                Path  = "HKLM:\SYSTEM\CurrentControlSet\Services\W32Time\$( $_[0] )"
                Name  = $_[1]
                Value = $_[2]
            }

            SP @Splat

            Write-Theme -Action   $_[1] $_[2] 
            Write-Theme -Function $Splat.Path
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
        Write-Theme -Free # What Free Actually Means ____________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
     #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯       
