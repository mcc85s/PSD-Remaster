# ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____  
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯       _____________________________________________________        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯        __/¯¯\__[ Dynamically Engineered Digital Security ]__/¯¯\__         ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  _________________________ ________________ ___________________________________  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__// | Application Development | Virtualization | Network and Hardware Magistration | \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__// 
#//¯¯¯    
#\\  [ Provision-DomainController ] @: Orchestrates the process of provisioning server prerequisites in order to install Hybrid-DSC                     
#//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____      
#\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/---\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\___  
#//¯¯\\___________________________________________________________________________________¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\___ __ ____ -- ____ __ ____ -- ____ __ ____ -- ____ __ ___// 
# ¯¯¯¯   [ Declare Namespaces & Load Modules ] __________________________________________//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯¯  
     #/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
        "Security.Principal" , "Management.Automation" , "DirectoryServices" | % { IEX "Using Namespace System.$_" } 
    
        $ENV:PSModulePath.Split( ';' ) | % { GCI $_ -Recurse "Hybrid-DSC.psm1" } | % {
        
        IPMO $_.FullName -Force ; If ( $? -ne $True ) { Write-Error "Module Not Loaded/Found" ; Read-Host "Press Enter to Exit" ; Exit }     
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Enter-ServiceAccount # Allows entry / use of an AD service account _________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ] [ String ] $DC      ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ] [ String ] $Domain  ,
            [ Parameter ( Position = 2 , ValueFromPipeline = $True ) ]                     [ String ] $NetBIOS )
                                                                                                                
        $Login = Get-XAML -Login

        $NamedElements = "Username" , "Password" , "Confirm" , "Switch" , "Port" , "Ok" , "Cancel"

        $0    = "Username" , "Password" , "Confirmation"
        $1    = $0 | % { "You must enter a $_" } ; $2 = $0 | % { "$_ Error" }
        $1[2] = $1[2].Replace( "You must enter a" , "Password Must Match the" )
        $1   += "Invalid information. All fields must be correct and valid." ; 
        $2   += "Authentication Failure"

        $MSG  = 0..3 | % { "[ System.Windows.MessageBox ]::Show( '$( $1[$_] )' , '$( $2[$_] )' )" }

        $GUI = Convert-XAMLtoWindow -Xaml $Login -NE $NamedElements -PassThru

        $GUI.Switch.Add_Click({ $GUI.Port.IsEnabled = $True  })
        $GUI.Cancel.Add_Click({ $GUI.DialogResult   = $False })
        $GUI.Ok.Add_Click({

            $Port = $( If ( $GUI.Port.IsEnabled -eq $True ) { $GUI.Port.Text } Else { 389 } )
            $Cred = [ PSCredential ]::New( $GUI.Username.Text , $GUI.Password.SecurePassword )
            $AD   = "LDAP://$( $DC ):$Port/DC=$( $Domain.Split('.') -join ',DC=' )"
            $DX   = [ DirectoryEntry ]::New( "$AD" , $Cred.Username , $Cred.GetNetworkCredential().Password )

                If ( $GUI.Username | ? { $_.Text     -eq $Null } )                     { IEX $MSG[0] }
            ElseIf ( $GUI.Password | ? { $_.Password -eq $Null } )                     { IEX $MSG[1] }
            ElseIf ( $GUI.Confirm  | ? { $_.Password -eq $Null } )                     { IEX $MSG[2] }
            ElseIf ( $GUI | ? { $_.Password.Password -notmatch $_.Confirm.Password } ) { IEX $MSG[2] }
            ElseIf ( $DX.Name -eq $Null )                                              { IEX $MSG[3] }

            Else { $GUI.DialogResult = $True }
        })

        $Null = $GUI.Username.Focus()

        $OP = Show-WPFWindow -GUI $GUI

        If ( $OP -eq $True )
        {
            Write-Theme -Action "Login [+]" "Successful" 11 12 15
            Return [ PSCredential ]::New( $GUI.Username.Text , $GUI.Password.SecurePassword )
        }

        Else
        {
            Write-Theme -Action "Login [!]" "Failed"
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DomainType # Collects the DomainType ___________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Return @( "N/A" , "TreeDomain" , "ChildDomain" , "N/A" )                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DCPromoBoxControls # Collects the names for Box Controls _______________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Return @( "Database" , "Sysvol" , "Log" | % { "$_`Path" } ; "Credential" ;
        @( "Domain" | % { $_ , "New$_" } | % { $_ , "$_`NetBIOS" } ; "Site" ) | % { "$_`Name" } ;
        "ReplicationSourceDC" , "Forest" , "Domain" , "Child" , "Clone" ) | % { "$_`Box" }
                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Get-DCPromoControl # Provides backend for reliable XAML Control ____________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] Param (

            [ ValidateSet ( 0 , 1 , 2 , 3 ) ][ Parameter () ][ Int ] $Type = 0 )

                 $T = ( Get-DomainType )[ $Type ]
                 Return [ PSCustomObject ]@{
             # ______________________________________________________________________________ #
             # [ Services ] # - Entries for [ Windows Server @: Desired State Configuration ] #
             # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
                 AD_Domain_Services      = "" ; DHCP                     = "" ; DNS                    = "" ;
                 GPMC                    = "" ; RSAT                     = "" ; RSAT_AD_AdminCenter    = "" ;
                 RSAT_AD_PowerShell      = "" ; RSAT_AD_Tools            = "" ; RSAT_ADDS              = "" ;
                 RSAT_ADDS_Tools         = "" ; RSAT_DHCP                = "" ; RSAT_DNS_Server        = "" ;
                 RSAT_Role_Tools         = "" ; WDS                      = "" ; WDS_AdminPack          = "" ;
                 WDS_Deployment          = "" ; WDS_Transport            = "" ;
             # ______________________________________________________________________________ #
             # [ Menu Items ] # Entries for [ Windows Server @: Desired State Configuration ] #
             # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
                 Forest = "" ; Tree = "" ; Child = "" ; Clone = "" ; Process = $Type ;
             # ______________________________________________________________________________ #
             # [ ADDS-Deployment ] # - Entries for [ Active Directory @: Deployment DCPromo ] #
             # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ #
                 DomainType              = $T ; ForestMode              = "" ; DomainMode              = "" ;
                 ParentDomainName        = "" ; DatabasePath            = "" ; SysvolPath              = "" ;
                 LogPath                 = "" ; Credential              = "" ; DomainName              = "" ;
                 DomainNetBIOSName       = "" ; NewDomainName           = "" ; NewDomainNetBIOSName    = "" ;
                 SiteName                = "" ; ReplicationSourceDC     = "" ; InstallDNS              = "" ;
                 CreateDNSDelegation     = "" ; NoGlobalCatalog         = "" ; CriticalReplicationOnly = "" ;
                 Force      = $True ; NoRebootUponCompletion  = $False ; SafeModeAdministratorPassword = "" } 

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Filter-DCPromoGUI # Clears and refreshes items in the GUI __________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param ( [ ValidateSet ( 0 , 1 , 2 , 3 ) ][ Parameter () ][ Int ] $Type = 0 )

        $P         = $Type
        $Code      = Get-DCPromoControl -Type $P

        $DType     = "Forest" , "Tree" , "Child" , "Clone"

        $DType     | % { $Code.$_ = "N/A" }
        $DType[$P] | % { $Code.$_ = "Selected" }

        $Boxes     = Get-DCPromoBoxControls
        $Boxes     | % { $GUI.$_.Visibility = "Hidden" }

        $Text      = "Domain" | % { "Parent$_`Name" , "Credential" , "$_`Name" , "$_`NetBIOSName" , "SiteName"
                     "Credential" , "$_`NetBIOSName" , "New$_`Name" , "New$_`NetBIOSName" , "ReplicationSourceDC"}
        $Text      | % { $GUI.$_.Text = "" }

        $Modes     = "Forest" , "Domain" , "Child" , "Clone" | % { "$_`Box" }
        $Top       = @{ 0 = 0 , 1 ; 1 = 2 , 1 ; 2 = 2 , 1 ; 3 = 3 }
        $Top[$P]   | % { $Modes[$_] } | % { $GUI.$_.Visibility = "Visible" }

        $DMCode    = "ForestMode" , "DomainMode" , "ParentDomainName"
        $DMID      = @{ 0 = 1,1,0 ; 1 = 0,1,1 ; 2 = 0,1,1 ; 3 = 0,0,0 }

        ForEach ( $I in 0..2 )
        {
            If ( $DMID[$P][$I] -eq 0 ) { $Code.$( $DMCode[$I] ) = "N/A" }
        }
    
        $Roles     = "InstallDNS" , "CreateDNSDelegation" , "NoGlobalCatalog" , "CriticalReplicationOnly"
        $Roles     | % { $GUI.$_ | % { $_.IsEnabled = $True ; $_.IsChecked = $False } }

        $Enabled   = @{ 0 = 1 , 1 , 0 , 0 ; 1 = 1 , 1 , 1 , 0 ; 2 = 1 , 1 , 1 , 0 ; 3 = 1 , 1 , 1 , 1 }
        $Checked   = @{ 0 = 1 , 0 , 0 , 0 ; 1 = 1 , 0 , 0 , 0 ; 2 = 1 , 1 , 0 , 0 ; 3 = 1 , 0 , 0 , 0 }

        ForEach ( $i in 0..( $Roles.Count - 1 ) )
        {
            $X = $Enabled[$P][$I]
            $Y = $Checked[$P][$I]
            $Z = $Roles[$I]
            $GUI.$Z | % { $_.IsEnabled = $X ; $_.IsChecked = $Y }
            $Code.$Z = $( If ( $X -eq 0 ) { "N/A" } Else { $Y } )
        }

        $DomaInfo  = @( @( "Domain" | % { $_ , "New$_" } | % { $_ , "$_`NetBIOS" } ; "Site" ) | % { "$_`Name" } ; 
                    "ReplicationSourceDC" , "Credential" ) | Sort
        $Enabled   = @{ 0 = 0,1,1,0,0,0,1 ; 1 = 1,0,0,1,1,0,1 ; 2 = 1,0,0,1,1,0,1 ; 3 = 1,1,0,0,0,1,1 }

        ForEach ( $i in 0..( $DomaInfo.Count - 1 ) )
        {
            $X = $Enabled[$P][$I]
            $Y = $DomaInfo[$I]
            $GUI."$Y`Box" | % { $_.Visibility = $X }
            If ( $X -eq 0 ) { $Code.$Y = "N/A" }
        }

        $SVC  = Get-DSCFeatureList -Underscore

        ForEach ( $i in 0..16 )
        {
            $X = $ST[$I].Split( ' ' )[1]
            $Y = $SVC[$I]
            If ( $X -like "*[X]*" )
            {
                $GUI.$Y | % { $_.IsEnabled = $False ; $_.IsChecked =  $True }
                $Code.$Y = "Installed"
            }
            If ( $X -like "*[_]*" )
            {
                $GUI.$Y | % { $_.IsEnabled =  $True ; $_.IsChecked =  $True }
                $Code.$Y = "Available"
            }
        }

        Return $Code                                                                 #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Validate-DomainName # Verfies that text entries are valid __________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding () ] [ OutputType ( "String" ) ] Param (

            [ Parameter ( Mandatory = $True , ParameterSetName = "0" ) ][ Switch ] $Domain ,
            [ Parameter ( Mandatory = $True , ParameterSetName = "1" ) ][ Switch ] $NetBIOS ,
            [ Parameter ( Mandatory = $True , ParameterSetName = "2" ) ][ Switch ] $SiteName ,
            [ Parameter ( Mandatory = $True , ParameterSetName = "0" ) ]
            [ Parameter ( Mandatory = $True , ParameterSetName = "1" ) ]
            [ Parameter ( Mandatory = $True , ParameterSetName = "2" ) ][ String ] $Name )

            $Char = "abcdefghijklmnopqrstuvwxyz0123456789.-\/:*?$( '"' )<>|,~:!@#$%^&'(){}_ "
            $Char | % { $AL =    $_[0..25] ; $NU =   $_[26..35] ; $SP = $_[38..64] ;
                        $AN = $Char[0..35] ; $NN = $Char[0..25] }
            $DNS  = @{ Min = 2 ; Max = 255 ; Allow = $Char[ 0..37] ; Invalid = $SP }
            $NBT  = @{ Min = 1 ; Max =  15 ; Allow = $Char[ 0..37] ; Invalid = $SP }
            $SN   = @{ Min = 1 ; Max =  63 ; Allow = $Char[ 0..37] ; Invalid = $SP }

            $Reserved = @( "ANONYMOUS" , "AUTHENTICATED USER" , "BATCH" , "BUILTIN" ; 
            "GROUP" , "OWNER" | % { $_ , "$_ SERVER" } | % { "CREATOR $_" } ;
            "DIALUP" , "DIGEST AUTH" , "INTERACTIVE" , "INTERNET" ;
            "LOCAL" | % { $_ , "$_ SYSTEM" } ; "NETWORK" | % { $_ , "$_ SERVICE" } ;
            "NT AUTHORITY" , "NT DOMAIN" , "NTLM AUTH" , "NULL" , "PROXY" , "REMOTE INTERACTIVE" , "RESTRICTED" , 
            "SCHANNEL AUTH" , "SELF" , "SERVER" , "SERVICE" , "SYSTEM" , "TERMINAL SERVER" , "THIS ORGANIZATION" , "USERS" , "WORLD" )

            $X = $( If ( $Domain ) { $DNS } If ( $NetBIOS  ) { $NBT } If ( $SiteName ) { $SN } )

                If ( $Name.Length -lt $X.Min ) { Return "Short of minimum length" }
            ElseIf ( $Name.Length -gt $X.Max ) { Return  "Exceeds maximum length" }
            ElseIf ( ( $Name.ToCharArray() | ? { $_ -notin $X.Allow } ).Count -gt 0 ) { Return "Invalid Characters" }
            ElseIf ( ( $Name.ToCharArray() | ? { $_  -in $X.Invalid } ).Count -gt 0 ) { Return "Invalid Characters" }

            If ( ( $Domain ) -or ( $SiteName ) ) 
            {
                If ( ( $Name[0] | ? { $_ -notin $AN } ).Count -gt 0 )
                { 
                    Return "First character must be Alpha-Numeric"
                }
                    
                ElseIf (   $Name | % { $_.EndsWith( "." ) -or $_.EndsWith( "-" ) } )  
                { 
                    Return "Last Character cannot be a period/hyphen" 
                }
            }
            
            If ( $Domain )
            {
                If ( $Name.Split('.').Count -le 1 )
                { 
                    Return "Not a valid domain name" 
                }
                
                ElseIf ( ( $Name.Split('.')[-1].ToCharArray() | ? { $_ -in @( $AL ; '-' , '.' ) } ).Count -eq 0 )
                { 
                    Return "Top Level Domain must contain a non-numeric character" 
                }
                
                Else
                { 
                    Return $Name 
                }                                                                                    
            }

            If ( $SiteName )
            {
                If ( $X -in $Reserved ) 
                { 
                    Return "The selected name conflicts with a reservation" 
                }
                
                Else 
                { 
                    Return $Name 
                }    
            }
 
            If ( $NetBIOS )
            { 
                If ( $Name[0] -eq "." )
                {
                    Return "First Character must be Alpha-Numeric, or '.' "
                }
            
                Else 
                { 
                    Return $Name.ToUpper() 
                }
            }                                                                        #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Provision-DomainController # Launches Hybrid-DSCPromo ______________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Write-Theme -Action "Loading [~]" "Active Directory Configuration Utility" 11 12 15

        $Code       = Get-DCPromoControl
        $Named      = $Code | GM | ? Membertype -eq NoteProperty | % { $_.Name }
        $Face       = Get-XAML -HybridDSCPromo
        $Boxes      = Get-DCPromoBoxControls

        $WXGUI      = @{ Xaml = $Face ; Passthru = $True ; EA = 0 ; NE = @( $Named ; $Boxes ; "Start" , "Cancel" , "Confirm" , "CredentialButton" ) }

        $GUI        = Convert-XAMLToWindow @WXGUI

        $P          = $Code.Process

        $ST         = Get-DSCFeatureState -All

        Write-Theme -Action "Windows Server [+]" "Configuration Selected" 11 12 15

        # Menu Controls
        $Code       = Filter-DCPromoGUI -Type $Code.Process
        $Menu       = "Forest" , "Tree" , "Child" , "Clone"
        $GUI.$( $Menu[0] ).Add_Click( { $Code = Filter-DCPromoGUI -Type 0 } )
        $GUI.$( $Menu[1] ).Add_Click( { $Code = Filter-DCPromoGUI -Type 1 } )
        $GUI.$( $Menu[2] ).Add_Click( { $Code = Filter-DCPromoGUI -Type 2 } )
        $GUI.$( $Menu[3] ).Add_Click( { $Code = Filter-DCPromoGUI -Type 3 } )

        # Role Controls
        $Roles     = "InstallDNS" , "CreateDNSDelegation" , "NoGlobalCatalog" , "CriticalReplicationOnly"
        ForEach ( $i in 0..( $Roles.Count - 1 ) )
        {
            $GUI.$( $Roles[$I] ) | ? { $_.IsEnabled } | % {
                
                $Check | % { 
                
                    $_.Add_Checked({   $Code.$( $Roles[$I] ) = $True })
                    $_.Add_UnChecked({ $Code.$( $Roles[$I] ) = $True })

                }
            }
        }

        # Service Controls
        $Service = Get-DSCFeatureList -Underscore
        ForEach ( $i in 0..( $Service.Count - 1 ) )
        {
            $Check = $GUI.$( $Service[$I] )
                
            If ( $Check.IsEnabled -eq $True )
            {
                $Check | % { $_.Add_Checked({   $Code.$( $Service[$I] ) = $True })
                             $_.Add_UnChecked({ $Code.$( $Service[$I] ) = $True })  
                }
            }
        }
        
        # Credential / Domain Logon
        $GUI.CredentialButton.Add_Click({ 

            $X = $( If ( $Code.Process -eq 1,2 ) { $GUI.ParentDomainName.Text } )
                    If ( $Code.Process -eq 3   ) { $GUI.DomainName.Text       }

                    $X | % {

                        If ( ( Validate-DomainName -Domain -Name $X ) -ne $X )
                        { 
                            [ System.Windows.MessageBox ]::Show( "$X in Parent Domain Name" , "Error" ) ; Break
                        }
                    
                        Else
                        {
                            Resolve-DNSName $_ -Type A | % { Resolve-DNSName $_.IPAddress } | % { $Y = $_.NameHost.Replace( ".$X" , '' ) }
                            If ( $Y -eq $Null ) { [ System.Windows.MessageBox ]::Show( "Failed to detect the domain controller" , "Error" ) ; Break }
                        }
                    }

            $DCCred = Enter-ServiceAccount -DC $Y -Domain $X

            If ( $DCCred -ne $Null ) 
            { 
                $GUI.Credential.Text = $DCCred.UserName
                $Code.Credential     = $DCCred

                If ( $Code.Process -in 1 , 2 ) 
                {
                    $GUI.ParentDomainName.Text = $X
            
                    $AD = "LDAP://$( $DC )/CN=Partitions,CN=Configuration,DC=$( $Domain.Split('.') -join ',DC=' )"

                    $Searcher = [ DirectorySearcher ]::New() | % {
                        $_.SearchRoot = [ DirectoryEntry ]::New( $AD , $DCCred.Username , $DCCred.GetNetworkCredential().Password )
                        $_.PageSize   = 1000
                        $_.PropertiesToLoad.Clear()
                    }

                    $EXE = $Searcher.FindAll()
                    0..( $EXE.Count - 1 ) | % { $EXE[$_].Properties } | ? { $_.netbiosname } | % { $NBIOS = $_.netbiosname }
                }

                Else {    $GUI.DomainName.Text = $X }
            }
        })

        $GUI.Cancel.Add_Click({ $GUI.DialogResult = $False })

        $GUI.Start.Add_Click({
                
            "Database" , "Sysvol" , "Log" | % { "$_`Path" } | % { 
                
                If ( $GUI.$_.Text -eq "" ) { IEX "[ System.Windows.MessageBox ]::Show( '$( $_.Replace( 'P' , ' P' ) ) Missing' )" ; Break }
             }

             $SM = "No Password" , "Match" , "Confirmation" | % { "[ System.Windows.MessageBox ]::Show( '$_ Error' )" }

             $GUI.SafeModeAdministratorPassword.Password | % {
            
                If ( $_ -eq "" )                          { IEX $SM[0] ; Break }
                If ( $GUI.Confirm.Password -notmatch $_ ) { IEX $SM[1] ; Break }
                If ( $GUI.Confirm.Password -eq "" )       { IEX $SM[2] ; Break }

             }
                    
            $Top   = @( "Forest" , "Domain" | % { "$_`Mode" } ; "ParentDomainName" )
            $Roles = "InstallDNS" , "CreateDNSDelegation" , "NoGlobalCatalog" , "CriticalReplicationOnly"
            $DMID  = @( @( "Domain" | % { $_ , "New$_" } | % { $_ , "$_`NetBIOS" } ; "Site" ) | % { "$_`Name" } ; "ReplicationSourceDC" , "Credential" ) | Sort 

            If ( $Code.Process -eq 0 ) # Install-ADDSForest
            {
                # Top
                $Top[0,1]   | % { $Code.$_ = $GUI.$_.SelectedIndex }

                # Roles
                $Roles[0,1] | ? { $GUI.$_.IsEnabled } | % { $Code.$_ = $GUI.$_.IsChecked }
               
                # Domain Info
                $Items      = $DMID[1,2,6]
                $Con        = $Items | % { $GUI.$_.Text }

                # Special Rules
                $Con[1]     = $Con[1].ToUpper()
            
                $ID         = "Domain" , "NetBIOS" , "Site" | % { "$_ Name Cannot Be Empty" }
                $ID        += "Invalid Domain Name"
                $MSG        = $ID | % { "[ System.Windows.Messagebox ]::Show( '$_' )" }
                    
                # Commands
                $Val        = 0..2
                $Val[0]     = Validate-DomainName   -Domain -Name $Con[0]
                $Val[1]     = Validate-DomainName  -NetBIOS -Name $Con[1]
                $Val[2]     = Validate-DomainName -SiteName -Name $Con[2]

                0..2        | ? { $Con[$_] -eq       "" } | % { IEX $MSG[$_] ; Break }
                0..2        | ? { $Con[$_] -ne $Val[$_] } | % { [ System.Windows.MessageBox ]::Show( $Con[$_] ) ; Break }
                0..2        | % { $Code.$( $Items[$_] ) = $Con[$_] }
            }

            If ( $Code.Process -in 1..2 )
            {
                $GUI.ParentDomainName     | % { $_.Text -eq $Null  } | % { [ System.Windows.MessageBox ]::Show(    "Parent Domain Name Missing" ) ; Break }
                $GUI.CredentialBox        | % { $_.Text -eq $Null  } | % { [ System.Windows.MessageBox ]::Show(     "Domain Credential Missing" ) ; Break }
                $GUI.NewDomainNetBIOSName | % { $_.Text -eq $NBIOS } | % { [ System.Windows.MessageBox ]::Show(  "NetBIOS name is already used" ) ; Break }
                    
                If ( $Code.Process -eq 1 )
                {
                    $GUI.NewDomainName | % { $_.Text -like "*$( $GUI.ParentDomainName.Text )*" } | % { [ System.Windows.MessageBox ]::Show(  "Name is too similar" ) ; Break }
                }
            }

            If ( $Code.Process -eq 1 ) # Install-ADDSDomain Tree
            {       
                # Top
                $Top[1]      | % { $Code.$_ = $GUI.$_.SelectedIndex }
                $Top[2]      | % { $Code.$_ = $GUI.$_.Text }

                # Roles
                $Roles[0..2] | ? { $GUI.$_.IsEnabled } | % { $Code.$_ = $GUI.$_.IsChecked }
                    
                # Domain Info
                $Items       = $DMID[3,4,6,0]
                $Con         = $Items | % { $GUI.$_.Text }

                # Special Rules
                $ID          = "New Domain" | % { "$_" , "$_ NetBIOS" , "Site" } | % { "$_ Name" }
                $ID         += "Credential Invalid"
                $MSG         = $ID | % { "[ System.Windows.Messagebox ]::Show( '$_' )" }
                
                # Commands
                $Val         = 0..2
                $Val[0]      = Validate-DomainName   -Domain -Name $Con[0]
                $Val[1]      = Validate-DomainName  -NetBIOS -Name $Con[1]
                $Val[2]      = Validate-DomainName -SiteName -Name $Con[2]
                    
                0..2         | ? { $Con[$_] -eq       "" } | % { IEX $MSG[$_] ; Break }
                0..2         | ? { $Con[$_] -ne $Val[$_] } | % { [ System.Windows.MessageBox ]::Show( $Con[$_] ) ; Break }   
                0..2         | % { $Code.$( $Items[$_] ) = $Con[$_] }
            }

            If ( $Code.Process -eq 2 ) # Install-ADDSDomain Child
            {       
                # Top
                $Top[1]      | % { $Code.$_ = $GUI.$_.SelectedIndex }
                $Top[2]      | % { $Code.$_ = $GUI.$_.Text }

                # Roles
                $Roles[0..2] | ? { $GUI.$_.IsEnabled } | % { $Code.$_ = $GUI.$_.IsChecked }
                    
                # Domain Info
                $Items       = $DMID[3,4,6,0]
                $Con         = $Items | % { $GUI.$_.Text }

                # Special Rules
                $ID          = "New Domain" | % { "$_" , "$_ NetBIOS" , "Site" } | % { "$_ Name" }
                $ID         += "Credential Invalid"
                $MSG         = $ID | % { "[ System.Windows.Messagebox ]::Show( '$_' )" }
                $Code        | ? { $_.Credential -ne $DCCred.UserName } | % { [ System.Windows.MessageBox ]::Show( "Domain Credential Invalid" ) }
                
                # Commands 
                $Val         = 0..2
                $Val[0]      = Validate-DomainName -SiteName -Name $Con[0]
                $Val[1]      = Validate-DomainName  -NetBIOS -Name $Con[1]
                $Val[2]      = Validate-DomainName -SiteName -Name $Con[2]
                    
                0..2         | ? { $Con[$_] -eq       "" } | % { IEX $MSG[$_] ; Break }
                0..2         | ? { $Con[$_] -ne $Val[$_] } | % { [ System.Windows.MessageBox ]::Show( $Con[$_] ) ; Break }   
                0..2         | % { $Code.$( $Items[$_] ) = $Con[$_] }
            }

            If ( $Code.Process -eq 3 ) # Install-ADDSDomainController
            {
                # Roles
                $Roles[0..3] | ? { $GUI.$_.IsEnabled } | % { $Code.$_ = $GUI.$_.IsChecked }
                    
                # Domain Info
                $Items       = $DMID[1,5,6,0]
                $Con         = $Items | % { $GUI.$_.Text }

                # Special Rules
                $ID          = "New Domain" | % { "$_" , "$_ NetBIOS" , "Site" } | % { "$_ Name" }
                $ID         += "Credential Invalid"
                $MSG         = $ID | % { "[ System.Windows.Messagebox ]::Show( '$_' )" }
                $Code        | ? { $_.Credential -ne $DCCred.UserName } | % { [ System.Windows.MessageBox ]::Show( "Domain Credential Invalid" ) }

                # Commands
                $Val         = 0..2
                $Val[0]      = Validate-DomainName -DomainName -Name $Con[0]
                $Val[1]      = Resolve-DnsName $Con[0] 
                $Val[2]      = Validate-DomainName   -SiteName -Name $Con[2]
                    
                0..2         | ? { $Con[$_] -eq       "" } | % { IEX $MSG[$_] ; Break }
                0..2         | ? { $Con[$_] -ne $Val[$_] } | % { [ System.Windows.MessageBox ]::Show( $Con[$_] ) ; Break }   
                0..2         | % { $Code.$( $Items[$_] ) = $Con[$_] }
            }
                    
            Else { $GUI.DialogResult = $True }
        })

        $GUI.DatabasePath | % { $_.Text = "C:\Windows\NTDS"   }
        $GUI.SysvolPath   | % { $_.Text = "C:\Windows\SYSVOL" }
        $GUI.LogPath      | % { $_.Text = "C:\Windows\SYSVOL" }

        $Null = $GUI.SafeModeAdministratorPassword.Focus()

        $OP   = Show-WPFWindow -GUI $GUI

        If ( $OP -eq $True )
        {
            $InstallSVC = @( )
            $Service = Get-DSCFeatureList -Underscore

            ForEach ( $i in 0..$Service.Count - 1 )
            {
                $X = $Service[$X]
                If ( ( $Code.$X -eq "Available" ) -and ( $GUI.$X.IsChecked ) ) 
                { 
                    $Service += $X 
                } 
            }

            $Part = 0..2
            $Part[0] = "ForestMode" , "DomainMode" , "ParentDomainName"
            $Part[1] = "InstallDNS" , "CreateDNSDelegation" , "NoGlobalCatalog" , "CriticalReplicationOnly"
            $Part[2] = @( "Credential" ; "Domain" | % { $_ , "New$_" } | % { $_ , "$_`NetBIOS" } | % { "$_`Name" } ; "ReplicationSourceDC" , "SiteName" )

            $Out    = [ Ordered ]@{ }
            
            If ( $Code.Process -eq 0 )
            {
                $Filter = @( $Part[0][0,1] ; $Part[1][0,1] ; $Part[2][1,2,6] )
            }

            If ( $Code.Process -in 1,2 )
            {
                $Out.Add( "DomainType" , "$( ( Get-DomainType )[ $Code.Process ] )" )
                $Filter = @( $Part[0][1,2] ; $Part[1][0..2] ; $Part[2][1,3,4,6] )
            }
            
            If ( $Code.Process -eq 3 )
            {
                $Filter = @( $Part[1][0..3] ; $Part[2][0,1,5,6] )
            }
                
            $Filter | % { $Out.Add( $_ , $Code.$_ ) }
            "NoRebootUponCompletion" , "SafeModeAdministratorPassword" , "Force" | % { $Out.Add( $_ , $Code.$_ ) }

            Echo $Out
            Read-Host "Correct?"
        }

        Else { Write-Theme -Action "[!] Exception" "Either the user cancelled, or the dialogue failed" }
        
    }
