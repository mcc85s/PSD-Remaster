# ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯       _____________________________________________________        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯        __/¯¯\__[ Dynamically Engineered Digital Security ]__/¯¯\__         ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  _________________________ ________________ ___________________________________  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__// | Application Development | Virtualization | Network and Hardware Magistration | \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
#//¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯  
#\\  [ Hybrid-DSC ] @: Loads All Table/Message Echo Wrappers, GUI, Networking Functions 
#//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____      
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___  
#//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
# ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯  
    Using Namespace System.Net.NetworkInformation
# ____                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function New-SubTable # Converts array of keys and values into an Object      ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
        
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ][ String [] ]  $Items ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ][ String [] ] $Values )

        $Table = [ PSCustomObject ]@{ }

        If ( $Items.Count -eq $Values.Count )
        {
            If ( $Items.Count -gt 1 ) { $Count = 0..( $Items.Count - 1 ) }
            $Count | % { 
                $Table | Add-Member -MemberType NoteProperty -Name "Item:$_" -Value @{ ID = "$( $Items[$_] )" ; Value = "$( $Values[$_] )" } }
        }

        If ( $Items.Count -ne $Values.Count ) { Throw '$Items -ne $Values' }

        Return $Table

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function New-Table # Converts array of objects into a single object           ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ][         String    ] $Title ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ][            Int    ] $Depth ,
            [ Parameter ( Position = 2 , Mandatory = $True , ValueFromPipeline = $True ) ][         String [] ] $ID    ,
            [ Parameter ( Position = 3 , Mandatory = $True , ValueFromPipeline = $True ) ][ PSCustomObject [] ] $Table )

        $Object = [ PSCustomObject ]@{ Class = $Title }

        If ( ( $ID.Count -ne $Depth ) -or ( $Table.Count -ne $Depth ) ) { Throw '$Depth -ne $ID.Count or $Table.Count' }
        If ( $Depth -eq 1 ) { $Count = 1 } If ( $Depth -gt 1 ) { $Count = 0..( $Depth - 1 ) }

        $C = $Null

        $Count | % {
    
            If ( $Depth -gt 1 )
            {   If ( $C -ne $Null ) { $C = $C + 1 } If ( $C -eq $Null ) { $C = 0 } $Index = $ID[$C] ; $Section = $Table[$C] }

            If ( $Depth -eq 1 )
            {   $C = 0 ; $Index = $ID ; $Section = $Table }

            $Object | Add-Member -MemberType NoteProperty -Name "ID:$C" -Value $Index
            $Keys = @( $Section | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )

            ForEach ( $S in $Keys )
            {   $SubTable = [ Ordered ]@{ }
                ForEach ( $K in $Keys )
                {   $Section.$K | % { $SubTable.Add( "$K" , @{ ID = $_.ID ; Value = $_.Value } ) } } } 

            $Object | Add-Member -MemberType NoteProperty -Name "Section:$C" -Value $SubTable
        }

        Return $Object

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Write-Echo # Modifies Write-Output to stylize strings/arrays/tables  ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        [ CmdLetBinding ( ) ] Param (
            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True , ParameterSetName = "0" ) ][ Switch ]        $Action ,
            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True , ParameterSetName = "1" ) ][ String ]      $Function ,
            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True , ParameterSetName = "2" ) ][ Array  ]         $Array ,
            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True , ParameterSetName = "3" ) ][ PSCustomObject ] $Table ,
            [ Parameter ( Position = 0 , Mandatory = $True , ParameterSetName = "4" ) ][ Switch ] $Free ,
            [ Parameter ( Position = 0 , Mandatory = $True , ParameterSetName = "5" ) ][ Switch ] $Foot ,
            [ Parameter ( Position = 1 , Mandatory = $True , ParameterSetName = "0" ) ][ String ] $Type ,
            [ Parameter ( Position = 2 , Mandatory = $True , ParameterSetName = "0" ) ][ String ] $Info ,
            [ Parameter ( Position = 1 , ParameterSetName = "2" ) ][ Switch ] $Wrap ,
            [ ValidateSet (0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15) ]
            [ Parameter ( Position = 3 , ParameterSetName = "0" ) ]
            [ Parameter ( Position = 2 , ParameterSetName = "1" ) ]
            [ Parameter ( Position = 2 , ParameterSetName = "2" ) ]
            [ Parameter ( Position = 2 , ParameterSetName = "3" ) ]
            [ Parameter ( Position = 2 , ParameterSetName = "4" ) ]
            [ Parameter ( Position = 2 , ParameterSetName = "5" ) ][ Alias ( "F" )][ String ] $ForegroundColor ,
            [ ValidateSet (0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15) ]
            [ Parameter ( Position = 4 , ParameterSetName = "0" ) ]
            [ Parameter ( Position = 3 , ParameterSetName = "1" ) ]
            [ Parameter ( Position = 2 , ParameterSetName = "2" ) ]
            [ Parameter ( Position = 3 , ParameterSetName = "3" ) ]
            [ Parameter ( Position = 3 , ParameterSetName = "4" ) ]
            [ Parameter ( Position = 3 , ParameterSetName = "5" ) ][ Alias ( "B" )][ String ] $BackgroundColor ,
            [ Parameter ( Position = 5 , ParameterSetName = "0" ) ]
            [ Parameter ( Position = 4 , ParameterSetName = "1" ) ]
            [ Parameter ( Position = 3 , ParameterSetName = "2" ) ]
            [ Parameter ( Position = 4 , ParameterSetName = "3" ) ]
            [ Parameter ( Position = 5 , ParameterSetName = "4" ) ]
            [ Parameter ( Position = 5 , ParameterSetName = "5" ) ][ Alias ( "L" )][ String ] $Log )

        Begin
        {
            $S  = " // " , " \\ " ; $F  = "/¯¯\" , "\__/" ; $OP = @( ) ;
        }

        Process
        {   
            If ( $Table -or $Wrap ) #//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
            {
                "  _ $("____    " * 13 )____ _  " , 
                " ///$("/¯¯\\__/" * 13 )/¯¯\\\\ " , 
                " \\\$("\__//¯¯\" * 13 )\__//// " , 
                " // $("¯¯¯¯    " * 13 )¯¯¯¯ \\ " | % { $OP += $_ }
            } 

            If ( $Action ) #//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
            {   
                $T , $I = $Type , $Info

                $X = $( If ( $T.Length -gt 18 ) { "...$( $T[ 0..18 ])" } Else { "$( " " * ( 21 - $T.Length ) )$T" } )
                $Y = $( If ( $I.Length -gt 66 ) { "$( $I[0..66]  )..." } Else { "$I$( " " * ( 69 - $I.Length ) )" } )

                "  ____    __$( "_" * 96     )__      " ,
                " //¯¯\\__//$(  "¯" * 98      )\\___  " ,
                " \\__//¯¯¯ $( "$X : $Y" )  ___//¯¯\\ " ,
                "  ¯¯¯\\$(     "_" *  98  )//¯¯\\__// " ,
                "      $(      "¯" * 100   )    ¯¯¯¯  " | % { $OP += $_ }
            }

            If ( $Function ) #//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
            {   
                $FA = $Function 
                $X = $( If ( $FA.Length -gt 58 ) { "$( $FA[0..58] -join '' )... ]" } Else { "$FA ]$( "_" * ( 62 - $FA.Length ) )" } )

                "  ____ $( " " * 70  ) $( ( "____    " ) * 4 )____  " , 
                " //¯¯\\$( "_" * 70  )/$( ( "/¯¯\\__/" ) * 4 )/¯¯\\ " , 
                " \\__//$( "¯" * 70  )\$( ( "\__//¯¯\" ) * 4 )\__// " , 
                "  ¯¯¯\\__[ $(  $X )__/$( ( "/¯¯\\__/" ) * 4 )/¯¯¯  " ,
                "      ¯$( "¯" * 70  )¯$( ( "    ¯¯¯¯" ) * 4 )      " | % { $OP += $_ }
            }

            If (  $Array ) { $Array | % { $OP += $_ } }

            If (  $Table )
            {   
                $Index   = @( )
                $Section = @( )
                $Name    = $Null
                $Item    = $Null
                $C       = $Null

                $ID    = $Table | GM | ? { $_.MemberType -eq "NoteProperty" }

                $ID | ? { $_.Name -eq "Class" } | % { $Title = $Table.$( $_.Name ) }

                $Title = $Title.Replace( ' ' , '-' ) | % { "[ $_ ]" }

                If ( $Title.Length -gt 103 ) { $Title = "$( $Title[0..103] -join '' ) ... " }

                $TT = 108 - $Title.Length
                $TX = $TT % 4
                $TY = ( $TT - $TX ) / 4
                $TL , $TR = "_¯" , "¯_" | % { $_ * $TY }

                $T = ( $Title | % { "$_" , "$_ " , "$_ " , " $_  " } )[ $TX ]

                $Title = $S[0] + $TL + $T + $TR + $S[1] 

                $OP += " \\_$( "_" * 108 )_// " , $Title , " \\¯$( "¯" * 108 )¯// " 
                
                $ID | ? { $_.Name -like      "*ID:*" } | % { $Index   += $Table.$( $_.Name ) }
                $ID | ? { $_.Name -like "*Section:*" } | % { $Section += $Table.$( $_.Name ) }

                $Count = $Index.Count - 1

                $Total = 0

                If ( $Count -gt 0 ) { $Count = 0..$Count }

                $Count | % {

                    If ( $Index.Count -gt 1 )
                    {   
                        If   ( $C -ne $Null ) { $C = $C + 1 }
                        If ( ( $C -eq $Null ) -and ( $Name -eq $Null ) ) { $C = 0 }
                        $Name = $Index[$C] ; $Item = $Section[$C]
                    }

                    If ( $Index.Count -eq  1 ) { $Name = [ String ]$Index ; $Item = $Section }
                    If ( $Name.Length -gt 93 ) { $Name = "$( $Name[0..93] -join '' ) ) ... " }

                    $U = 98 - $Name.Length

                    $V = $Total % 2

                    $W = ( 1 - $V )

                    $SHeader = "_" , "¯" | % { "$( $L[$V] + ( "$_" * 108 ) + $R[$V] )" }

                    $SLine = $L[$W] + ( "-" * 10 ) + $Name + ( "-" * $U ) + $R[$W]
                    
                    $OP   += $SHeader[0] , $SLine , $SHeader[1] ; $Total = $Total + 3

                    $Keys = @( $Item.Keys )

                    ForEach ( $IX in ( 0..( $Item.Keys.Count - 1 ) ) )
                    {
                        $Item."Item:$IX" | % { $Key = $_.ID ; $Value = $_.Value } ; $Y = $Total % 2

                        $Key   = $( If (   $Key.Length -gt 20 ) { "$(   $Key[0..20] -join '' ) ... " } Else { "$( " " * ( 25 - $Key.Length ) )$Key" } )
                        $Value = $( If ( $Value.Length -gt 75 ) { "$( $Value[0..75] -join '' ) ... " } Else { "$Value$( " " * ( 80 - $Value.Length ) )" } )

                        $OP += "$( $L[$Y] + $Key ) : $( $Value + $R[$Y] )" ; $Total ++
                    }
                }
            }

            If ( $Free )
            {
                $PI  = "($( [ Char ] 960 ))" ; $DA = ( "m" , "d" , "Y" | % { Get-Date -UFormat "%$_" } | % { "$( $_.ToCharArray() )" } ) -join ' / '
                $A   = " //¯" , " \\" , " //" , " \\_" ; $E = "[=]" , "\_/" , "| |" ; $BL = -Join $E[0,1,0] ; $SX = ( "  *   " * 6 ) , "$( "     *" * 5 )      "
                $M1  = 0..120 | % { "¯" * $_ } ; $M2 = 0..120 | % { "_" * $_ } ; $M3 = 0..120 | % { " " * $_ } ; $FL = " // /¯¯\\   " , " \\ \__//   "
                $RL  = "   //¯¯\ \\ " , "   \\__/ // " ; $X = "$($A[1]+$SX[1])]$($M2[48])_// " , "$($A[2]+$SX[0])]$($M1[48])¯\\ "

                $STR = "Beginning the fight against Technological Tyranny and Cyber Criminal Activities" , "Dynamically Engineered Digital Security" , 
                "Application Development - Virtualization" , "Network & Hardware Magistration" ,   "What America Once Stood For" , 
                "$PI A Heightened Sense Of Security $PI" , "HYBRID" , "BY" , "SECURE-DIGITS-PLUS-LLC" , "MICHAEL C COOK SR"

                #$STR = @( 0..5 | % { $STR[$_] } | % { "[ $_ ]" } ; 6..9 | % { $STR[$_] } | % { "$( $_.ToCharArray() )" } )

                $STR = @( $STR[0..5] | % { "[ $_ ]" } ; $STR[6..9] | % { $_.ToCharArray() -join ' ' } )

                $Sig = $DA + '  |  ' + $STR[9].Replace( "  " , " " )
                
                $Out = @( )

                $OP += "  ______$( " " * 10 )$( "_" * 81 )$( " " * 9 )______  " , " // /¯¯\\________/$( "¯" * 81 )\_______//¯¯\ \\ "

                $Out += 
                "     $( $STR[0] )    " , "  $( $M2[88] )  " , "$($A[0]+$M1[35])]$($M1[48])¯\\ " , $X[0] , $X[1] , 
                "$($A[1]+$SX[1])]___$($STR[1])___// " , $X[1] , $X[0] , $X[1] , "$($A[1]+$SX[1])]__$( $STR[2])___// " , 
                $X[1] , $X[0] , $X[1] , "$($A[1]+$SX[1])]_______$($STR[3])_______// " ,  " //  $($STR[4])   ]$($M1[48] )¯\\ " , 
                "$($A[3]+$M2[35])]$($M2[48])_// " ,  "$($A[0]+$M1[85])\\ " , "$($A[3]+$M2[32]+$BL+$E[1]+$BL+$M2[32])// " , 
                "$($A[0]+$M1[32]+$E[2]+$M3[15]+$E[2]+$M1[32])\\ " , "$($A[3]+$M2[32]+$E[0])  $($STR[6])  $($E[0]+$M2[32])// " , 
                "$($A[0]+$M1[32]+$E[2])  $($M1[11])  $($E[2]+$M1[32])\\ " , "$($A[3]+$M2[17]+$BL*2+$M3[6]+$STR[7]+$M3[6]+$BL*2+$M2[16])_// " , 
                "$($A[0]+$M1[17]+$E[2]+$M1[15]+$M3[6]+$M1[3]+$M3[6]+$M1[15]+$E[2]+$M1[16])¯\\ " , 
                "$($A[3]+$M2[17]+$E[0]) $($STR[8]) $($E[0]+$M2[16])_// " , 
                "$($A[0]+$M1[17]+$E[1]) $($M1[43]) $($E[1]+$M1[16])¯\\ " , 
                "$($A[3]+$M2[10]+$BL*3+$E[0])\__/$($E[0]+$BL*3+$M2[10])_// " , 
                "$($A[0]+$M1[10]+$E[0]+$M1[58]+$E[0]+$M1[10])¯\\ " , "$($A[3]+$M2[10]+$E[0])  $SIG  $($E[0]+$M2[10])_// " , 
                "  $($M1[15])  $($M1[19])     $($M1[30])  $($M1[15])  " , " $($M3[24]+$STR[5]+$M3[24]) "

                $C = 1
                $Out | % { $Y = $C % 2 ; $OP += "$( $FL[$Y] )$_$( $RL[$Y] )" ; $C ++ }

                $OP += " \\ \__//¯¯¯¯¯¯¯¯\$( "_" * 81 )/¯¯¯¯¯¯¯\\__/ // " , "  ¯¯¯¯¯¯$( " " * 10 )$( "¯" * 81 )$( " " * 9 )¯¯¯¯¯¯  "
            }

            If ( $Foot )
            {
                $F = "/¯¯\" , "\__/" ;  $BL = 0..100 | % { "_" * $_ } ; $TL = 0..100 | % { "¯" * $_ }
                $FZ = 0..13 | % { ( $F[0..1] -join '' ) * $_ } ; $FY = 0..13 | % { ( $F[1..0] -join '' ) * $_ }
                
                $ST = "Secure Digits Plus LLC" , "Hybrid | Desired State Controller" , "Dynamically Engineered Digital Security" , "Application Development" , 
                "Virtualization" , "Network and Hardware Magistration" , "https://www.securedigitsplus.com" , "Server-Client" , "Seedling-Spawning Script" , 
                "Provisional Author : Michael C Cook Sr." , "'The Buck Stops Here'"
                
                $Title , $Strength , $Domain , $Author = ( 0..1 ) , ( 3..5 ) , ( 6..8 ) , ( 9..10 ) | % { $ST[$_] -join ' | ' }

                $OP += "  ____$( " -- ____" * 13 )  " , " /$( $FZ[13] )/¯¯\\ " , " \$( $FY[13] )\__// " , 
                " /$( $FZ[ 2] )/¯¯\\ $( "  ¯¯¯¯  " * 8 ) //¯¯\$( $FY[2] )\ " ,
                " \$( $FY[ 2] )\__//  [ $Title ]  \\__/$( $FZ[2] )/ " , " /$( $FZ[ 2] )/¯¯¯    ¯¯¯\__/$( "¯" * 47 )\__/¯¯    ¯¯¯\$( $FY[2] )\ " ,
                " \$( $FY[ 1] )\__//¯¯¯         __/¯¯\ ([ $( $ST[2] ) ]) /¯¯\__        ¯¯¯\\__/$( $FZ[1] )/ " ,
                " /$( $FZ[ 1] )/¯¯\\  _________/¯¯\__/_________ $( $BL[16] ) $( $BL[20] )\__/¯¯\________  //¯¯\$( $FY[1] )\ " ,
                " \$( $FY[ 1] )\__// | $Strength | \\__/$( $FZ[1] )/ " , " /$( $FZ[ 1] )/¯¯\\  $( $TL[25] ) $( $TL[16] ) $( $TL[35] )  //¯¯\$( $FY[1] )\ " ,
                " \$( $FY[ 1] )\__//   $Domain    \\__/$( $FZ[1] )/ " , " /$( $FZ[ 1] )/¯¯\\___$( $TL[32] )   $( $TL[13] )   $( $TL[24] ) ___//¯¯\$( $FY[1] )\ " ,
                " \$( $FY[ 2] )\   [  $Author ]   /$( $FZ[2] )/ " , " /$( $FZ[ 2] )/ $( "  ____  " * 9 ) \$( $FY[2] )\ " , 
                " \$( $FY[13] )\__// " , "  ¯¯¯¯$( " -- ¯¯¯¯" * 13 )  "
            }

            If ( $Table -or $Wrap ) 
            { 
                If ( ( $OP.Count | Select -Last 1 ) % 2 -ne 0 ) { $OP += " // $( " " * 108 ) \\ " } 

                $OP +=  
                " \\_$(           "_" * 108 )_// " , 
                " //¯$(           "¯" * 108 )¯\\ " , 
                " \\ $( "____    " * 13 )____ // " ,
                " ///$( "/¯¯\\__/" * 13 )/¯¯\\\\ " , 
                " \\\$( "\__//¯¯\" * 13 )\__//// " , 
                "  ¯ $( "¯¯¯¯    " * 13 )¯¯¯¯ ¯  "
            }
        }

        End  
        {             
            If ( (  $ForegroundColor ) -and (  $BackgroundColor ) ) { $OP | % { Write-Host -F $ForegroundColor -B $BackgroundColor $_ } }
            If ( (  $BackgroundColor ) -and ( !$ForegroundColor ) ) { $OP | % { Write-Host -B $BackgroundColor $_ } }
            If ( (  $ForegroundColor ) -and ( !$BackgroundColor ) ) { $OP | % { Write-Host -F $ForegroundColor $_ } }
            If ( ( !$ForegroundColor ) -and ( !$BackgroundColor ) ) { $OP | % { Write-Host $_ } }
            If ( $Log ) 
            {
                $Name = "$( ( "Y" , "m" , "d" | % { Get-Date -UFormat "%$_" } ) -join '' )_$( $MyInvocation.MyCommand.Path ).log"

                If ( Test-Path $Log ) 
                { 
                    If ( Test-Path "$Log\$Name" ) { AC "$Log\$Name" $OP }
                    Else { SC "$Log\$Name" $OP }
                }
            }
        }
    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Convert-XAMLToWindow # Modified, originally by Dr. Tobias Weltner    ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        Param ( [ Parameter ( Mandatory ) ] [ String ] $XAML , [ String [] ] $NE = $Null , [ Switch ] $PassThru )

        @( "Framework" , "Core" | % { "Presentation$_" } ) + "WindowsBase" | % { Add-Type -AssemblyName $_ }
 
        $NR = [ XML.XMLReader ]::Create( [ IO.StringReader ] $XAML ) ; $OP = [ Windows.Markup.XAMLReader ]::Load( $NR )
        
        $NE | % { $OP | Add-Member -MemberType NoteProperty -Name $_ -Value $OP.FindName( $_ ) -Force }
 
        If ( $PassThru ) { $OP } Else { $Null = $GUI.Dispatcher.InvokeAsync({ $OP = $GUI.ShowDialog() ; SV -Name OP -Value $OP -Scope 1 }).Wait() ; $OP }

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Show-WPFWindow # Modified, originally by Dr. Tobias Weltner          ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________//¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
        
        Param ( [ Parameter ( Mandatory ) ] [ Windows.Window ] $GUI )

        $OP = $Null ; $Null = $GUI.Dispatcher.InvokeAsync({ $OP = $GUI.ShowDialog() ; SV -Name OP -Value $OP -Scope 1 }).Wait() ; $OP 

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Get-NBSVC # Maps service nodes found on a NetBIOS Domain             ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        $ID =  "00" , "01" , "01" , "03" , "06" , "1F" , "20" , "21" , "22" , "23" , "24" , "30" , "31" , "43" , "44" , "45" , "46" , "4C" , "42" , 
        "52" , "87" , "6A" , "BE" , "BF" , "03" , "00" , "1B" , "1C" , "1D" , "1E" , "2B" , "2F" , "33" , "20" , "01" | % { "<$_>" }

        $Type = ( "UNIQUE" , "GROUP" )[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,1,1,1]

        $Service = "Workstation" , "Messenger" , "Master Browser" , "Messenger" , "RAS Server" , "NetDDE" , "File Server" ,  "RAS Client" , 
        "Interchange(MSMail Connector)" , "Store" , "Directory" , "Server" , "Client" , "Control" , "SMS Administrators Remote Control Tool" , 
        "Chat" , "Transfer" , "on Windows NT" , "mccaffee anti-virus" , "on Windows NT" , "MTA" , "IMC" , "Network Monitor Agent" , 
        "Network Monitor Application" , "Messenger" , "Name" , "Master Browser" , "Controllers" , "Master Browser" , "Browser Service Elections" , 
        "Server" , "" , "" , "DCA IrmaLan Gateway Server" , "MS NetBIOS Browse"

        ( 0,1,3,4,5,6,7,11,12,24,30,34 )  | % { $Service[$_] =                     "$( $Service[$_] ) Service" }
        ( 8,9,10,20,21 )                  | % { $Service[$_] =          "Microsoft Exchange $( $Service[$_] )" }
        ( 30,31,32 )                      | % { $Service[$_] =                 "Lotus Notes $( $Service[$_] )" }
        ( 11,12 )                         | % { $Service[$_] =               "Modem Sharing $( $Service[$_] )" }
        ( 13,15,16 )                      | % { $Service[$_] =          "SMS Clients Remote $( $Service[$_] )" }
        ( 25,26,27 )                      | % { $Service[$_] =                      "Domain $( $Service[$_] )" }
        ( 17,19 )                         | % { $Service[$_] = "DEC Pathworks TCPIP service $( $Service[$_] )" }

        $List = @( ) ; ForEach ( $i in 0..34 ) { $List += [ PSCustomObject ]@{ ID = $ID[$i] ; Type = $Type[$i] ; Service = $Service[$i] } } ; Return $List

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Get-NetworkInfo # Obtains DNS, Subnet, IPV4, NetBIOS                 ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
    
        [ CmdLetBinding () ] Param ( 
        
            [ Parameter ( Position = 0 , Mandatory = $False ) ] [ Switch ] $NetBIOS )

        $OP = @( )

        If ( !$NetBIOS )
        {
            ForEach ( $i in "DNS Suffix" , "IPv4 Address" , "Subnet Mask" )
            {
                ipconfig /all | ? { $_ -like "*$i*" } | % { $_.Split( ':' )[1].Replace( " " , "" ) } | ? { $_.Length -ne 0 } | % { If ( $_ -notin $OP ) { $OP += $_ } }
                "(Preferred)" | ? { $OP -like "*$_*" } | % { $OP = $OP.Replace( "$_" , "" ) } ; If ( $OP -eq $Null ) { $OP += "<NOT DETECTED>" }
            }
            Return [ PSCustomObject ]@{ DNS = $OP[0] ; IPv4 = $OP[1] ; NetMask = $OP[2] }
        }

        If ( $NetBIOS )
        {
            $Report = @( )

            $C = 0

            $OP = @( NBTSTAT -n | ? { $_ -like "*Registered*" } ) +
            @( Start-PingSweep | ? { $_.Success -ne $Null } | % { $_.Success } | % { 
            
            Write-Echo -Function "Host # $C / Scanning for NetBIOS/Domain Controller" 14 0
            $C ++
            NBTSTAT -A $_ } | ? { $_ -like "*Registered*" } )

            ForEach ( $I in ( 0..( $OP.Count - 1 ) ) ) 
            { 
                If ( $OP[$I] -like "*__MSBROWSE__*" ) { $OP[$I] = "    MSBROWSE      <01>  GROUP       Registered " }
                
                $X = $OP[$I].Split( ' ' ) | ? { $_.Length -gt 0 } 

                Get-NBSVC | ? { $X[1] -eq $_.ID -and $X[2] -eq $_.Type } | % { $Service = $_.Service
                    Return [ PSCustomObject ]@{ Name = $X[0] ; ID = $X[1] ; Type = $X[2] ; Service = $Service }

                }
            }
        }
    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Get-HostRange # Obtains a range of potential hosts                   ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        $Class = "Network" , "A" , "B" , "C" , "D / MC" , "E / R&D" , "Broadcast" , "Loopback"
        $Range = [ Ordered ]@{ 0 = 0 ; 1 = 1..126 ; 2 = 128..191 ; 3 = 192..223 ; 4 = 224..239 ; 5 = 240..254 ; 6 = 6 ; 7 = 127 }
        Get-NetworkInfo | % { $IP = $_.IPV4.Split( '.' ) ; $SM = $_.NetMask.Split( '.' ) }
            
        $Full   = @( ) ; $Concat = 0 ; $Close  = 0

        ForEach ( $I in 0..3 )
        {
            If ( $Close -eq 0 )
            {
                If ( $SM[$I] -eq 255 ) { $Full += $IP[$I] } If ( $SM[$I] -ne 255 ) { $Concat = 1 }
                If ( $Concat -eq 1 )
                {
                    $NW   = $Full -Join "." ; $Full = $NW
                    If ( $SM[$I] -eq 0 ) { $NW , $Start , $End , $BC = 0 , 1 , 254 , 255 | % { "$Full.$_" } }
                    Else
                    {
                        ForEach ( $J in 1..5 ) 
                        { 
                            If ( $SM[$I] -in $Range[$J] )
                            {
                                $X  = $Range[$J] ; $Y  = $X | Select -First 1  , $X | Select -Last  1 ; $Y += $Y[1] + 1
                                $NW , $Start , $End , $BC = $Y[0..2] | % { "$Full.$_" }
                            }
                        }
                    }
                    $Close = 1
                }
            }
            If ( $Close -eq 1 ) { If ( $I -ne 3 ) { $NW , $BC , $Start , $End | % { "$_.0" } } }
        }
            
        Return [ PSCustomObject ]@{ Class = ForEach ( $k in 1..5 ) { If ( $IP[0] -in $Range[$k] ) { "Class $( $Class[$k] ) Address" } }
        Prefix = $Full ; IPV4  = $IP -Join "." ; NetMask = $SM -Join "." ; Subnet = $NW ; Start = $Start ; End = $End ; Echo = $BC }

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Get-HostMask # Obtains NetMask Chart, number of hosts and etc.       ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
    
        [ CmdLetBinding () ] Param ( 
        
            [ Parameter ( Position = 0 , Mandatory = $True , ParameterSetName = "0" ) ][ Switch ] $Locate  , 
            [ Parameter ( Position = 0 , Mandatory = $True , ParameterSetName = "1" ) ][ Switch ] $HostMap , 
            [ Parameter ( Position = 0 , Mandatory = $True , ParameterSetName = "2" ) ][ Switch ] $Table   )

            $V  = @( 0..9 | % { "  $_" }  ; 10..99 | % { " $_" } ; 100..255 | % { "$_" } ) | % { "[$_]" } ; $W  = $V.Replace( " " , "¯" ) ; $CT = 0 ;
            $OB = 0..126 ; $Bot = 0..15  | % { "¯" * $_ } ; $Top = 0..15 | % { "_" * $_ } ; $Items = 0..3 ; $GT = $W , $V , $V , $V
            $GX = "Mask" , "Start" , "End" , "Broad" | % { "[$( "¯" * ( 6 - $_.Length ) )$( $_ ):¯" } 
            
            ForEach ( $i in 0..3 ) { $Items[$I] = $GT[$I] | % { $GX[$I] , $_ -join '' } } ; $Subnet , $Start , $End , $Echo = $Items[0..3] ; $OP = @( )

            1 , 2 , 4 , 8 , 16 , 32 , 64 | % { 
                $I = $_ ; $X = 256 / $I ; If ( $I -gt 1 ) { $C = $I..1 } Else { $C = 1 } ; $Y = $C | % { 256 - ( $X ) * $_ } ; If ( $I -gt 1 ) { $C = 0..( $I - 1 ) }
                $C | % { $X * $_ } | % {  If ( $I -eq 1 ) { $OB[$CT] = [ PSCustomObject ]@{ Count = 1 ; Subnet = 0 ; Start = 1 ; End = 254 ; Echo = 255 } }
                    Else { $OB[$CT] = [ PSCustomObject ]@{ Count = "$( $_ / $X + 1 )/$I" ; Subnet = $_ ; Start = $_ + 1 ; End   = $_ + ( $X - 2 ) ; Echo  = $_ + ( $X - 1 ) } }
                    $CT ++
                }
            }

            If (   $Table ) { Return $OB }
            If (  $Locate ) 
            { 
                $Hosts = Get-HostRange ; $PFX = $Hosts.Prefix ; $K = $Hosts | Select Subnet , Start , End , Echo
                $Comp  = $OB | Select @{ Name = "Subnet" ; Expression = { "$PFX.$( $_.Subnet )" } } , @{ Name =  "Start" ; Expression = { "$PFX.$( $_.Start  )" } } , 
                                      @{ Name =    "End" ; Expression = { "$PFX.$( $_.End    )" } } , @{ Name =   "Echo" ; Expression = { "$PFX.$( $_.Echo   )" } }
                $I = 0 ; $Comp | % { If ( $_.Subnet -eq $K.Subnet -and $_.Start -eq $K.Start -and $_.End -eq $K.End -and $_.Echo -eq $K.Echo ) { $Select = $OB[$I] } Else { $I++ } }
                Return $Select
            }

            If ( $HostMap )
            {
                $OB | ? { $_.Count -eq "1" } | % { $Top[14] , "[ 1 _________]" , $Subnet[$_.Subnet] , $Start[$_.Start] , $End[$_.End] , $Echo[ $_.Echo] , $Bot[14] | % { $OP += $_ } }
                ForEach ( $I in 2 , 4 , 8 , 16 , 32 , 64 )
                {
                    $Object = $OB | ? { $_.Count -like  "*/$I*" } ; $OC = $Object.Count - 1 ; $LJ = 0..$OC
                    ForEach ( $I in $LJ )
                    {
                        $Object[$I] | % { $NWQ = $_.Count | % { "[_ $_ $( "_" * ( 9 - $_.Length ) )]" }
                            $LJ[$I] = [ PSCustomObject ]@{ 0 = $Top[14] ; 1 = $NWQ ; 2 = $Subnet[$_.Subnet] ; 3 = $Start[$_.Start] ; 4 = $End[$_.End] ; 5 = $Echo[$_.Echo] ; 6 = $Bot[14] } 
                        }
                    }
        
                    If ( $I -eq $OC )
                    {   
                        $OP += 0..6 | % { $LJ[0..7].$_ -join '' }
                        If ( $I -gt 8 ) { $Loop = ( $Object.Count / 8 ) - 1 ; $L = 0 ; $H = 7 ; 
                        Do { $L += 8 ; $H += 8 ; $OP += 0..6 | % { $LJ[$L..$H].$_ -join '' } ; $Loop -= 1 } Until ( $Loop -eq 0 ) }
                    }
                }
                Return $OP
            }
    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Get-TelemetryData # Accesses Internet API's to recover Settings      ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
        
        [ CmdLetBinding () ] Param ( 
        
            [ Parameter ( Position = 0 , ValueFromPipeline = $True ) ][ Alias (  "C" ) ][ String ] $Company     = "Secure Digits Plus LLC" ,
            [ Parameter ( Position = 1 , ValueFromPipeline = $True ) ][ Alias (  "D" ) ][ String ] $Domain      =   "securedigitsplus.com",
            [ Parameter ( Position = 2                             ) ][ Alias ( "DN" ) ][ Switch ] $Certificate )

        If ( !$Domain ) { $Domain = ( Get-NetworkInfo ).DNS }

        [ Net.ServicePointManager ]::SecurityProtocol = [ Net.SecurityProtocolType ]::TLS12

        $X = IRM -URI "http://ipinfo.io/$( ( IWR -URI 'http://ifconfig.me/ip' ).Content )" # < - [ Chrissy LeMaire ]

        $Info  = [ PSCustomObject ]@{ 
            ExternalIP   = $X.IP
            State        = $X.Region
            Organization = $Company
            CommonName   = $Domain
            Location     = $X.City
            Country      = $X.Country
            ZipCode      = $X.Postal
            TimeZone     = $X.TimeZone 
            SiteLink     = "" } 
        
        $Key = "tZqSUOHxpjLy9kyOLKspvyZmjciB0nWpxz6PMl3KQNQBNEnW5sCbTKkKBPalSOBk"

        IRM -URI "https://www.zipcodeapi.com/rest/$Key/info.json/$( $X.Postal )/degrees" -Method Get | % {
            $Info.Location = $_.City
            $Info.SiteLink = "$( ( $_.City.Split(' ') | % { $_[0] } ) -join '' )-$( $X.Postal )" }

        If ( $Certificate ) 
        {   
            $Info | % { 
            Return [ PSCustomObject ]@{ 
            
                IP   = $_.ExternalIP
                ST   = $_.State
                O    = $_.Organization
                CN   = $_.CommonName
                L    = $_.Location
                C    = $_.Country
                Z    = $_.ZipCode
                TZ   = $_.TimeZone 
                NTDS = $_.SiteLink }
            }
        }

        Else { Return $Info }

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Get-NetworkHosts # Gets actual used network host addresses           ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        [ CmdLetBinding () ] Param (

            [ ValidateNotNullOrEmpty()][ Parameter ( Position = 0 , ParameterSetName = "0" , HelpMessage = "Return HostIPs" ) ][ Switch ]    $HostIP ,
            [ ValidateNotNullOrEmpty()][ Parameter ( Position = 0 , ParameterSetName = "1" , HelpMessage = "Return HostMAC" ) ][ Switch ]   $HostMAC ,
            [ ValidateNotNullOrEmpty()][ Parameter ( Position = 0 , ParameterSetName = "2" , HelpMessage = "Dynamic/Static" ) ][ Switch ] $LeaseType ,
            [ ValidateNotNullOrEmpty()][ Parameter ( Position = 0 , ParameterSetName = "3" , HelpMessage = "Pulls all data" ) ][ Switch ]       $All )

        $ARP  = arp -a | ? { $_ -like "*$( ( Get-HostRange ).Prefix )*" -and $_ -notlike "*Interface*" }
        $RARP = $( If ( $ARP.Count -gt 1 ) { 0..( $ARP.Count - 1 ) } Else { 0 } )

        ForEach ( $I in $RARP )
        { 
            $Values = $ARP[$I] | % { $_[0..23] , $_[24..40] , $_[41..56] } | % { $_ -join '' } | % { $_.Replace( ' ' , '' ) }
            $RARP[$I] = [ PSCustomObject ]@{ HostIP = $Values[0] ; HostMAC = $Values[1] ; LeaseType = $Values[2] }
        }

        If ( $HostIP ) { Return $RARP.HostIP } ; If ( $HostMAC ) { Return $RARP.HostMAC } If ( $LeaseType ) { Return $RARP.LeaseType } 
        Else { Return $RARP }

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Start-PingSweep  # Gets actual used network host addresses           ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        [ CmdletBinding ( ) ] Param ( [ Parameter ( Position = 0 ) ] [ Switch ] $Report )

        Get-HostRange | % { $PFX = $_.Prefix }
        Get-HostMask -Locate | % { $HostList = $_.Start..$_.End | % { "$PFX.$_" } }

        $CPU = GCIM Win32_Processor | % { $_.ThreadCount , $_.LoadPercentage }

        # Utilizing Multithreading/Runspace approach based on 'Drew Furgiuele's video here https://www.youtube.com/watch?v=kvSbb6g0tMA
        # Made some significant changes to automatically select the throttle

        $RSP = [ RunspaceFactory ]::CreateRunspacePool( 1 , $CPU[0] )

        $RSP.ApartmentState = $( If ( $CPU[0] -gt 1 ) { "MTA" } Else { "STA" } )

        $RSP.Open()

        $AddScript = { Param ( [ String ] $ComputerName )
        
            IEX "Using Namespace System.Net.NetworkInformation"
            $B = @( 1..9 + "abcdef".ToCharArray() | % { "0x6$_" } ; 0..7 | % { "0X7$_" } ; 1..9 | % { "0x6$_" } ) # < - Condensed version of Test-ConnectionAsync by Boe Prox
            New-Object PingOptions | % { $O = $_ ; $_.TTL = 128 ; $_.DontFragment = $False }
            $Object = ( New-Object Ping ).SendPingAsync( $ComputerName , 100 , $B , $O )
            Return $Object
        }

        $Threads = @( )

        Write-Echo -Function "Beginning Subnet Ping-Sweep, please wait" 10 0

        $Stopwatch = [ System.Diagnostics.Stopwatch ]::StartNew()

        ForEach ( $H in $Hostlist )
        {
            $RSO = [ PSCustomObject ]@{ Runspace = [ PowerShell ]::Create() ; Invoker = $Null }
            $RSO.Runspace | % { $_.RunspacePool = $RSP ; [ Void ]$_.AddScript( $AddScript ) ; [ Void ]$_.AddArgument( $H ) }
            $RSO.Invoker  = $RSO.Runspace.BeginInvoke()
            $Threads += $RSO
        }

        While ( $Threads.Invoker.IsCompleted -contains $False ) { }

        $Stopwatch.Stop()

        Write-Echo -Function "Ping-Sweep Complete @: $( $Stopwatch.Elapsed )" 10 0

        $ThreadResults = @( )
        ForEach ( $T in $Threads )
        {
            $ThreadResults += $T.Runspace.EndInvoke( $T.Invoker )
            $T.Runspace.Dispose()
        }

        $Return = @{ Success = @( ) ; Failure = @( ) }

        $ThreadResults.Result | % { 
        
            If ( $_.Status -eq "Success" ) 
            {
                $Return.Success += $_.Address.ToString()
            }
        }

        $HostList | ? { $_ -notin $Return.Success } | % { $Return.Failure += $_ }

        Return $Return

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Start-NetworkInfo  # Collects all needed interface data              ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        $Subtable     = 0..4 ; $Section = @( )

        $NetworkInfo  = @( Get-NetworkInfo )
        $Section     += "Network Information"
        $Names        = @( $NetworkInfo | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )
        $Values       = @( $Names | % { $NetworkInfo.$( $_ ) } )
        $Subtable[0]  = New-Subtable -Items $Names -Values $Values

        $HostRange    = @( Get-HostRange )
        $Section     += "Host Range Information"
        $Names        = @( $Hostrange | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )[0,5,3,4,7,6,2,1]
        $Values       = @(     $Names | % { $HostRange.$( $_ ) } )
        $Subtable[1]  = New-Subtable -Items $Names -Values $Values

        $NetworkHosts = @( Get-NetworkHosts -All )
        $Section     += "Network Host IP/MAC"
        $Names        = @( $NetworkHosts | % { $_.HostIP  } )
        $Values       = @( $NetworkHosts | % { $_.HostMAC } )
        $Subtable[2]  = New-Subtable -Items $Names -Values $Values

        $NetBIOS      = @( Get-NetworkInfo -NetBIOS )
        $Section     += "NetBIOS / Domain Information"
        $Names        = @( $NetBIOS | % { $_.Name    } )
        $Values       = @( $NetBIOS | % { $_.Service } )
        $SubTable[3]  = New-Subtable -Items $Names -Values $Values

        $Certificate  = @( Get-TelemetryData )
        $Section     += "Certificate / Location Information"
        $Names        = @( $Certificate | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )[2,6,4,0,3,1,7,8,5]
        $Values       = @(       $Names | % { $Certificate.$( $_ ) } )
        $SubTable[4]  = New-Subtable -Items $Names -Values $Values

        $Table        = New-Table -Title "Domain Controller Bootstrap" -Depth 5 -ID ( $Section | % { "( $_ )" } ) -Table $Subtable

        Write-Echo -Table $Table 10 0

        $NB           = $NetBIOS | ? { $_.ID -eq "<1C>" } | % { $_.Name } ; If ( $NB -eq $Null ) { $NB = ( gcim Win32_ComputerSystem ).Domain }
        $Hosts        = @( )
        $Hosts       += $HostRange | % { $_.SubNet , $_.Start , $_.End , $_.Echo }
        $HostIPList   = $NetworkHosts  | ? { $_.HostIP -notin $Hosts } | % { $_.HostIP }
        $HostMACList  = $NetworkHosts  | ? { $_.HostIP -notin $Hosts } | % { $_.HostMAC }

        Return  [ PSCustomObject ]@{ 
                DNS         = $NetworkInfo.DNS
                NetBIOS     = $NB
                IPv4        = $NetworkInfo.IPv4
                NetMask     = $NetworkInfo.NetMask
                Class       = $HostRange.Class
                Prefix      = $HostRange.Prefix
                SubNet      = $HostRange.Subnet
                Start       = $HostRange.Start
                End         = $HostRange.End
                Echo        = $Hostrange.Echo 
                HostIP      = @( $HostIPList  )
                HostMAC     = @( $HostMACList )
                SiteLink    = $Certificate.SiteLink
        }
    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
    Function Get-NetworkStatistics                                               #¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#\______________________________________________________________________________/¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

        $OP     = netstat -ant | ? { $_ -like "*TCP*" -or $_ -like "*UDP*" }

        $OP     | ? { $_ -notmatch '\*' } | % { $X = $_.Split( ' ' ) | ? { $_.Length -gt 0 }
        Return  [ PSCustomObject ]@{ Protocol = $X[0] ; Local = $X[1] ; Foreign = $X[2] ; LinkState = $X[3] ; Stream = $X[4] } }

        $OP     | ? { $_    -match '\*' } | % { $X = $_.Split( ' ' ) | ? { $_.Length -gt 0 }
        Return  [ PSCustomObject ]@{ Protocol = $X[0] ; Local = $X[1] ; Foreign = "*:*" ; LinkState = "*:*" ; Stream = "*:*" } }

    }#                                                                            ____    ____    ____    ____    ____    ____    ____    ____    ____  
#//¯¯\\__________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
        Write-Echo -Free 10 0 ; Sleep 1 # What Free Actually Means               #¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
     #\______________________________________________________________________________//¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
     # ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
