<#___ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____  
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//  [ Secure Digits Plus LLC | Hybrid | Desired State Controller ]  \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯       _____________________________________________________        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯        __/¯¯\__[ Dynamically Engineered Digital Security ]__/¯¯\__         ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  _________________________ ________________ ___________________________________  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__// | Application Development | Virtualization | Network and Hardware Magistration | \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//   https://www.securedigitsplus.com | Server-Client | Seedling-Spawning Script    \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__// 
//¯¯    
\\  [ Install-HybridClient ] @: Accesses the Deployment Share to configure a Windows 10 Client image, after it has been deployed.
//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____      
\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\__/---\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//==\\___  
//¯¯\\___________________________________________________________________________________¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯¯ ¯¯ ¯¯¯¯ -- ¯¯¯\\ 
\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\\___ __ ____ -- ____ __ ____ -- ____ __ ____ -- ____ __ ___// 
 ¯¯¯\\__[ Declares Namespaces, Loads Modules ]__________________________________________//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯\\==//¯¯\----/¯¯¯  
     ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

#>    @( "Principal" , "AccessControl" | % { "Security.$_" } ; "Management.Automation" , "DirectoryServices" ) | % { IEX "Using Namespace $_" }
                              
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-HybridTarget # Resolves passthrough share settings ________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        "$Env:AppData\Root.txt" | % { 
        
            $Return = "$( GC $_ )" | ConvertFrom-JSON
            RI $_ -Force 
        }

        Return $Return                                                              #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}# ___                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function New-SubTable # Converts array of keys and values into an Object ___________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ][ String [] ]  $Items ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ][ String [] ] $Values )

        $Table = [ PSCustomObject ]@{ }

        If ( $Items.Count -eq $Values.Count )
        {
            If ( $Items.Count -gt 1 ) 
            { 
                $Count = 0..( $Items.Count - 1 ) 
            }
            
            $Count | % { $Table | Add-Member -MemberType NoteProperty -Name "Item:$_" -Value @{ ID = "$( $Items[$_] )" ; Value = "$( $Values[$_] )" } }
        }
        
        If ( $Items.Count -ne $Values.Count ) 
        { 
            Throw '$Items -ne $Values' 
        }
        
        Return $Table                                                                #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function New-Table # Converts array of objects into a single object _________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True , ValueFromPipeline = $True ) ][         String    ] $Title ,
            [ Parameter ( Position = 1 , Mandatory = $True , ValueFromPipeline = $True ) ][            Int    ] $Depth ,
            [ Parameter ( Position = 2 , Mandatory = $True , ValueFromPipeline = $True ) ][         String [] ] $ID    ,
            [ Parameter ( Position = 3 , Mandatory = $True , ValueFromPipeline = $True ) ][ PSCustomObject [] ] $Table )

        $Object = [ PSCustomObject ]@{ Class = $Title }
        
        If ( ( $ID.Count -ne $Depth ) -or ( $Table.Count -ne $Depth ) ) 
        { 
            Throw '$Depth -ne $ID.Count or $Table.Count' 
        }
        
        If ( $Depth -eq 1 ) 
        { 
            $Count = 1 
        } 
        
        If ( $Depth -gt 1 ) 
        { 
            $Count = 0..( $Depth - 1 ) 
        }
        
        $C = $Null ; $Count | % {

            If ( $Depth -gt 1 )
            {   
                If ( $C -ne $Null ) 
                { 
                    $C = $C + 1 
                } 
                
                If ( $C -eq $Null ) 
                { 
                    $C = 0 
                } 
                
                $Index   = $ID[$C]
                $Section = $Table[$C] 
            }

            If ( $Depth -eq 1 )
            {   
                $C = 0 ; $Index = $ID ; $Section = $Table 
            }

            $Object | Add-Member -MemberType NoteProperty -Name "ID:$C" -Value $Index

            $Keys = @( $Section | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } )

            ForEach ( $S in $Keys )
            {   
                $SubTable = [ Ordered ]@{ }

                ForEach ( $K in $Keys ) 
                { 
                    $Section.$K | % { 
                    
                        $SubTable.Add( "$K" , @{ ID = $_.ID ; Value = $_.Value } ) 
                    } 
                } 
            } 

            $Object | Add-Member -MemberType NoteProperty -Name "Section:$C" -Value $SubTable
        }
        Return $Object                                                               #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Write-Theme # Even your grandmother might say "That's pretty cool."_________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        [ CmdLetBinding ( ) ] Param ( 

            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = "0" ) ][         Switch ]   $Action ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = "1" ) ][         String ] $Function ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = "2" ) ][ PSCustomObject ]    $Table ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = "3" ) ][         Switch ]     $Free ,
            [ Parameter ( Mandatory = $True , Position = 0 , ValueFromPipeline = $True , ParameterSetName = "4" ) ][         Switch ]     $Foot ,
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = "0" ) ][ String ]       $Type  ,
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = "0" ) ][ String ]       $Info  ,
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = "0" ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = "1" ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = "2" ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = "3" ) ]
            [ Parameter ( Position = 1 , ValueFromPipeline = $True , ParameterSetName = "4" ) ][    Int ]   $Edge = 11 ,
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = "0" ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = "1" ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = "2" ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = "3" ) ]
            [ Parameter ( Position = 2 , ValueFromPipeline = $True , ParameterSetName = "4" ) ][    Int ] $Center = 12 ,
            [ Parameter ( Position = 5 , ValueFromPipeline = $True , ParameterSetName = "0" ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = "1" ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = "2" ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = "3" ) ]
            [ Parameter ( Position = 3 , ValueFromPipeline = $True , ParameterSetName = "4" ) ][    Int ]   $Font = 15 ,
            [ Parameter ( Position = 6 , ValueFromPipeline = $True , ParameterSetName = "0" ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = "1" ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = "2" ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = "3" ) ]
            [ Parameter ( Position = 4 , ValueFromPipeline = $True , ParameterSetName = "4" ) ][    Int ]   $Back =  0 ,
            [ Parameter ( Position = 5 , ValueFromPipeline = $True , ParameterSetName = "2" ) ][ String ]      $Prompt )


        Begin
        {
            $GX  = $Edge , $Center , $Font , $Back ; $S = " // " , " \\ " ; $F = "/¯¯\" , "\__/" ; $L = $S[1..0] ; $R = $S[0..1] ; 
            $M   = "¯" , "_" , " " , "-" ; 0..3 | % { IEX "`$M$_ = 0..120 | % { '$( $M[$_] )' * `$_ }" } ; 
            $Echo = [ PSCustomObject ]@{ ST = @{ } ; FG = @{ } ; BG = @{ } }
        }

        Process
        {
            If ( $Function )
            {
                $FA = $Function ; $FL = $FA.Length ; If ( $FL -le 58 ) { $Y = " ]$( $M1[ 62 - $FL ] )__/" } If ( $FL -gt 58 ) { $FA = "$( $FA[ 0..58 ] -join '' )... " ; $Y = "]__/" }
                
                $Echo | % { $_.ST = 0..4 ; $_.FG = 0..4 ; $_.BG = 0..4 
                
                    $_.ST[0] = "  ____  $( $M2[68] )$( "  ____  " * 5 )"                                   ; $_.FG[0] = 0                               ; $_.BG[0] = 3
                    $_.ST[1] = @( " /" , $F[0] , "\$( $M1[70] )/" ;  $F  * 4 ; $F[0] , "\ " )              ; $_.FG[1] = @( @( 0 , 1 ) * 6 ; 0  )        ; $_.BG[1] = @( 3 ) * 14
                    $_.ST[2] = @( " \" , $F[1] , "/$( $M0[70] )\" ; @( $F[ 1 , 0 ] )  * 4 ; $F[1] , "/ " ) ; $_.FG[2] = @( 0 ; @( 1 ) * 11 ; 0 )        ; $_.BG[2] = @( 3 ) * 14
                    $_.ST[3] = @( "  ¯¯¯\" , "\__[ " , $FA , $Y ; @( $F ) * 4 ; "/¯¯¯  " )                 ; $_.FG[3] = @( 0 , 1 , 2 ; @( 1 , 0 ) * 6 ) ; $_.BG[3] = @( 3 ) * 14
                    $_.ST[4] = "      $( $M0[72] )$( "    ¯¯¯¯" * 4 )      "                               ; $_.FG[4] = 0                               ; $_.BG[4] = 3
                }
            }

            If ( $Action )
            {
                $T , $I = $Type , $Info
                
                $T = $( If ( $T.Length -gt 18 ) { "$( $T[ 0..17 ] -join '' )..." } Else { "$( $M2[ ( 21 - $T.Length ) ] )$T" } )
                $I = $( If ( $I.Length -gt 66 ) { "$( $I[ 0..65 ] -join '' )..." } Else { "$I$( $M2[ ( 69 - $I.Length ) ])" } )

                $Echo | % { $_.ST = 0..4 ; $_.FG = 0..4 ; $_.BG = 0..4 

                    $_.ST[0] = "  ____    $( $M1[100] )      "                              ; $_.FG[0] = 0 ;                         $_.BG[0] = 3
                    $_.ST[1] = @( " /" ; $F[ 0 , 1 ] ; "/$( $M0[98])\" , "\___  " )         ; $_.FG[1] = 0 , 1 , 0 , 1 , 0 ;         $_.BG[1] = @( 3 ) * 5
                    $_.ST[2] = " \" , $F[1] , "/¯¯¯ " , " $T : $I " , "___/" , $F[0] , "\ " ; $_.FG[2] = 0 , 1 , 1 , 2 , 1 , 1 , 0 ; $_.BG[2] = @( 3 ) * 7
                    $_.ST[3] = @( "  ¯¯¯\" , "\$( $M1[98] )/" ; $F[ 0 , 1 ] ; "/ " )        ; $_.FG[3] = 0 , 1 , 0 , 1 , 0 ;         $_.BG[3] = @( 3 ) * 5
                    $_.ST[4] = "      $( $M0[100] )    ¯¯¯¯  "                              ; $_.FG[4] = 0 ;                         $_.BG[4] = 3
                }
            }

            If ( $Free )
            {
                $Flag = [ PSCustomObject ]@{ D = ( "m" , "d" , "Y" | % { Get-Date -UFormat "%$_" } | % { "$( $_.ToCharArray() )" } ) -join ' / ' ; A = " //¯" , " \\" , " //" , 
                " \\_" ; E = "[=]" , "\_/" , "| |" ; B = ( "[=]" , "\_/" )[ 0 , 1 , 0 ] -join '' ; S = "Beginning the fight against Technological Tyranny and Cyber Criminal Activities" , 
                "Dynamically Engineered Digital Security" , "Application Development - Virtualization" , "Network & Hardware Magistration" , "What America Once Stood For", 
                "($( [ Char ]960 )) A Heightened Sense Of Security ($( [ Char ]960 ))" , "HYBRID" , "BY" , "SECURE-DIGITS-PLUS-LLC" , "MICHAEL C COOK SR" } ; $BG = 0..33 ;$FG = 0..33
                
                $STR  = $Flag | % { $_.S[0..5] | % { "[ $_ ]" } ; $_.S[6..9] | % { $_.ToCharArray() -join ' ' } } ; $Sig = $Flag.D + '  |  ' + $STR[9].Replace( "  " , " " )
                $ST0  = "   \" , "\__/" , "/   " ; $ST1 = "   /" , "/¯¯\" , "\   " ; $STR0 = @( $ST1 ; " \" , "\$( "  *   " * 6 )]" ) ; $STR1 = @( $ST0 ; " /" , "/$( "     *" * 5 )      ]" )

                $Filter = @{ X = @( 0 , 1 , 2 , 3 ; @( 4 , 4 , 5 , 6 ) * 3 ; 4 , 4 , 7 ; @( 8 ) * 11 ; 9 , 2 , 1 , 0 ) ; Y = @{ 0 = 0 ; 1 = 2 ; 2 = 5 ; 3 = 4 ; 
                4 = @( 4 ) * 4 ; 5 = 4 , 4 , 5 , 4 ; 6 = 4 , 4 , 5 , 7 , 5 , 4 ; 7 = 4 , 5 , 4 ; 8 = 4 , 5 , 8 , 5 , 4 ; 9 = 4 , 8 , 4 } ; Z = @( 0 , 1 , 0 ) }
                ForEach ( $i in $FG ) { $Filter | % { $X = $_.Y[ ( $_.X[ $I ] ) ] ; $FG[$I] = $( If ( $I -in 1..32 ) { @( $_.Z ; $X ; $_.Z ) } Else { $X } ) } }

                $Filter = @{ X = @( 0 , 1 , 1 , 1 ; @( 2 , 2 , 3 , 4 ) * 3 ; 2 , 2 , 5 , 6 , 7 , 7 ; @( 6 , 6 , 7 , 7 ) * 2 ; 8 , 1 , 1 , 0 ) ; 
                Y = @{ 0 = 7 ; 1 = @( 7 ) * 7 ; 2 = 6 , 5 ; 3 = 6 , 4 ; 4 = 6 , 4 , 4 , 4 ; 5 = 4 ; 6 = 4 , 7 , 4 ; 7 = 5 , 7 , 5 ; 8 = @( 7 ) * 9 } ; Z = @( 7 ) * 4 } 
                ForEach ( $i in $BG ) { $Filter | % { $X = $_.Y[ ( $_.X[ $I ] ) ] ; $BG[$I] = $( If ( $I -in 4..29 ) { @( $_.Z ; $X ; $_.Z ) } Else { $X } ) } }

                $Echo | % { $_.FG = 0..33 ; $_.BG = 0..33 ; $_.ST = 0..33
                
                    ForEach ( $i in 0..33 ) { $_.FG[$I] = $FG[$I] ; $_.BG[$I] = $BG[$I] }

                    $_.ST[ 0] = "    ____    $( $M1[92] )    ____    " ; 
                    $_.ST[ 1] = "   /" , "/¯¯\" , "\" , "==[$( $M0[92] )]==" , "/" , "/¯¯\" , "\   "
                    $_.ST[ 2] = @( $ST0 ; "     $( $STR[0] )    " ; $ST0 ) 
                    $_.ST[ 3] = @( $ST1 ; "  $( $M1[88] )  " ; $ST1 )
                    $_.ST[ 4] = @( $ST0 ; " /" , "/¯$( $M0[35] )]" , "[$( $M0[47] )¯\" , "\ " ; $ST0 ) ; 
                    $_.ST[ 5] = @( $STR0 ; "[$( $M1[47] )_/" , "/ " ; $ST1 )
                    $_.ST[ 6] = @( $STR1 ; "[$( $M0[47] )¯\" , "\ " ; $ST0 ) ; 
                    $_.ST[ 7] = @( $STR0 ; "[__" , $STR[1] , "___/" , "/ " ; $ST1 )
                    $_.ST[ 8] = @( $STR1 ; "[$( $M0[47] )¯\" , "\ " ; $ST0 ) ; 
                    $_.ST[ 9] = @( $STR0 ; "[$( $M1[47] )_/" , "/ " ; $ST1 )
                    $_.ST[10] = @( $STR1 ; "[$( $M0[47] )¯\" , "\ " ; $ST0 ) ; 
                    $_.ST[11] = @( $STR0 ; "[_" , $STR[2] , "___/" , "/ " ; $ST1 )
                    $_.ST[12] = @( $STR1 ; "[$( $M0[47] )¯\" , "\ " ; $ST0 ) ; 
                    $_.ST[13] = @( $STR0 ; "[$( $M1[47] )_/" , "/ " ; $ST1 )
                    $_.ST[14] = @( $STR1 ; "[$( $M0[47] )¯\" , "\ " ; $ST0 ) ; 
                    $_.ST[15] = @( $STR0 ; "[______" , $STR[3] , "_______/" , "/ " ; $ST1 )
                    $_.ST[16] = @( $ST0  ; " /" , "/  $( $STR[4] )   ]" , "[$( $M0[47] )¯\" , "\ " ; $ST0 )
                    $_.ST[17] = @( $ST1  ; " \" , "\$( $M1[36] )]" , "[$( $M1[47] )_/" , "/ " ; $ST1 )
                    $_.ST[18] = @( $ST0  ; " /" , "/$( $M0[86] )\" , "\ " ; $ST0 )
                    $_.ST[19] = @( $ST1  ; " \" , "\$( $M1[32] )" , "$( $Flag.B )\__/$( $Flag.B )" , "$( $M1[32] )/" , "/ " ; $ST1 )
                    $_.ST[20] = @( $ST0  ; " /" , "/$( $M0[32] )" , "$( $Flag.E[2] )  $( $M1[11] )   $( $Flag.E[2] )" , "$( $M0[32] )\" , "\ " ; $ST0 )
                    $_.ST[21] = @( $ST1  ; " \" , "\$( $M1[32] )" , "$( $Flag.E[0] )_ $( $STR[6] ) __$( $Flag.E[0] )" , "$( $M1[32] )/" , "/ " ; $ST1 )
                    $_.ST[22] = @( $ST0  ; " /" , "/$( $M0[32] )" , "$( $Flag.E[2] + $M0[16] + $Flag.E[2] )" , "$( $M0[32] )\" , "\ " ; $ST0 )
                    $_.ST[23] = @( $ST1  ; " \" , "\_$( $M1[16])" , "$( $Flag.B * 2 )      $( $STR[7] )       $( $Flag.B * 2 )" , "$( $M1[16] )_/" , "/ " ; $ST1 )
                    $_.ST[24] = @( $ST0  ; " /" , "/$( $M0[17] )" , "$( $Flag.E[2] + $M0[15] )      $( $M0[3] )       $( $M0[15] + $Flag.E[2] )" , "$( $M0[17] )\" , "\ " ; $ST0 )
                    $_.ST[25] = @( $ST1  ; " \" , "\$( $M1[17] )" , "$( $Flag.E[0] )  $( $STR[8] ) $( $Flag.E[0] )" , "$( $M1[17] )/" , "/ " ; $ST1 )
                    $_.ST[26] = @( $ST0  ; " /" , "/$( $M0[17] )" , "$( $Flag.E[1] )  $( $M0[43] ) $( $Flag.E[1] )" , "$( $M0[17] )\" , "\ " ; $ST0 )
                    $_.ST[27] = @( $ST1  ; " \" , "\$( $M1[11] )" , "$( $Flag.B * 3 + $Flag.E[0] )\__/$( $Flag.E[0] + $Flag.B * 3 )" , "$( $M1[11] )/" , "/ " ; $ST1 )
                    $_.ST[28] = @( $ST0  ; " /" , "/$( $M0[11] )" , "$( $Flag.E[0] + $M0[58] + $Flag.E[0] )" , "$( $M0[11] )\" , "\ " ; $ST0 )
                    $_.ST[29] = @( $ST1  ; " \" , "\$( $M1[11] )" , "$( $Flag.E[0] )  $SIG  $( $Flag.E[0] )" , "$( $M1[11] )/" , "/ " ; $ST1 )
                    $_.ST[30] = @( $ST0  ; "  $( $M0[12] )" , "¯¯   $( $M0[19] )     $( $M0[30] )   ¯¯" , "$( $M0[12] )  " ; $ST0 )
                    $_.ST[31] = @( $ST1  ; "$( $M2[25] + $STR[5] + $M2[25] )" ; $ST1 ) ; 
                    $_.ST[32] = "   \" , "\__/" , "/" , "==[$( $M1[92] )]==" , "\" , "\__/" , "/   "
                    $_.ST[33] = "    ¯¯¯¯    $( $M0[92] )    ¯¯¯¯    "
                }
            }

            If ( $Foot )
            {
                $SR = "Secure Digits Plus LLC" , "Hybrid | Desired State Controller" , "Dynamically Engineered Digital Security" , "| Application Development" ,
                "Virtualization" , "Network and Hardware Magistration |" , "https://www.securedigitsplus.com" , "Server-Client" , "Seedling-Spawning Script" ,
                "[ Provisional Author : Michael C Cook Sr. | 'The Buck Stops Here' ]";
                
                $Title , $Strength , $Mark = ( 0..1 ) , ( 3..5 ) , ( 6..8 ) | % { $SR[$_] -join ' | ' }

                $Filter = @{ X = @{ 0 = @( 1 , 0 ) * 14 ; 1 = @( @( 0 , 1 ) * 13 ; 0 ) ; 2 = @( 0 ; @( 1 ) * 27 ; 0 ) ; 3 = @( 2 , 1 ; @( 0 , 1 ) *  9 ; 2 ) ; 
                4 = @( 2 , 1 ; @( 0 ) * 10 ; 1 , 2 ) ; 5 = @( 2 , 1 , 0 , 4 , 0 , 1 , 2 ) ; 6 = @( 2 , 0 , 4 , 0 , 2 ) ; 13 = 2 , 0 , 0 , 0 , 2 ; 14 = @( 2 ; @( 0 ) * 11 ; 2 ) ; 
                15 = @( 2 ; @( 0 , 1 ) * 9 ; 0 , 2 ) ; 16 = @( 0 , 2 , 1 , 2 ; @( 1 ) * 19 ; 2 , 1 , 2 , 0 ) ; 17 = @( 1 , 0 ) * 14 ; 18 = @( 0 , 1 ) * 14 } ; 
                Y = @( 28 , 27 , 29 , 29 , 22 , 15 , 13 ; @( 11 ) * 6 ; 13 , 21 , 29 ; @( 28 ) * 3 ) } ; 7..12 | % { $Filter.X[$_] = 0 , 4 , 0 } ; 

                $Echo  | % { $_.ST = 0..18 ; $_.FG = 0..18 ; $_.BG = 0..18 

                    ForEach ( $I in 0..18 ) 
                    { 
                        $_.FG[$I] = $( If ( $I -in 3, 14, 15 ) { @( 0 , 1 , 2 , 1 ; $Filter.X[$I] ; 1 , 2 , 1 , 0 ) }
                                       If ( $I -in     4..13 ) { @( 0 , 1 , 2 , 2 ; $Filter.X[$I] ; 2 , 2 , 1 , 0 ) }
                                       If ( $I -notin  3..15 ) { $Filter.X[$I] } )

                        $_.BG[$I] = @( @( 3 ) * $Filter.Y[$I] )
                    }

                    $101 = @( $F[1] ; $F ) ; $010 = @( $F ; $F[0] ) ; $10 = @( $F[1 , 0] )         
                
                    $_.ST[ 0] = @( "        " ; @( "____" , " -- " ) * 12 ; "____" , "        " )
                    $_.ST[ 1] = @( "    ___/" ; $F  * 12 ; $F[ 0 ] , "\___    " )
                    $_.ST[ 2] = @( "   /"     ; $F  * 13 ; $F[ 0 ] , "\   " )
                    $_.ST[ 3] = @( "   \"     ; $10 * 13 ; $F[ 1 ] , "/   " )
                    $_.ST[ 4] = @( "   /"     ; $F  *  2 ; $F[ 0 ] , "\ " ; @( "  ¯¯¯¯  " ) * 8 ; " /" ; $F * 2 ; $F[0] , "\   " )
                    $_.ST[ 5] = @( "   \"     ; $10 *  2 ; $F[ 1 ] , "/ " , " [ $Title ] " , " \" , $F[1] ; $F * 2 ; "/   " )
                    $_.ST[ 6] = @( "   /"     ; $F * 2  ; "/¯¯¯" , "   ¯¯¯¯\__/$( $M0[47] )\__/¯¯¯   " , "¯¯¯\" ; $10 * 2 ; "\   " )
                    $_.ST[ 7] = @( "   \"     ; $101 ; "/¯¯¯" , "         __/¯¯\ ([ $( $SR[2] ) ]) /¯¯\__        " , "¯¯¯\" ; $101 ; "/   " )
                    $_.ST[ 8] = @( "   /"     ; $010 ; "\" , "  $( $M1[9] )/¯¯\__/$( $M1[9] ) $( $M1[16] ) $( $M1[20] )\__/¯¯\$( $M1[8] )  " , "/" ; $010 ; "\   " )
                    $_.ST[ 9] = @( "   \"     ; $101 ; "/" , " $Strength " , "\" ; $101 ; "/   " )
                    $_.ST[10] = @( "   /"     ; $010 ; "\" , "  $( $M0[25] ) $( $M0[16] ) $( $M0[35] )  " , "/" ; $010 ; "\   " )
                    $_.ST[11] = @( "   \"     ; $101 ; "/" , "   $Mark    " , "\" ; $101 ; "/   " )
                    $_.ST[12] = @( "   /"     ; $010 ; "\___" , "$( $M0[32] )   $( $M0[13] )   $( $M0[24] ) " , "___/" ; $010 ; "\   " )
                    $_.ST[13] = @( "   \"     ; $10  * 2 ; "\ " , "  $( $SR[9] )   " , " /" ; $F * 2 ; "/   " )
                    $_.ST[14] = @( "   /"     ; $F * 2 ; "/ " ; @( "  ____  " ) * 9 ; " \" ; $10 * 2 ; "\   " )
                    $_.ST[15] = @( "   \"     ; $10 * 13 ; $F[1] ,"/   " )
                    $_.ST[16] = @( "    ¯¯¯\" ; $10 * 12 ; $F[1] , "/¯¯¯    " )
                    $_.ST[17] = @( "        " , "¯¯¯\" , $F[1] ; $F * 11 ; "/¯¯¯" , "        " )
                    $_.ST[18] = @( "        " ; @( " -- " , "¯¯¯¯" ) * 12 ; "            " ) 
                }
            }

            If ( $Table )
            {
                $Count  = 4

                $LM = 0..40 | % { "_" * $_ } ; $RM = 0..40 | % { "_" * $_ }

                $Table | GM | ? { $_.MemberType -eq "NoteProperty" } | % { $_.Name } | % { 

                    If ( $_ -like   "*Class*" ) { $Count += $Table.$_.Count * 6 }
                    If ( $_ -like      "*ID*" ) { $Count += $Table.$_.Count * 3 }
                    If ( $_ -like "*Section*" ) { $Count += $Table.$_.Count     }
                }
                
                $ID     = $Table | GM | ? { $_.MemberType -eq "NoteProperty" } ; 
                
                $Title  = $ID | ? { $_.Name -eq "Class" } | % { $Table.$( $_.Name ) } 
                
                $Title  | % { If ( $_.Length -gt 83 ) { "$( $_.Substring( 0 , 78 ) )..." } Else { $_ } } | % { $Title = "[ $_ ]" }

                92 - $Title.Length | % { $Div = $_ / 2 ; $Rem = $_ % 2 ; $Sub = $Div % 2 ; $Add = "_" * $Sub }

                        $Output = $LM[$Div] + $Add + $Title + $RM[ ( $Div - $Sub ) ]

                $Echo | % { $_.ST = 0..$Count ; $_.FG = 0..$Count ; $_.BG = 0..$Count


                    $_.ST[0] = "  ____    $( $M1[100] )      "                                ; $_.FG[0] = 0 ;                         $_.BG[0] = 3
                    $_.ST[1] = @( " /" ; $F[ 0 , 1 ] ; "/$( $M0[98])\" , "\___  " )           ; $_.FG[1] = 0 , 1 , 0 , 1 , 0 ;         $_.BG[1] = @( 3 ) * 5
                    $_.ST[2] =    " \" , $F[1] , "/¯¯¯  " , $Output , "  ___/" , $F[0] , "\ " ; $_.FG[2] = 0 , 1 , 1 , 2 , 1 , 1 , 0 ; $_.BG[2] = @( 3 ) * 7
                    $_.ST[3] = @( " //¯¯\" , "\$( $M1[98] )/" ; $F[ 0 , 1 ] ; "/ " )          ; $_.FG[3] = 0 , 1 , 0 , 1 , 0 ;         $_.BG[3] = @( 3 ) * 5
                    $_.ST[4] = " \\   $( $M0[100] )    ¯¯[]  "                                ; $_.FG[4] = 0 ;                         $_.BG[4] = 3
                }

                $Index   = @( ) ; $Section = @( ) ; $Z = 5

                $ID | ? { $_.Name -like      "*ID:*" } | % {   $Index += $Table.$( $_.Name ) }
                $ID | ? { $_.Name -like "*Section:*" } | % { $Section += $Table.$( $_.Name ) }

                If ( ( $Index.Count - 1 ) -gt 0 ) { $Count = 0..( $Index.Count - 1 ) } Else { $Count = 0 }
                
                $Count | % { 
                
                    If ( $Index.Count -gt 1 ) 
                    {
                        If (   $C -ne $Null )                            { $C = $C + 1 }

                        If ( ( $C -eq $Null ) -and ( $Name -eq $Null ) ) { $C = 0 }
    
                        $Name = $Index[$C] ; $Item = $Section[$C]
                    }

                    If ( $Index.Count -eq  1 )
                    { 
                        $Name = [ String ]$Index ; $Item = $Section  
                    }
                    
                    If ( $Name.Length -gt 93 )
                    { 
                        $Name = "( $( $Name[0..93] -join '' ) ) ... " 
                    }

                    $Echo | % {

                        $_.ST[$Z] = @( $L[ $Z % 2 ] , $M1[ 108 ] , $R[ $Z % 2 ] )                                        ; $_.FG[$Z] = @( 0 ) * 3        ; $_.BG[$Z] = @( 3 ) * 3 ; $Z++
                        $_.ST[$Z] = @( $L[ $Z % 2 ] , $M3[ 10  ] , $Name , $M3[ ( 98 - $Name.Length ) ] , $R[ $Z % 2 ] ) ; $_.FG[$Z] = 0 , 1 , 2 , 1 , 0 ; $_.BG[$Z] = @( 3 ) * 5 ; $Z++
                        $_.ST[$Z] = @( $L[ $Z % 2 ] , $M0[ 108 ] , $R[ $Z % 2 ] )                                        ; $_.FG[$Z] = @( 0 ) * 3        ; $_.BG[$Z] = @( 3 ) * 3 ; $Z++
                    }

                    $Keys = @( $Item.Keys )

                    ForEach( $IX in ( 0..( $Item.Keys.Count - 1 ) ) )
                    {
                        $Item."Item:$IX" | % { $Key = $_.ID ; $Val = $_.Value }
                        $Key = $( If ( $Key.Length -gt 20 ) { "$( $Key[0..20] -join '' ) ... " } Else { "$( $M2[ ( 25 - $Key.Length ) ])$Key" } )
                        $Val = $( If ( $Val.Length -gt 74 ) { "$( $Val[0..74] -join '' ) ... " } Else { "$Val$( $M2[ ( 80 - $Val.Length ) ])" } )

                        $Echo | % { $_.ST[$Z] = @( $L[$Z % 2] , $Key , " : " , $Val , $R[$Z % 2] ) ; $_.FG[$Z] = 0 , 2 , 1 , 2 , 0 ; $_.BG[$Z] = @( 3 ) * 5 ; $Z++ }
                    }
                }

                If ( $Z % 2 -ne 0 ) { $Echo | % { $_.ST[$Z] = " // " , $M2[108] , " \\ "  ; $_.FG[$Z] = 0 , 0 , 0                        ; $_.BG[$Z] = @( 3 ) * 3 ; $Z++ } }
                
                $Echo | % {

                    $Return = $( If ( $Prompt ) 
                    { 
                        $Prompt | % { Return $( If ( $_.Length -gt 60 ) { "__[ $( $_.Substring( 0 , 60 ) )... ]__" } Else { "__[ $_ ]__$( $M1[( 62 - $_.Length )] )" } ) } 
                    }
                    If ( ! $Prompt )
                    {
                        Return "_____________________________________________________________________"
                    })
                }
                
                    $_.ST[$Z] = @( " \\___" ; @( " " ) * 72 ; @( "____" , "    " ) * 4 ; "___// " )         ; $_.FG[$Z] = @( 0 ) * 10                     ; $_.BG[$Z] = @( 3 ) * 10 ; $Z++
                    $_.ST[$Z] = @( " /" , $F[0] , "\$( $M1[70] )/" ; $F * 4 ; $F[0] , "\ " )                ; $_.FG[$Z] = @( @( 0 , 1 ) * 6 ; 0  )        ; $_.BG[$Z] = @( 3 ) * 14 ; $Z++
                    $_.ST[$Z] = @( " \" , $F[1] , "/$( $M0[70] )\" ; @( $F[ 1 , 0 ] )  * 4 ; $F[1] , "/ " ) ; $_.FG[$Z] = @( 0 ; @( 1 ) * 11 ; 0 )        ; $_.BG[$Z] = @( 3 ) * 14 ; $Z++
                    $_.ST[$Z] = @( "  ¯¯¯\" , "\$Return/" ; $F * 4 ; "/¯¯¯  " )                             ; $_.FG[$Z] = @( 0 , 1 , 2 ; @( 1 , 0 ) * 6 ) ; $_.BG[$Z] = @( 3 ) * 14 ; $Z++
                    $_.ST[$Z] = "      $( $M0[72] )$( "    ¯¯¯¯" * 4 )      "                               ; $_.FG[$Z] = 0                               ; $_.BG[$Z] = 3           ; $Z++
            }
        }
        
        End
        {
            $GX = $Edge , $Center , $Font , $Back , 15 , 12 , 9 , 0 , 10

            ForEach ( $I in 0..( $Echo.ST.Count - 1 ) )
            { 
                $Count = $Echo.ST[$I].Count

                If ( $Count -eq 1 )
                {
                    $Splat = @{ Object          = $Echo.ST[$I]
                                ForegroundColor = $GX[$Echo.FG[$I]]
                                BackgroundColor = $GX[$Echo.BG[$I]] }

                    Write-Host @Splat

                    $Splat = $Null
                }

                If ( $Count -gt 1 )
                {
                    ForEach ( $J in 0..( $Count - 1 ) )
                    {
                        $Splat = @{ Object          = $Echo.ST[$I][$J]
                                    ForegroundColor = $GX[$Echo.FG[$I][$J]]
                                    BackgroundColor = $GX[$Echo.BG[$I][$J]] }

                        If ( $J -ne $Echo.ST[$I].Count - 1 ) 
                        {
                            $Splat.Add( "NoNewLine" , $True )

                            Write-Host @Splat
                        }
                        
                        Else
                        {
                            Write-Host @Splat
                        }

                        $Splat = $Null
                    }
                }
            }
        }                                                                            #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Convert-XAMLToWindow # Modified, originally by Dr. Tobias Weltner  _________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Param ( [ Parameter ( Mandatory ) ] [ String ] $XAML , [ String [] ] $NE = $Null , [ Switch ] $PassThru )

        @( "Framework" , "Core" | % { "Presentation$_" } ) + "WindowsBase" | % { Add-Type -AssemblyName $_ }
 
        $NR = [ XML.XMLReader ]::Create( [ IO.StringReader ] $XAML ) ; $OP = [ Windows.Markup.XAMLReader ]::Load( $NR )
        
        $NE | % { $OP | Add-Member -MemberType NoteProperty -Name $_ -Value $OP.FindName( $_ ) -Force }
 
        If ( $PassThru ) { $OP } Else { $Null = $GUI.Dispatcher.InvokeAsync( { $OP = $GUI.ShowDialog() ; SV -Name OP -Value $OP -Scope 1 } ).Wait() ; $OP }

                                                                                     #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                             __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\___________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Show-WPFWindow # Modified, originally by Dr. Tobias Weltner ________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        Param ( [ Parameter ( Mandatory ) ] [ Windows.Window ] $GUI )

        $OP = $Null ; $Null = $GUI.Dispatcher.InvokeAsync( { $OP = $GUI.ShowDialog() ; SV -Name OP -Value $OP -Scope 1 } ).Wait() ; $OP 
                                                                                    #____    ____    ____    ____    ____    ____    ____    ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Update-Branding # Updates the branding ( TEH WEI KING ) ___________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯       
        [ CmdLetBinding () ] Param (

            [ Parameter ( Position = 0 , Mandatory = $True ) ] [ String ] $LogoPath ,
            [ Parameter ( Position = 1 , Mandatory = $True ) ] [ String ] $BackgroundPath ,
            [ Parameter ( Position = 2 , Mandatory = $True ) ] [ String ] $Company ,
            [ Parameter ( Position = 3 , Mandatory = $True ) ] [ String ] $Website , 
            [ Parameter ( Position = 4 , Mandatory = $True ) ] [ String ] $Phone ,
            [ Parameter ( Position = 5 , Mandatory = $True ) ] [ String ] $Hours ) 
        
        Resolve-LocalMachine | % { $SYS = $_.System32 ; $SR = $_.SystemRoot ; $PGD = $_.ProgramData }

        $Logo           = Split-Path -Leaf         $LogoPath ; $LogoRoot       = Split-Path -Parent $LogoPath
        $Background     = Split-Path -Leaf   $BackgroundPath ; $BackgroundRoot = Split-Path -Parent $BackgroundPath

        $REX = ForEach ( $i in 0..3 ) 
        {    
            ( "CU" , "LM" , "LM" , "LM"  | % { "HK$_`:\Software" } )[$I] , ( "" , "" , "" , "Policies\" | % { "$_`Microsoft\Windows" } )[$I] ,
            @( "Policies\System" , "OEMInformation" , "Authentication\LogonUI\Background" | % { "CurrentVersion\$_" } ; "Personalization" )[$I] -join '\'
        }
    
        $FEX = @( @( "" ; "" , "\Backgrounds" | % { "\OOBE\Info$_" } ) | % { "$SYS$_" } ; "Screen" , "Wallpaper\Windows" | % { "$SR\Web\$_" } ; "$PGD\Microsoft\User Account Pictures" )
        $FEX[2]     | ? { ! ( Test-Path $_ ) } | % { NI $_ -ItemType Directory ; Write-Theme -Action "Created [+]" "OEM Background Directory" }
        $REX[0,3]   | ? { ! ( Test-Path $_ ) } | % { NI ( Split-Path -Parent $_ ) -Name ( Split-Path -Leaf $_ ) ; Write-Theme -Action "Created [+]" "Registry Key / $_" }
        $FEX[0,1,5] | % { CP       $LogoPath $_ ; Write-Theme -Action       "Logo [+]" "Copied to $_" 11 11 15 }
        $FEX[2..4]  | % { CP $BackgroundPath $_ ; Write-Theme -Action "Background [+]" "Copied to $_" 11 11 15 }

        ForEach ( $i in 0..8 )
        { 
            $Splat = @{ Path    = $REX[0,0,1,1,1,1,1,3,2][$I]
                        Name    = @( "" , "Style" | % { "Wallpaper$_" } ; "Logo" , "Manufacturer" ; "Phone" , "Hours" , "URL" | % { "Support$_" } ; 
                                  "LockScreenImage" , "OEMBackground" )[$I]
                        Value   = ( "$( $FEX[4] )\$Background" , 2 , "$SYS\$Logo" , $Company , $Phone , $Hours , $Website , "$( $FEX[3] )\$Background" , 1 )[$I] }

            Write-Theme -Action $Splat.Name $Splat.Value 11 11 15
            
            SP @SPLAT
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Resolve-LocalMachine # Turns local machine information into an object _____//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        $Local = @( $Env:ComputerName , $Env:Processor_Architecture , "$Env:SystemDrive\" ; $Env:SystemRoot | % { "$_" , "$_\System32" } ; 
        $Env:ProgramData , $Env:ProgramFiles )
        
        Return [ PSCustomObject ]@{ 
            
            ComputerName  = $Local[0]
            Architecture  = $Local[1]
            SystemDrive   = $Local[2]
            SystemRoot    = $Local[3]
            System32      = $Local[4]
            ProgramData   = $Local[5]
            ProgramFiles  = $Local[6]
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Unlock-Script # Allows for elevation ( Not Finished ) _____________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      
        $CS = GCIM Win32_OperatingSystem
        IEX "Using Namespace System.Security.Principal"
        "Windows" | % { IEX "( [ $_`Principal ] [ $_`Identity ]::GetCurrent() ).IsInRole( 'Administrator' )" } | % {
        
            If ( ( ( $_ -eq $False ) -and ( $CS | % { [ Int ]$_.BuildNumber -gt 6000 } ) ) -or ( $_ -eq $True ) )
            {
                $MyInvocation | % { SAPS PowerShell -Verb RunAs -Args "-File $( $_.PSCommandPath ) $( $_.UnboundArguments )" }

                Set-ExecutionPolicy ByPass -Scope Process -Force
            }

            Else { Read-Host "[!] Access Failed. Press Enter to Exit" ; Exit }
        }                                                                           #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
}#____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____ __ ____ __ ____ __ ____ __ ____ __ ____    ___// 
    Function Initialize-Hybrid # Completes post-installation provisioning ______________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    {#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯ -- ¯¯¯¯    ¯¯¯¯      

        Write-Theme -Free 
        
        Write-Theme -Action "Provisioning [~]" "Hybrid-DSC Server/Client Attributes"

                # ____   _________________________
                #//¯¯\\__[___ Provisional Root __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

                    $Section               = 0..2
                    $SubTable              = 0..2

                    $Root                  = Resolve-HybridTarget

                    If ( $Root -eq $Null ) 
                    {
                        Write-Theme -Action "Exception [!]" "Root Variables failed to load" 12 4 15
                        Read-Host "Press Enter to Exit"
                        Exit
                    }

                    IEX "Using Namespace System.Management.Automation"

                    $DCCred , $LMCred = "Domain" , "Local" | % { 
                    
                        [ PSCredential ]::new( $Root."$( $_ )User" , ( $Root."$( $_ )Pass" | ConvertTo-SecureString -AsPlainText -Force ) ) 
                        
                        $Root."$( $_ )Pass" = "System.Security.SecureString"
                    }

                    $Splat = @{ Name        = $Root.DSDrive 
                                PSProvider  = "FileSystem"
                                Root        = $Root.NetworkShare 
                                Description = $Root.Company 
                                Credential  = $DCCred }

                    NDR @Splat

                    $Provision             = [ PSCustomObject ]@{ 
            
                        Name               = $Root.Company
                        Controller         = $Root.Server
                        PSDrive            = $Root.DSDrive
                        SMBShare           = "-"
                        NetworkPath        = $Root.NetworkShare
                        HybridRoot         = $Root | % { "$( $_.NetworkShare )\$( $_.Company )" }
                    }

                    $Section[0]            = "Desired State Controller @ Target"

                    $Names                 = ( $Provision | GM | ? MemberType -EQ NoteProperty | % { $_.Name } )[2,0,4,5,3,1]
                    $Values                = $Names | % { $Provision.$_ }

                    $Subtable[0]           = New-Subtable -Items $Names -Values $Values
                # ____   _________________________
                #//¯¯\\__[___ Local Variables ___]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Local                 = Resolve-LocalMachine

                    $Section[1]            = "Current Machine @ Variables"
                    $Names                 = ( $Local | GM | ? MemberType -EQ NoteProperty | % { $_.Name } )[1,0,5,6,4,2,3]
                    $Values                = $Names | % { $Local.$_ }

                    $Subtable[1]           = New-Subtable -Items $Names -Values $Values
                # ____   _________________________
                #//¯¯\\__[___ Bridge Variables __]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Target                = [ PScustomObject ]@{ 
            
                        Path               = "$ENV:SystemDrive\$( $Root.Company )"
                    }

                    $Tree                  = "Resources" , "Tools" , "Images" , "Profiles" , "Certificates" , "Applications"

                    0..( $Tree.Count - 1 ) | % { 
            
                        $Splat             = @{ MemberType = "NoteProperty"
                                                Name       = $Tree[$_]
                                                Value      = "$( $Target.Path )\($_)$( $Tree[$_] )" 
                        }
                
                        $Target            | Add-Member @Splat 
                    }

                    $Section[2]            = "Provision Index @ Bridge Control"

                    $Names                 = ( $Target | GM | ? MemberType -EQ NoteProperty | % { $_.Name } )[3,5,6,2,4,1,0]
                    $Values                = $Names | % { $Target.$_ }

                    $Subtable[2]           = New-Subtable -Items $Names -Values $Values
                # ____   _________________________
                #//¯¯\\__[____ Display Panel ____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Panel                 = @{ Title = "Provisional Root Index"
                                                Depth = 3
                                                ID    = $Section | % { "( $_ )" }
                                                Table = $Subtable }

                    $Table                 = New-Table @Panel

                    Write-Theme -Table $Table

                    Read-Host "$( "¯" * 116 )`nPress Enter to Continue"

                # ____   _________________________
                #//¯¯\\__[_____ OEM Branding ____]
                #¯    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
                    $Root | % {

                        $Splat = @{ LogoPath       = $_.Logo
                                    BackgroundPath = $_.Background
                                    Company        = $_.Company
                                    Website        = $_.Website
                                    Phone          = $_.Phone
                                    Hours          = $_.Hours }
                    }

                    Update-Branding @Splat

                    gci "$( $Root.DSDrive ):\"
        }
